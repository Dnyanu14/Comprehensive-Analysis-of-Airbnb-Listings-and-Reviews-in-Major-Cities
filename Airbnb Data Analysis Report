# Airbnb Data Analysis Report

## Introduction

This report presents an analysis of Airbnb data for over 250,000 listings across 10 major cities, including information on pricing, review scores, host attributes, and more. The primary objectives are to identify major differences in the Airbnb market between cities, determine which attributes have the greatest influence on pricing, detect trends and seasonality in review data, and assess which city offers the best value for travel.

## Methodology

### Data Preparation
- **Data Loading**: Imported datasets for listings and reviews.
- **Data Cleaning**: Handled missing values, converted data types, and standardized variables.
- **Data Integration**: Merged listings and reviews datasets for comprehensive analysis.

### Exploratory Data Analysis (EDA)
- **Descriptive Statistics**: Generated summary statistics for key variables.
- **Distribution Analysis**: Analyzed distributions of price and review scores.
- **Correlation Analysis**: Examined correlations between price and other attributes.

### City Comparison
- **Pricing Analysis**: Compared average prices per city.
- **Review Scores Comparison**: Compared review scores across cities.
- **Host Attributes Comparison**: Analyzed host-related attributes across cities.

### Influence of Attributes on Price
- **Regression Analysis**: Determined which attributes most influence pricing.
- **Feature Importance**: Used Random Forest to identify key features affecting price.

### Trends and Seasonality in Review Data
- **Temporal Analysis**: Investigated trends and seasonality in review counts and scores.
- **Sentiment Analysis**: Analyzed review sentiment over time.

### Value for Travel
- **Cost-Benefit Analysis**: Calculated value scores based on review ratings and prices.
- **Average Value Calculation**: Compared average value scores across cities.





{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "e4261242-f078-42dc-a2e9-880ffa86bb50",
   "metadata": {},
   "outputs": [
    {
     "ename": "UnicodeDecodeError",
     "evalue": "'utf-8' codec can't decode byte 0x81 in position 206899: invalid start byte",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mUnicodeDecodeError\u001b[0m                        Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[1], line 3\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;28;01mimport\u001b[39;00m \u001b[38;5;21;01mpandas\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m \u001b[38;5;21;01mpd\u001b[39;00m\n\u001b[1;32m----> 3\u001b[0m listings \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mread_csv(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mListings.csv\u001b[39m\u001b[38;5;124m'\u001b[39m)  \u001b[38;5;66;03m# Replace with actual file path\u001b[39;00m\n\u001b[0;32m      4\u001b[0m reviews \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mread_csv(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mReviews.csv\u001b[39m\u001b[38;5;124m'\u001b[39m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\io\\parsers\\readers.py:1026\u001b[0m, in \u001b[0;36mread_csv\u001b[1;34m(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)\u001b[0m\n\u001b[0;32m   1013\u001b[0m kwds_defaults \u001b[38;5;241m=\u001b[39m _refine_defaults_read(\n\u001b[0;32m   1014\u001b[0m     dialect,\n\u001b[0;32m   1015\u001b[0m     delimiter,\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m   1022\u001b[0m     dtype_backend\u001b[38;5;241m=\u001b[39mdtype_backend,\n\u001b[0;32m   1023\u001b[0m )\n\u001b[0;32m   1024\u001b[0m kwds\u001b[38;5;241m.\u001b[39mupdate(kwds_defaults)\n\u001b[1;32m-> 1026\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m _read(filepath_or_buffer, kwds)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\io\\parsers\\readers.py:626\u001b[0m, in \u001b[0;36m_read\u001b[1;34m(filepath_or_buffer, kwds)\u001b[0m\n\u001b[0;32m    623\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m parser\n\u001b[0;32m    625\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m parser:\n\u001b[1;32m--> 626\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m parser\u001b[38;5;241m.\u001b[39mread(nrows)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\io\\parsers\\readers.py:1923\u001b[0m, in \u001b[0;36mTextFileReader.read\u001b[1;34m(self, nrows)\u001b[0m\n\u001b[0;32m   1916\u001b[0m nrows \u001b[38;5;241m=\u001b[39m validate_integer(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mnrows\u001b[39m\u001b[38;5;124m\"\u001b[39m, nrows)\n\u001b[0;32m   1917\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[0;32m   1918\u001b[0m     \u001b[38;5;66;03m# error: \"ParserBase\" has no attribute \"read\"\u001b[39;00m\n\u001b[0;32m   1919\u001b[0m     (\n\u001b[0;32m   1920\u001b[0m         index,\n\u001b[0;32m   1921\u001b[0m         columns,\n\u001b[0;32m   1922\u001b[0m         col_dict,\n\u001b[1;32m-> 1923\u001b[0m     ) \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_engine\u001b[38;5;241m.\u001b[39mread(  \u001b[38;5;66;03m# type: ignore[attr-defined]\u001b[39;00m\n\u001b[0;32m   1924\u001b[0m         nrows\n\u001b[0;32m   1925\u001b[0m     )\n\u001b[0;32m   1926\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mException\u001b[39;00m:\n\u001b[0;32m   1927\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mclose()\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\io\\parsers\\c_parser_wrapper.py:234\u001b[0m, in \u001b[0;36mCParserWrapper.read\u001b[1;34m(self, nrows)\u001b[0m\n\u001b[0;32m    232\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[0;32m    233\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mlow_memory:\n\u001b[1;32m--> 234\u001b[0m         chunks \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_reader\u001b[38;5;241m.\u001b[39mread_low_memory(nrows)\n\u001b[0;32m    235\u001b[0m         \u001b[38;5;66;03m# destructive to chunks\u001b[39;00m\n\u001b[0;32m    236\u001b[0m         data \u001b[38;5;241m=\u001b[39m _concatenate_chunks(chunks)\n",
      "File \u001b[1;32mparsers.pyx:838\u001b[0m, in \u001b[0;36mpandas._libs.parsers.TextReader.read_low_memory\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mparsers.pyx:905\u001b[0m, in \u001b[0;36mpandas._libs.parsers.TextReader._read_rows\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mparsers.pyx:874\u001b[0m, in \u001b[0;36mpandas._libs.parsers.TextReader._tokenize_rows\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mparsers.pyx:891\u001b[0m, in \u001b[0;36mpandas._libs.parsers.TextReader._check_tokenize_status\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mparsers.pyx:2053\u001b[0m, in \u001b[0;36mpandas._libs.parsers.raise_parser_error\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32m<frozen codecs>:322\u001b[0m, in \u001b[0;36mdecode\u001b[1;34m(self, input, final)\u001b[0m\n",
      "\u001b[1;31mUnicodeDecodeError\u001b[0m: 'utf-8' codec can't decode byte 0x81 in position 206899: invalid start byte"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "listings = pd.read_csv('Listings.csv')  # Replace with actual file path\n",
    "reviews = pd.read_csv('Reviews.csv')    # Replace with actual file path\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "2efbd4b6-bad1-46ef-82f7-313dbbf4c975",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Admin\\AppData\\Local\\Temp\\ipykernel_8452\\704373942.py:8: DtypeWarning: Columns (5,13) have mixed types. Specify dtype option on import or set low_memory=False.\n",
      "  listings = pd.read_csv('listings.csv', encoding=encoding)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Successfully read the files with encoding: latin1\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Attempt to load the data with different encodings\n",
    "encodings = ['latin1', 'iso-8859-1', 'cp1252']\n",
    "\n",
    "for encoding in encodings:\n",
    "    try:\n",
    "        listings = pd.read_csv('listings.csv', encoding=encoding)\n",
    "        reviews = pd.read_csv('reviews.csv', encoding=encoding)\n",
    "        print(f\"Successfully read the files with encoding: {encoding}\")\n",
    "        break\n",
    "    except UnicodeDecodeError as e:\n",
    "        print(f\"Failed with encoding {encoding}: {e}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "777bdce9-e136-40e6-a433-3e7ef3626078",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Admin\\AppData\\Local\\Temp\\ipykernel_8452\\3978623734.py:10: DtypeWarning: Columns (5,13) have mixed types. Specify dtype option on import or set low_memory=False.\n",
      "  listings = pd.read_csv('listings.csv', encoding='latin1', dtype=dtype_spec)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Listings DataFrame:\n",
      "   listing_id                                              name   host_id  \\\n",
      "0      281420    Beautiful Flat in le Village Montmartre, Paris   1466919   \n",
      "1     3705183                   39 mÃÂ² Paris (Sacre CÃ",
      "âur)  10328771   \n",
      "2     4082273               Lovely apartment with Terrace, 60m2  19252768   \n",
      "3     4797344               Cosy studio (close to Eiffel tower)  10668311   \n",
      "4     4823489  Close to Eiffel Tower - Beautiful flat : 2 rooms  24837558   \n",
      "\n",
      "   host_since                 host_location host_response_time  \\\n",
      "0  2011-12-03  Paris, Ile-de-France, France                NaN   \n",
      "1  2013-11-29  Paris, Ile-de-France, France                NaN   \n",
      "2  2014-07-31  Paris, Ile-de-France, France                NaN   \n",
      "3  2013-12-17  Paris, Ile-de-France, France                NaN   \n",
      "4  2014-12-14  Paris, Ile-de-France, France                NaN   \n",
      "\n",
      "   host_response_rate  host_acceptance_rate host_is_superhost  \\\n",
      "0                 NaN                   NaN                 f   \n",
      "1                 NaN                   NaN                 f   \n",
      "2                 NaN                   NaN                 f   \n",
      "3                 NaN                   NaN                 f   \n",
      "4                 NaN                   NaN                 f   \n",
      "\n",
      "   host_total_listings_count  ... minimum_nights maximum_nights  \\\n",
      "0                        1.0  ...              2           1125   \n",
      "1                        1.0  ...              2           1125   \n",
      "2                        1.0  ...              2           1125   \n",
      "3                        1.0  ...              2           1125   \n",
      "4                        1.0  ...              2           1125   \n",
      "\n",
      "  review_scores_rating review_scores_accuracy review_scores_cleanliness  \\\n",
      "0                100.0                   10.0                      10.0   \n",
      "1                100.0                   10.0                      10.0   \n",
      "2                100.0                   10.0                      10.0   \n",
      "3                100.0                   10.0                      10.0   \n",
      "4                100.0                   10.0                      10.0   \n",
      "\n",
      "   review_scores_checkin  review_scores_communication review_scores_location  \\\n",
      "0                   10.0                         10.0                   10.0   \n",
      "1                   10.0                         10.0                   10.0   \n",
      "2                   10.0                         10.0                   10.0   \n",
      "3                   10.0                         10.0                   10.0   \n",
      "4                   10.0                         10.0                   10.0   \n",
      "\n",
      "  review_scores_value  instant_bookable  \n",
      "0                10.0                 f  \n",
      "1                10.0                 f  \n",
      "2                10.0                 f  \n",
      "3                10.0                 f  \n",
      "4                10.0                 f  \n",
      "\n",
      "[5 rows x 33 columns]\n",
      "\n",
      "Reviews DataFrame:\n",
      "   listing_id  review_id        date  reviewer_id\n",
      "0       11798  330265172  2018-09-30     11863072\n",
      "1       15383  330103585  2018-09-30     39147453\n",
      "2       16455  329985788  2018-09-30      1125378\n",
      "3       17919  330016899  2018-09-30    172717984\n",
      "4       26827  329995638  2018-09-30     17542859\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Specify data types for columns with mixed types\n",
    "dtype_spec = {\n",
    "    'column_5_name': str,   # Replace 'column_5_name' with the actual column name\n",
    "    'column_13_name': str   # Replace 'column_13_name' with the actual column name\n",
    "}\n",
    "\n",
    "# Read the CSV file with the specified encoding and data types\n",
    "listings = pd.read_csv('listings.csv', encoding='latin1', dtype=dtype_spec)\n",
    "reviews = pd.read_csv('reviews.csv', encoding='latin1')\n",
    "\n",
    "# Continue with your data exploration and cleaning steps\n",
    "print(\"Listings DataFrame:\")\n",
    "print(listings.head())\n",
    "\n",
    "print(\"\\nReviews DataFrame:\")\n",
    "print(reviews.head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "b22be1ec-0b26-41c8-b773-a8a1a7ceb37e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   listing_id                                              name   host_id  \\\n",
      "0      281420    Beautiful Flat in le Village Montmartre, Paris   1466919   \n",
      "1     3705183                   39 mÃÂ² Paris (Sacre CÃ",
      "âur)  10328771   \n",
      "2     4082273               Lovely apartment with Terrace, 60m2  19252768   \n",
      "3     4797344               Cosy studio (close to Eiffel tower)  10668311   \n",
      "4     4823489  Close to Eiffel Tower - Beautiful flat : 2 rooms  24837558   \n",
      "\n",
      "   host_since                 host_location  host_response_time  \\\n",
      "0  2011-12-03  Paris, Ile-de-France, France                 NaN   \n",
      "1  2013-11-29  Paris, Ile-de-France, France                 NaN   \n",
      "2  2014-07-31  Paris, Ile-de-France, France                 NaN   \n",
      "3  2013-12-17  Paris, Ile-de-France, France                 NaN   \n",
      "4  2014-12-14  Paris, Ile-de-France, France                 NaN   \n",
      "\n",
      "   host_response_rate  host_acceptance_rate host_is_superhost  \\\n",
      "0                 NaN                   NaN                 f   \n",
      "1                 NaN                   NaN                 f   \n",
      "2                 NaN                   NaN                 f   \n",
      "3                 NaN                   NaN                 f   \n",
      "4                 NaN                   NaN                 f   \n",
      "\n",
      "   host_total_listings_count  ... minimum_nights maximum_nights  \\\n",
      "0                          1  ...              2           1125   \n",
      "1                          1  ...              2           1125   \n",
      "2                          1  ...              2           1125   \n",
      "3                          1  ...              2           1125   \n",
      "4                          1  ...              2           1125   \n",
      "\n",
      "  review_scores_rating  review_scores_accuracy review_scores_cleanliness  \\\n",
      "0                  100                      10                        10   \n",
      "1                  100                      10                        10   \n",
      "2                  100                      10                        10   \n",
      "3                  100                      10                        10   \n",
      "4                  100                      10                        10   \n",
      "\n",
      "   review_scores_checkin  review_scores_communication review_scores_location  \\\n",
      "0                     10                           10                     10   \n",
      "1                     10                           10                     10   \n",
      "2                     10                           10                     10   \n",
      "3                     10                           10                     10   \n",
      "4                     10                           10                     10   \n",
      "\n",
      "  review_scores_value  instant_bookable  \n",
      "0                  10                 f  \n",
      "1                  10                 f  \n",
      "2                  10                 f  \n",
      "3                  10                 f  \n",
      "4                  10                 f  \n",
      "\n",
      "[5 rows x 33 columns]\n",
      "Index(['listing_id', 'name', 'host_id', 'host_since', 'host_location',\n",
      "       'host_response_time', 'host_response_rate', 'host_acceptance_rate',\n",
      "       'host_is_superhost', 'host_total_listings_count',\n",
      "       'host_has_profile_pic', 'host_identity_verified', 'neighbourhood',\n",
      "       'district', 'city', 'latitude', 'longitude', 'property_type',\n",
      "       'room_type', 'accommodates', 'bedrooms', 'amenities', 'price',\n",
      "       'minimum_nights', 'maximum_nights', 'review_scores_rating',\n",
      "       'review_scores_accuracy', 'review_scores_cleanliness',\n",
      "       'review_scores_checkin', 'review_scores_communication',\n",
      "       'review_scores_location', 'review_scores_value', 'instant_bookable'],\n",
      "      dtype='object')\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Read a small portion of the file to inspect the columns\n",
    "sample_listings = pd.read_csv('listings.csv', encoding='latin1', nrows=100)\n",
    "print(sample_listings.head())\n",
    "print(sample_listings.columns)  # Print column names to identify the problematic columns\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "4467ceba-377c-44af-a3e7-f0912198c761",
   "metadata": {},
   "outputs": [],
   "source": [
    "dtype_spec = {\n",
    "    'column_5_name': str,  # Replace 'column_5_name' with the actual column name\n",
    "    'column_13_name': str  # Replace 'column_13_name' with the actual column name\n",
    "}\n",
    "\n",
    "# Read the CSV file with specified data types\n",
    "listings = pd.read_csv('listings.csv', encoding='latin1', dtype=dtype_spec, low_memory=False)\n",
    "reviews = pd.read_csv('reviews.csv', encoding='latin1', low_memory=False)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "86669838-d087-455a-9ff7-1f780140ff34",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 279712 entries, 0 to 279711\n",
      "Data columns (total 33 columns):\n",
      " #   Column                       Non-Null Count   Dtype  \n",
      "---  ------                       --------------   -----  \n",
      " 0   listing_id                   279712 non-null  int64  \n",
      " 1   name                         279537 non-null  object \n",
      " 2   host_id                      279712 non-null  int64  \n",
      " 3   host_since                   279547 non-null  object \n",
      " 4   host_location                278872 non-null  object \n",
      " 5   host_response_time           150930 non-null  object \n",
      " 6   host_response_rate           150930 non-null  float64\n",
      " 7   host_acceptance_rate         166625 non-null  float64\n",
      " 8   host_is_superhost            279547 non-null  object \n",
      " 9   host_total_listings_count    279547 non-null  float64\n",
      " 10  host_has_profile_pic         279547 non-null  object \n",
      " 11  host_identity_verified       279547 non-null  object \n",
      " 12  neighbourhood                279712 non-null  object \n",
      " 13  district                     37012 non-null   object \n",
      " 14  city                         279712 non-null  object \n",
      " 15  latitude                     279712 non-null  float64\n",
      " 16  longitude                    279712 non-null  float64\n",
      " 17  property_type                279712 non-null  object \n",
      " 18  room_type                    279712 non-null  object \n",
      " 19  accommodates                 279712 non-null  int64  \n",
      " 20  bedrooms                     250277 non-null  float64\n",
      " 21  amenities                    279712 non-null  object \n",
      " 22  price                        279712 non-null  int64  \n",
      " 23  minimum_nights               279712 non-null  int64  \n",
      " 24  maximum_nights               279712 non-null  int64  \n",
      " 25  review_scores_rating         188307 non-null  float64\n",
      " 26  review_scores_accuracy       187999 non-null  float64\n",
      " 27  review_scores_cleanliness    188047 non-null  float64\n",
      " 28  review_scores_checkin        187941 non-null  float64\n",
      " 29  review_scores_communication  188025 non-null  float64\n",
      " 30  review_scores_location       187937 non-null  float64\n",
      " 31  review_scores_value          187927 non-null  float64\n",
      " 32  instant_bookable             279712 non-null  object \n",
      "dtypes: float64(13), int64(6), object(14)\n",
      "memory usage: 70.4+ MB\n",
      "None\n",
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 5373143 entries, 0 to 5373142\n",
      "Data columns (total 4 columns):\n",
      " #   Column       Dtype \n",
      "---  ------       ----- \n",
      " 0   listing_id   int64 \n",
      " 1   review_id    int64 \n",
      " 2   date         object\n",
      " 3   reviewer_id  int64 \n",
      "dtypes: int64(3), object(1)\n",
      "memory usage: 164.0+ MB\n",
      "None\n",
      "   listing_id                                              name   host_id  \\\n",
      "0      281420    Beautiful Flat in le Village Montmartre, Paris   1466919   \n",
      "1     3705183                   39 mÃÂ² Paris (Sacre CÃ",
      "âur)  10328771   \n",
      "2     4082273               Lovely apartment with Terrace, 60m2  19252768   \n",
      "3     4797344               Cosy studio (close to Eiffel tower)  10668311   \n",
      "4     4823489  Close to Eiffel Tower - Beautiful flat : 2 rooms  24837558   \n",
      "\n",
      "   host_since                 host_location host_response_time  \\\n",
      "0  2011-12-03  Paris, Ile-de-France, France                NaN   \n",
      "1  2013-11-29  Paris, Ile-de-France, France                NaN   \n",
      "2  2014-07-31  Paris, Ile-de-France, France                NaN   \n",
      "3  2013-12-17  Paris, Ile-de-France, France                NaN   \n",
      "4  2014-12-14  Paris, Ile-de-France, France                NaN   \n",
      "\n",
      "   host_response_rate  host_acceptance_rate host_is_superhost  \\\n",
      "0                 NaN                   NaN                 f   \n",
      "1                 NaN                   NaN                 f   \n",
      "2                 NaN                   NaN                 f   \n",
      "3                 NaN                   NaN                 f   \n",
      "4                 NaN                   NaN                 f   \n",
      "\n",
      "   host_total_listings_count  ... minimum_nights maximum_nights  \\\n",
      "0                        1.0  ...              2           1125   \n",
      "1                        1.0  ...              2           1125   \n",
      "2                        1.0  ...              2           1125   \n",
      "3                        1.0  ...              2           1125   \n",
      "4                        1.0  ...              2           1125   \n",
      "\n",
      "  review_scores_rating review_scores_accuracy review_scores_cleanliness  \\\n",
      "0                100.0                   10.0                      10.0   \n",
      "1                100.0                   10.0                      10.0   \n",
      "2                100.0                   10.0                      10.0   \n",
      "3                100.0                   10.0                      10.0   \n",
      "4                100.0                   10.0                      10.0   \n",
      "\n",
      "   review_scores_checkin  review_scores_communication review_scores_location  \\\n",
      "0                   10.0                         10.0                   10.0   \n",
      "1                   10.0                         10.0                   10.0   \n",
      "2                   10.0                         10.0                   10.0   \n",
      "3                   10.0                         10.0                   10.0   \n",
      "4                   10.0                         10.0                   10.0   \n",
      "\n",
      "  review_scores_value  instant_bookable  \n",
      "0                10.0                 f  \n",
      "1                10.0                 f  \n",
      "2                10.0                 f  \n",
      "3                10.0                 f  \n",
      "4                10.0                 f  \n",
      "\n",
      "[5 rows x 33 columns]\n",
      "   listing_id  review_id        date  reviewer_id\n",
      "0       11798  330265172  2018-09-30     11863072\n",
      "1       15383  330103585  2018-09-30     39147453\n",
      "2       16455  329985788  2018-09-30      1125378\n",
      "3       17919  330016899  2018-09-30    172717984\n",
      "4       26827  329995638  2018-09-30     17542859\n"
     ]
    }
   ],
   "source": [
    "print(listings.info())\n",
    "print(reviews.info())\n",
    "\n",
    "# Display the first few rows of the datasets\n",
    "print(listings.head())\n",
    "print(reviews.head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "542e5d66-11d7-4114-9a79-b375adda413f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Missing values in Listings DataFrame:\n",
      "listing_id                          0\n",
      "name                              175\n",
      "host_id                             0\n",
      "host_since                        165\n",
      "host_location                     840\n",
      "host_response_time             128782\n",
      "host_response_rate             128782\n",
      "host_acceptance_rate           113087\n",
      "host_is_superhost                 165\n",
      "host_total_listings_count         165\n",
      "host_has_profile_pic              165\n",
      "host_identity_verified            165\n",
      "neighbourhood                       0\n",
      "district                       242700\n",
      "city                                0\n",
      "latitude                            0\n",
      "longitude                           0\n",
      "property_type                       0\n",
      "room_type                           0\n",
      "accommodates                        0\n",
      "bedrooms                        29435\n",
      "amenities                           0\n",
      "price                               0\n",
      "minimum_nights                      0\n",
      "maximum_nights                      0\n",
      "review_scores_rating            91405\n",
      "review_scores_accuracy          91713\n",
      "review_scores_cleanliness       91665\n",
      "review_scores_checkin           91771\n",
      "review_scores_communication     91687\n",
      "review_scores_location          91775\n",
      "review_scores_value             91785\n",
      "instant_bookable                    0\n",
      "dtype: int64\n",
      "\n",
      "Missing values in Reviews DataFrame:\n",
      "listing_id     0\n",
      "review_id      0\n",
      "date           0\n",
      "reviewer_id    0\n",
      "dtype: int64\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Admin\\AppData\\Local\\Temp\\ipykernel_8452\\2797811323.py:9: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.\n",
      "  listings.fillna(method='ffill', inplace=True)\n",
      "C:\\Users\\Admin\\AppData\\Local\\Temp\\ipykernel_8452\\2797811323.py:10: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.\n",
      "  reviews.fillna(method='ffill', inplace=True)\n"
     ]
    }
   ],
   "source": [
    "# Check for missing values\n",
    "print(\"Missing values in Listings DataFrame:\")\n",
    "print(listings.isnull().sum())\n",
    "\n",
    "print(\"\\nMissing values in Reviews DataFrame:\")\n",
    "print(reviews.isnull().sum())\n",
    "\n",
    "# Fill missing values (example with forward fill, modify as needed)\n",
    "listings.fillna(method='ffill', inplace=True)\n",
    "reviews.fillna(method='ffill', inplace=True)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "0ee8c264-ed0e-4e66-9c79-2aa79677ba90",
   "metadata": {},
   "outputs": [
    {
     "ename": "AttributeError",
     "evalue": "Can only use .str accessor with string values!",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[15], line 2\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;66;03m# Convert price to numerical format\u001b[39;00m\n\u001b[1;32m----> 2\u001b[0m listings[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m listings[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mstr\u001b[38;5;241m.\u001b[39mreplace(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m$\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39mstr\u001b[38;5;241m.\u001b[39mreplace(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m,\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39mastype(\u001b[38;5;28mfloat\u001b[39m)\n\u001b[0;32m      4\u001b[0m \u001b[38;5;66;03m# Convert date to datetime format\u001b[39;00m\n\u001b[0;32m      5\u001b[0m reviews[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mto_datetime(reviews[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m])\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\generic.py:6299\u001b[0m, in \u001b[0;36mNDFrame.__getattr__\u001b[1;34m(self, name)\u001b[0m\n\u001b[0;32m   6292\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m (\n\u001b[0;32m   6293\u001b[0m     name \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_internal_names_set\n\u001b[0;32m   6294\u001b[0m     \u001b[38;5;129;01mand\u001b[39;00m name \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_metadata\n\u001b[0;32m   6295\u001b[0m     \u001b[38;5;129;01mand\u001b[39;00m name \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_accessors\n\u001b[0;32m   6296\u001b[0m     \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_info_axis\u001b[38;5;241m.\u001b[39m_can_hold_identifiers_and_holds_name(name)\n\u001b[0;32m   6297\u001b[0m ):\n\u001b[0;32m   6298\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m[name]\n\u001b[1;32m-> 6299\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mobject\u001b[39m\u001b[38;5;241m.\u001b[39m\u001b[38;5;21m__getattribute__\u001b[39m(\u001b[38;5;28mself\u001b[39m, name)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\accessor.py:224\u001b[0m, in \u001b[0;36mCachedAccessor.__get__\u001b[1;34m(self, obj, cls)\u001b[0m\n\u001b[0;32m    221\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m obj \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m    222\u001b[0m     \u001b[38;5;66;03m# we're accessing the attribute of the class, i.e., Dataset.geo\u001b[39;00m\n\u001b[0;32m    223\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_accessor\n\u001b[1;32m--> 224\u001b[0m accessor_obj \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_accessor(obj)\n\u001b[0;32m    225\u001b[0m \u001b[38;5;66;03m# Replace the property with the accessor object. Inspired by:\u001b[39;00m\n\u001b[0;32m    226\u001b[0m \u001b[38;5;66;03m# https://www.pydanny.com/cached-property.html\u001b[39;00m\n\u001b[0;32m    227\u001b[0m \u001b[38;5;66;03m# We need to use object.__setattr__ because we overwrite __setattr__ on\u001b[39;00m\n\u001b[0;32m    228\u001b[0m \u001b[38;5;66;03m# NDFrame\u001b[39;00m\n\u001b[0;32m    229\u001b[0m \u001b[38;5;28mobject\u001b[39m\u001b[38;5;241m.\u001b[39m\u001b[38;5;21m__setattr__\u001b[39m(obj, \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_name, accessor_obj)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\strings\\accessor.py:191\u001b[0m, in \u001b[0;36mStringMethods.__init__\u001b[1;34m(self, data)\u001b[0m\n\u001b[0;32m    188\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21m__init__\u001b[39m(\u001b[38;5;28mself\u001b[39m, data) \u001b[38;5;241m-\u001b[39m\u001b[38;5;241m>\u001b[39m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m    189\u001b[0m     \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01mpandas\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mcore\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01marrays\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mstring_\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m StringDtype\n\u001b[1;32m--> 191\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_inferred_dtype \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_validate(data)\n\u001b[0;32m    192\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_is_categorical \u001b[38;5;241m=\u001b[39m \u001b[38;5;28misinstance\u001b[39m(data\u001b[38;5;241m.\u001b[39mdtype, CategoricalDtype)\n\u001b[0;32m    193\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_is_string \u001b[38;5;241m=\u001b[39m \u001b[38;5;28misinstance\u001b[39m(data\u001b[38;5;241m.\u001b[39mdtype, StringDtype)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\strings\\accessor.py:245\u001b[0m, in \u001b[0;36mStringMethods._validate\u001b[1;34m(data)\u001b[0m\n\u001b[0;32m    242\u001b[0m inferred_dtype \u001b[38;5;241m=\u001b[39m lib\u001b[38;5;241m.\u001b[39minfer_dtype(values, skipna\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    244\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m inferred_dtype \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m allowed_types:\n\u001b[1;32m--> 245\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mAttributeError\u001b[39;00m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mCan only use .str accessor with string values!\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m    246\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m inferred_dtype\n",
      "\u001b[1;31mAttributeError\u001b[0m: Can only use .str accessor with string values!"
     ]
    }
   ],
   "source": [
    "# Convert price to numerical format\n",
    "listings['price'] = listings['price'].str.replace('$', '').str.replace(',', '').astype(float)\n",
    "\n",
    "# Convert date to datetime format\n",
    "reviews['date'] = pd.to_datetime(reviews['date'])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "c11b66ee-a704-4066-98d3-61792b676de7",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "\"Column(s) ['number_of_reviews'] do not exist\"",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[17], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m city_group \u001b[38;5;241m=\u001b[39m listings\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcity\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\n\u001b[0;32m      2\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m: [\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmedian\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstd\u001b[39m\u001b[38;5;124m'\u001b[39m],\n\u001b[0;32m      3\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mnumber_of_reviews\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124msum\u001b[39m\u001b[38;5;124m'\u001b[39m,\n\u001b[0;32m      4\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mroom_type\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;28;01mlambda\u001b[39;00m x: x\u001b[38;5;241m.\u001b[39mvalue_counts()\u001b[38;5;241m.\u001b[39midxmax()  \u001b[38;5;66;03m# Most common room type\u001b[39;00m\n\u001b[0;32m      5\u001b[0m })\u001b[38;5;241m.\u001b[39mreset_index()\n\u001b[0;32m      6\u001b[0m city_group\u001b[38;5;241m.\u001b[39mcolumns \u001b[38;5;241m=\u001b[39m [\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mCity\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mAvg_Price\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mMedian_Price\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mPrice_STD\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mTotal_Reviews\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mMost_Common_Room_Type\u001b[39m\u001b[38;5;124m'\u001b[39m]\n\u001b[0;32m      7\u001b[0m \u001b[38;5;28mprint\u001b[39m(city_group)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py:1432\u001b[0m, in \u001b[0;36mDataFrameGroupBy.aggregate\u001b[1;34m(self, func, engine, engine_kwargs, *args, **kwargs)\u001b[0m\n\u001b[0;32m   1429\u001b[0m     kwargs[\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mengine_kwargs\u001b[39m\u001b[38;5;124m\"\u001b[39m] \u001b[38;5;241m=\u001b[39m engine_kwargs\n\u001b[0;32m   1431\u001b[0m op \u001b[38;5;241m=\u001b[39m GroupByApply(\u001b[38;5;28mself\u001b[39m, func, args\u001b[38;5;241m=\u001b[39margs, kwargs\u001b[38;5;241m=\u001b[39mkwargs)\n\u001b[1;32m-> 1432\u001b[0m result \u001b[38;5;241m=\u001b[39m op\u001b[38;5;241m.\u001b[39magg()\n\u001b[0;32m   1433\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m is_dict_like(func) \u001b[38;5;129;01mand\u001b[39;00m result \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   1434\u001b[0m     \u001b[38;5;66;03m# GH #52849\u001b[39;00m\n\u001b[0;32m   1435\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mas_index \u001b[38;5;129;01mand\u001b[39;00m is_list_like(func):\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:190\u001b[0m, in \u001b[0;36mApply.agg\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    187\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mapply_str()\n\u001b[0;32m    189\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_dict_like(func):\n\u001b[1;32m--> 190\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39magg_dict_like()\n\u001b[0;32m    191\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m is_list_like(func):\n\u001b[0;32m    192\u001b[0m     \u001b[38;5;66;03m# we require a list, but not a 'str'\u001b[39;00m\n\u001b[0;32m    193\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39magg_list_like()\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:423\u001b[0m, in \u001b[0;36mApply.agg_dict_like\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    415\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21magg_dict_like\u001b[39m(\u001b[38;5;28mself\u001b[39m) \u001b[38;5;241m-\u001b[39m\u001b[38;5;241m>\u001b[39m DataFrame \u001b[38;5;241m|\u001b[39m Series:\n\u001b[0;32m    416\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[0;32m    417\u001b[0m \u001b[38;5;124;03m    Compute aggregation in the case of a dict-like argument.\u001b[39;00m\n\u001b[0;32m    418\u001b[0m \n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    421\u001b[0m \u001b[38;5;124;03m    Result of aggregation.\u001b[39;00m\n\u001b[0;32m    422\u001b[0m \u001b[38;5;124;03m    \"\"\"\u001b[39;00m\n\u001b[1;32m--> 423\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39magg_or_apply_dict_like(op_name\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124magg\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:1608\u001b[0m, in \u001b[0;36mGroupByApply.agg_or_apply_dict_like\u001b[1;34m(self, op_name)\u001b[0m\n\u001b[0;32m   1603\u001b[0m     kwargs\u001b[38;5;241m.\u001b[39mupdate({\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mengine\u001b[39m\u001b[38;5;124m\"\u001b[39m: engine, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mengine_kwargs\u001b[39m\u001b[38;5;124m\"\u001b[39m: engine_kwargs})\n\u001b[0;32m   1605\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m com\u001b[38;5;241m.\u001b[39mtemp_setattr(\n\u001b[0;32m   1606\u001b[0m     obj, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mas_index\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;28;01mTrue\u001b[39;00m, condition\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mhasattr\u001b[39m(obj, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mas_index\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m   1607\u001b[0m ):\n\u001b[1;32m-> 1608\u001b[0m     result_index, result_data \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcompute_dict_like(\n\u001b[0;32m   1609\u001b[0m         op_name, selected_obj, selection, kwargs\n\u001b[0;32m   1610\u001b[0m     )\n\u001b[0;32m   1611\u001b[0m result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mwrap_results_dict_like(selected_obj, result_index, result_data)\n\u001b[0;32m   1612\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m result\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:462\u001b[0m, in \u001b[0;36mApply.compute_dict_like\u001b[1;34m(self, op_name, selected_obj, selection, kwargs)\u001b[0m\n\u001b[0;32m    460\u001b[0m is_groupby \u001b[38;5;241m=\u001b[39m \u001b[38;5;28misinstance\u001b[39m(obj, (DataFrameGroupBy, SeriesGroupBy))\n\u001b[0;32m    461\u001b[0m func \u001b[38;5;241m=\u001b[39m cast(AggFuncTypeDict, \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfunc)\n\u001b[1;32m--> 462\u001b[0m func \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mnormalize_dictlike_arg(op_name, selected_obj, func)\n\u001b[0;32m    464\u001b[0m is_non_unique_col \u001b[38;5;241m=\u001b[39m (\n\u001b[0;32m    465\u001b[0m     selected_obj\u001b[38;5;241m.\u001b[39mndim \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m2\u001b[39m\n\u001b[0;32m    466\u001b[0m     \u001b[38;5;129;01mand\u001b[39;00m selected_obj\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnunique() \u001b[38;5;241m<\u001b[39m \u001b[38;5;28mlen\u001b[39m(selected_obj\u001b[38;5;241m.\u001b[39mcolumns)\n\u001b[0;32m    467\u001b[0m )\n\u001b[0;32m    469\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m selected_obj\u001b[38;5;241m.\u001b[39mndim \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m    470\u001b[0m     \u001b[38;5;66;03m# key only used for output\u001b[39;00m\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:663\u001b[0m, in \u001b[0;36mApply.normalize_dictlike_arg\u001b[1;34m(self, how, obj, func)\u001b[0m\n\u001b[0;32m    661\u001b[0m     cols \u001b[38;5;241m=\u001b[39m Index(\u001b[38;5;28mlist\u001b[39m(func\u001b[38;5;241m.\u001b[39mkeys()))\u001b[38;5;241m.\u001b[39mdifference(obj\u001b[38;5;241m.\u001b[39mcolumns, sort\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(cols) \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m0\u001b[39m:\n\u001b[1;32m--> 663\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mColumn(s) \u001b[39m\u001b[38;5;132;01m{\u001b[39;00m\u001b[38;5;28mlist\u001b[39m(cols)\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m do not exist\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m    665\u001b[0m aggregator_types \u001b[38;5;241m=\u001b[39m (\u001b[38;5;28mlist\u001b[39m, \u001b[38;5;28mtuple\u001b[39m, \u001b[38;5;28mdict\u001b[39m)\n\u001b[0;32m    667\u001b[0m \u001b[38;5;66;03m# if we have a dict of any non-scalars\u001b[39;00m\n\u001b[0;32m    668\u001b[0m \u001b[38;5;66;03m# eg. {'A' : ['mean']}, normalize all to\u001b[39;00m\n\u001b[0;32m    669\u001b[0m \u001b[38;5;66;03m# be list-likes\u001b[39;00m\n\u001b[0;32m    670\u001b[0m \u001b[38;5;66;03m# Cannot use func.values() because arg may be a Series\u001b[39;00m\n",
      "\u001b[1;31mKeyError\u001b[0m: \"Column(s) ['number_of_reviews'] do not exist\""
     ]
    }
   ],
   "source": [
    "city_group = listings.groupby('city').agg({\n",
    "    'price': ['mean', 'median', 'std'],\n",
    "    'number_of_reviews': 'sum',\n",
    "    'room_type': lambda x: x.value_counts().idxmax()  # Most common room type\n",
    "}).reset_index()\n",
    "city_group.columns = ['City', 'Avg_Price', 'Median_Price', 'Price_STD', 'Total_Reviews', 'Most_Common_Room_Type']\n",
    "print(city_group)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "8bf50dc6-2f4f-43c0-8e2a-77fae8ed3ec5",
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'city_group' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[19], line 5\u001b[0m\n\u001b[0;32m      2\u001b[0m \u001b[38;5;28;01mimport\u001b[39;00m \u001b[38;5;21;01mseaborn\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m \u001b[38;5;21;01msns\u001b[39;00m\n\u001b[0;32m      4\u001b[0m plt\u001b[38;5;241m.\u001b[39mfigure(figsize\u001b[38;5;241m=\u001b[39m(\u001b[38;5;241m12\u001b[39m, \u001b[38;5;241m6\u001b[39m))\n\u001b[1;32m----> 5\u001b[0m sns\u001b[38;5;241m.\u001b[39mbarplot(x\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mCity\u001b[39m\u001b[38;5;124m'\u001b[39m, y\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mAvg_Price\u001b[39m\u001b[38;5;124m'\u001b[39m, data\u001b[38;5;241m=\u001b[39mcity_group)\n\u001b[0;32m      6\u001b[0m plt\u001b[38;5;241m.\u001b[39mtitle(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mAverage Price by City\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[0;32m      7\u001b[0m plt\u001b[38;5;241m.\u001b[39mshow()\n",
      "\u001b[1;31mNameError\u001b[0m: name 'city_group' is not defined"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<Figure size 1200x600 with 0 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "\n",
    "plt.figure(figsize=(12, 6))\n",
    "sns.barplot(x='City', y='Avg_Price', data=city_group)\n",
    "plt.title('Average Price by City')\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "cc71bfa1-55b4-45d4-aa25-5ab6030ef15d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   listing_id                                              name   host_id  \\\n",
      "0      281420    Beautiful Flat in le Village Montmartre, Paris   1466919   \n",
      "1     3705183                   39 mÃÂ² Paris (Sacre CÃ",
      "âur)  10328771   \n",
      "2     4082273               Lovely apartment with Terrace, 60m2  19252768   \n",
      "3     4797344               Cosy studio (close to Eiffel tower)  10668311   \n",
      "4     4823489  Close to Eiffel Tower - Beautiful flat : 2 rooms  24837558   \n",
      "\n",
      "   host_since                 host_location host_response_time  \\\n",
      "0  2011-12-03  Paris, Ile-de-France, France                NaN   \n",
      "1  2013-11-29  Paris, Ile-de-France, France                NaN   \n",
      "2  2014-07-31  Paris, Ile-de-France, France                NaN   \n",
      "3  2013-12-17  Paris, Ile-de-France, France                NaN   \n",
      "4  2014-12-14  Paris, Ile-de-France, France                NaN   \n",
      "\n",
      "   host_response_rate  host_acceptance_rate host_is_superhost  \\\n",
      "0                 NaN                   NaN                 f   \n",
      "1                 NaN                   NaN                 f   \n",
      "2                 NaN                   NaN                 f   \n",
      "3                 NaN                   NaN                 f   \n",
      "4                 NaN                   NaN                 f   \n",
      "\n",
      "   host_total_listings_count  ... minimum_nights maximum_nights  \\\n",
      "0                        1.0  ...              2           1125   \n",
      "1                        1.0  ...              2           1125   \n",
      "2                        1.0  ...              2           1125   \n",
      "3                        1.0  ...              2           1125   \n",
      "4                        1.0  ...              2           1125   \n",
      "\n",
      "  review_scores_rating review_scores_accuracy review_scores_cleanliness  \\\n",
      "0                100.0                   10.0                      10.0   \n",
      "1                100.0                   10.0                      10.0   \n",
      "2                100.0                   10.0                      10.0   \n",
      "3                100.0                   10.0                      10.0   \n",
      "4                100.0                   10.0                      10.0   \n",
      "\n",
      "   review_scores_checkin  review_scores_communication review_scores_location  \\\n",
      "0                   10.0                         10.0                   10.0   \n",
      "1                   10.0                         10.0                   10.0   \n",
      "2                   10.0                         10.0                   10.0   \n",
      "3                   10.0                         10.0                   10.0   \n",
      "4                   10.0                         10.0                   10.0   \n",
      "\n",
      "  review_scores_value  instant_bookable  \n",
      "0                10.0                 f  \n",
      "1                10.0                 f  \n",
      "2                10.0                 f  \n",
      "3                10.0                 f  \n",
      "4                10.0                 f  \n",
      "\n",
      "[5 rows x 33 columns]\n",
      "   listing_id  review_id        date  reviewer_id\n",
      "0       11798  330265172  2018-09-30     11863072\n",
      "1       15383  330103585  2018-09-30     39147453\n",
      "2       16455  329985788  2018-09-30      1125378\n",
      "3       17919  330016899  2018-09-30    172717984\n",
      "4       26827  329995638  2018-09-30     17542859\n",
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 279712 entries, 0 to 279711\n",
      "Data columns (total 33 columns):\n",
      " #   Column                       Non-Null Count   Dtype  \n",
      "---  ------                       --------------   -----  \n",
      " 0   listing_id                   279712 non-null  int64  \n",
      " 1   name                         279712 non-null  object \n",
      " 2   host_id                      279712 non-null  int64  \n",
      " 3   host_since                   279712 non-null  object \n",
      " 4   host_location                279712 non-null  object \n",
      " 5   host_response_time           253537 non-null  object \n",
      " 6   host_response_rate           253537 non-null  float64\n",
      " 7   host_acceptance_rate         270471 non-null  float64\n",
      " 8   host_is_superhost            279712 non-null  object \n",
      " 9   host_total_listings_count    279712 non-null  float64\n",
      " 10  host_has_profile_pic         279712 non-null  object \n",
      " 11  host_identity_verified       279712 non-null  object \n",
      " 12  neighbourhood                279712 non-null  object \n",
      " 13  district                     270492 non-null  object \n",
      " 14  city                         279712 non-null  object \n",
      " 15  latitude                     279712 non-null  float64\n",
      " 16  longitude                    279712 non-null  float64\n",
      " 17  property_type                279712 non-null  object \n",
      " 18  room_type                    279712 non-null  object \n",
      " 19  accommodates                 279712 non-null  int64  \n",
      " 20  bedrooms                     279712 non-null  float64\n",
      " 21  amenities                    279712 non-null  object \n",
      " 22  price                        279712 non-null  int64  \n",
      " 23  minimum_nights               279712 non-null  int64  \n",
      " 24  maximum_nights               279712 non-null  int64  \n",
      " 25  review_scores_rating         279712 non-null  float64\n",
      " 26  review_scores_accuracy       279712 non-null  float64\n",
      " 27  review_scores_cleanliness    279712 non-null  float64\n",
      " 28  review_scores_checkin        279712 non-null  float64\n",
      " 29  review_scores_communication  279712 non-null  float64\n",
      " 30  review_scores_location       279712 non-null  float64\n",
      " 31  review_scores_value          279712 non-null  float64\n",
      " 32  instant_bookable             279712 non-null  object \n",
      "dtypes: float64(13), int64(6), object(14)\n",
      "memory usage: 70.4+ MB\n",
      "None\n",
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 5373143 entries, 0 to 5373142\n",
      "Data columns (total 4 columns):\n",
      " #   Column       Dtype \n",
      "---  ------       ----- \n",
      " 0   listing_id   int64 \n",
      " 1   review_id    int64 \n",
      " 2   date         object\n",
      " 3   reviewer_id  int64 \n",
      "dtypes: int64(3), object(1)\n",
      "memory usage: 164.0+ MB\n",
      "None\n",
      "         listing_id       host_id  host_response_rate  host_acceptance_rate  \\\n",
      "count  2.797120e+05  2.797120e+05       253537.000000         270471.000000   \n",
      "mean   2.638196e+07  1.081658e+08            0.825791              0.830236   \n",
      "std    1.442576e+07  1.108570e+08            0.291875              0.311564   \n",
      "min    2.577000e+03  1.822000e+03            0.000000              0.000000   \n",
      "25%    1.384462e+07  1.720656e+07            0.800000              0.820000   \n",
      "50%    2.767098e+07  5.826911e+07            1.000000              1.000000   \n",
      "75%    3.978485e+07  1.832853e+08            1.000000              1.000000   \n",
      "max    4.834353e+07  3.901874e+08            1.000000              1.000000   \n",
      "\n",
      "       host_total_listings_count       latitude      longitude   accommodates  \\\n",
      "count              279712.000000  279712.000000  279712.000000  279712.000000   \n",
      "mean                   24.569182      18.761862      12.595075       3.288736   \n",
      "std                   283.957819      32.560343      73.081309       2.133379   \n",
      "min                     0.000000     -34.264400     -99.339630       0.000000   \n",
      "25%                     1.000000     -22.964390     -43.198040       2.000000   \n",
      "50%                     1.000000      40.710785       2.382780       2.000000   \n",
      "75%                     4.000000      41.908610      28.986730       4.000000   \n",
      "max                  7235.000000      48.904910     151.339810      16.000000   \n",
      "\n",
      "            bedrooms          price  minimum_nights  maximum_nights  \\\n",
      "count  279712.000000  279712.000000   279712.000000    2.797120e+05   \n",
      "mean        1.632007     608.792737        8.050967    2.755860e+04   \n",
      "std         1.243447    3441.826611       31.518946    7.282875e+06   \n",
      "min         1.000000       0.000000        1.000000    1.000000e+00   \n",
      "25%         1.000000      75.000000        1.000000    4.500000e+01   \n",
      "50%         1.000000     150.000000        2.000000    1.125000e+03   \n",
      "75%         2.000000     474.000000        5.000000    1.125000e+03   \n",
      "max        50.000000  625216.000000     9999.000000    2.147484e+09   \n",
      "\n",
      "       review_scores_rating  review_scores_accuracy  \\\n",
      "count         279712.000000           279712.000000   \n",
      "mean              93.164873                9.523975   \n",
      "std               11.208261                1.083401   \n",
      "min               20.000000                2.000000   \n",
      "25%               91.000000                9.000000   \n",
      "50%               97.000000               10.000000   \n",
      "75%              100.000000               10.000000   \n",
      "max              100.000000               10.000000   \n",
      "\n",
      "       review_scores_cleanliness  review_scores_checkin  \\\n",
      "count              279712.000000          279712.000000   \n",
      "mean                    9.303752               9.617246   \n",
      "std                     1.214118               0.976738   \n",
      "min                     2.000000               2.000000   \n",
      "25%                     9.000000              10.000000   \n",
      "50%                    10.000000              10.000000   \n",
      "75%                    10.000000              10.000000   \n",
      "max                    10.000000              10.000000   \n",
      "\n",
      "       review_scores_communication  review_scores_location  \\\n",
      "count                279712.000000           279712.000000   \n",
      "mean                      9.561810                9.594983   \n",
      "std                       1.082748                0.915018   \n",
      "min                       2.000000                2.000000   \n",
      "25%                      10.000000                9.000000   \n",
      "50%                      10.000000               10.000000   \n",
      "75%                      10.000000               10.000000   \n",
      "max                      10.000000               10.000000   \n",
      "\n",
      "       review_scores_value  \n",
      "count        279712.000000  \n",
      "mean              9.323322  \n",
      "std               1.154757  \n",
      "min               2.000000  \n",
      "25%               9.000000  \n",
      "50%              10.000000  \n",
      "75%              10.000000  \n",
      "max              10.000000  \n",
      "         listing_id     review_id   reviewer_id\n",
      "count  5.373143e+06  5.373143e+06  5.373143e+06\n",
      "mean   1.602989e+07  3.486753e+08  9.808133e+07\n",
      "std    1.198676e+07  2.061019e+08  9.080596e+07\n",
      "min    2.577000e+03  2.820000e+02  1.000000e+00\n",
      "25%    5.332708e+06  1.666435e+08  2.390206e+07\n",
      "50%    1.450814e+07  3.425727e+08  6.697814e+07\n",
      "75%    2.414496e+07  5.334045e+08  1.528936e+08\n",
      "max    4.826387e+07  7.356237e+08  3.903385e+08\n"
     ]
    }
   ],
   "source": [
    "# Check the first few rows of each dataset\n",
    "print(listings.head())\n",
    "print(reviews.head())\n",
    "\n",
    "# Check the structure of each dataset\n",
    "print(listings.info())\n",
    "print(reviews.info())\n",
    "\n",
    "# Get basic statistics of each dataset\n",
    "print(listings.describe())\n",
    "print(reviews.describe())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "f6b93f94-8b8b-4f2b-99ba-092404902b6d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "listing_id                         0\n",
      "name                               0\n",
      "host_id                            0\n",
      "host_since                         0\n",
      "host_location                      0\n",
      "host_response_time             26175\n",
      "host_response_rate             26175\n",
      "host_acceptance_rate            9241\n",
      "host_is_superhost                  0\n",
      "host_total_listings_count          0\n",
      "host_has_profile_pic               0\n",
      "host_identity_verified             0\n",
      "neighbourhood                      0\n",
      "district                        9220\n",
      "city                               0\n",
      "latitude                           0\n",
      "longitude                          0\n",
      "property_type                      0\n",
      "room_type                          0\n",
      "accommodates                       0\n",
      "bedrooms                           0\n",
      "amenities                          0\n",
      "price                              0\n",
      "minimum_nights                     0\n",
      "maximum_nights                     0\n",
      "review_scores_rating               0\n",
      "review_scores_accuracy             0\n",
      "review_scores_cleanliness          0\n",
      "review_scores_checkin              0\n",
      "review_scores_communication        0\n",
      "review_scores_location             0\n",
      "review_scores_value                0\n",
      "instant_bookable                   0\n",
      "dtype: int64\n",
      "listing_id     0\n",
      "review_id      0\n",
      "date           0\n",
      "reviewer_id    0\n",
      "dtype: int64\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Admin\\AppData\\Local\\Temp\\ipykernel_8452\\2855348320.py:6: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.\n",
      "  listings.fillna(method='ffill', inplace=True)\n",
      "C:\\Users\\Admin\\AppData\\Local\\Temp\\ipykernel_8452\\2855348320.py:7: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.\n",
      "  reviews.fillna(method='ffill', inplace=True)\n"
     ]
    }
   ],
   "source": [
    "# Check for missing values\n",
    "print(listings.isnull().sum())\n",
    "print(reviews.isnull().sum())\n",
    "\n",
    "# Fill missing values for simplicity (you may need a more sophisticated approach)\n",
    "listings.fillna(method='ffill', inplace=True)\n",
    "reviews.fillna(method='ffill', inplace=True)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "9b655f58-17e5-4d46-81e9-b6db696bd677",
   "metadata": {},
   "outputs": [
    {
     "ename": "AttributeError",
     "evalue": "Can only use .str accessor with string values!",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[25], line 2\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;66;03m# Convert price to numerical format\u001b[39;00m\n\u001b[1;32m----> 2\u001b[0m listings[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m listings[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mstr\u001b[38;5;241m.\u001b[39mreplace(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m$\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39mstr\u001b[38;5;241m.\u001b[39mreplace(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m,\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39mastype(\u001b[38;5;28mfloat\u001b[39m)\n\u001b[0;32m      4\u001b[0m \u001b[38;5;66;03m# Convert date to datetime format\u001b[39;00m\n\u001b[0;32m      5\u001b[0m reviews[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mto_datetime(reviews[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m])\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\generic.py:6299\u001b[0m, in \u001b[0;36mNDFrame.__getattr__\u001b[1;34m(self, name)\u001b[0m\n\u001b[0;32m   6292\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m (\n\u001b[0;32m   6293\u001b[0m     name \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_internal_names_set\n\u001b[0;32m   6294\u001b[0m     \u001b[38;5;129;01mand\u001b[39;00m name \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_metadata\n\u001b[0;32m   6295\u001b[0m     \u001b[38;5;129;01mand\u001b[39;00m name \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_accessors\n\u001b[0;32m   6296\u001b[0m     \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_info_axis\u001b[38;5;241m.\u001b[39m_can_hold_identifiers_and_holds_name(name)\n\u001b[0;32m   6297\u001b[0m ):\n\u001b[0;32m   6298\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m[name]\n\u001b[1;32m-> 6299\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mobject\u001b[39m\u001b[38;5;241m.\u001b[39m\u001b[38;5;21m__getattribute__\u001b[39m(\u001b[38;5;28mself\u001b[39m, name)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\accessor.py:224\u001b[0m, in \u001b[0;36mCachedAccessor.__get__\u001b[1;34m(self, obj, cls)\u001b[0m\n\u001b[0;32m    221\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m obj \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m    222\u001b[0m     \u001b[38;5;66;03m# we're accessing the attribute of the class, i.e., Dataset.geo\u001b[39;00m\n\u001b[0;32m    223\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_accessor\n\u001b[1;32m--> 224\u001b[0m accessor_obj \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_accessor(obj)\n\u001b[0;32m    225\u001b[0m \u001b[38;5;66;03m# Replace the property with the accessor object. Inspired by:\u001b[39;00m\n\u001b[0;32m    226\u001b[0m \u001b[38;5;66;03m# https://www.pydanny.com/cached-property.html\u001b[39;00m\n\u001b[0;32m    227\u001b[0m \u001b[38;5;66;03m# We need to use object.__setattr__ because we overwrite __setattr__ on\u001b[39;00m\n\u001b[0;32m    228\u001b[0m \u001b[38;5;66;03m# NDFrame\u001b[39;00m\n\u001b[0;32m    229\u001b[0m \u001b[38;5;28mobject\u001b[39m\u001b[38;5;241m.\u001b[39m\u001b[38;5;21m__setattr__\u001b[39m(obj, \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_name, accessor_obj)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\strings\\accessor.py:191\u001b[0m, in \u001b[0;36mStringMethods.__init__\u001b[1;34m(self, data)\u001b[0m\n\u001b[0;32m    188\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21m__init__\u001b[39m(\u001b[38;5;28mself\u001b[39m, data) \u001b[38;5;241m-\u001b[39m\u001b[38;5;241m>\u001b[39m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m    189\u001b[0m     \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01mpandas\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mcore\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01marrays\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mstring_\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m StringDtype\n\u001b[1;32m--> 191\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_inferred_dtype \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_validate(data)\n\u001b[0;32m    192\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_is_categorical \u001b[38;5;241m=\u001b[39m \u001b[38;5;28misinstance\u001b[39m(data\u001b[38;5;241m.\u001b[39mdtype, CategoricalDtype)\n\u001b[0;32m    193\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_is_string \u001b[38;5;241m=\u001b[39m \u001b[38;5;28misinstance\u001b[39m(data\u001b[38;5;241m.\u001b[39mdtype, StringDtype)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\strings\\accessor.py:245\u001b[0m, in \u001b[0;36mStringMethods._validate\u001b[1;34m(data)\u001b[0m\n\u001b[0;32m    242\u001b[0m inferred_dtype \u001b[38;5;241m=\u001b[39m lib\u001b[38;5;241m.\u001b[39minfer_dtype(values, skipna\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    244\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m inferred_dtype \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m allowed_types:\n\u001b[1;32m--> 245\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mAttributeError\u001b[39;00m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mCan only use .str accessor with string values!\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m    246\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m inferred_dtype\n",
      "\u001b[1;31mAttributeError\u001b[0m: Can only use .str accessor with string values!"
     ]
    }
   ],
   "source": [
    "# Convert price to numerical format\n",
    "listings['price'] = listings['price'].str.replace('$', '').str.replace(',', '').astype(float)\n",
    "\n",
    "# Convert date to datetime format\n",
    "reviews['date'] = pd.to_datetime(reviews['date'])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "47c23190-cd05-40e6-aa26-5a477c93e1a9",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Listings DataFrame Info:\n",
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 279712 entries, 0 to 279711\n",
      "Data columns (total 33 columns):\n",
      " #   Column                       Non-Null Count   Dtype  \n",
      "---  ------                       --------------   -----  \n",
      " 0   listing_id                   279712 non-null  int64  \n",
      " 1   name                         279537 non-null  object \n",
      " 2   host_id                      279712 non-null  int64  \n",
      " 3   host_since                   279547 non-null  object \n",
      " 4   host_location                278872 non-null  object \n",
      " 5   host_response_time           150930 non-null  object \n",
      " 6   host_response_rate           150930 non-null  float64\n",
      " 7   host_acceptance_rate         166625 non-null  float64\n",
      " 8   host_is_superhost            279547 non-null  object \n",
      " 9   host_total_listings_count    279547 non-null  float64\n",
      " 10  host_has_profile_pic         279547 non-null  object \n",
      " 11  host_identity_verified       279547 non-null  object \n",
      " 12  neighbourhood                279712 non-null  object \n",
      " 13  district                     37012 non-null   object \n",
      " 14  city                         279712 non-null  object \n",
      " 15  latitude                     279712 non-null  float64\n",
      " 16  longitude                    279712 non-null  float64\n",
      " 17  property_type                279712 non-null  object \n",
      " 18  room_type                    279712 non-null  object \n",
      " 19  accommodates                 279712 non-null  int64  \n",
      " 20  bedrooms                     250277 non-null  float64\n",
      " 21  amenities                    279712 non-null  object \n",
      " 22  price                        279712 non-null  int64  \n",
      " 23  minimum_nights               279712 non-null  int64  \n",
      " 24  maximum_nights               279712 non-null  int64  \n",
      " 25  review_scores_rating         188307 non-null  float64\n",
      " 26  review_scores_accuracy       187999 non-null  float64\n",
      " 27  review_scores_cleanliness    188047 non-null  float64\n",
      " 28  review_scores_checkin        187941 non-null  float64\n",
      " 29  review_scores_communication  188025 non-null  float64\n",
      " 30  review_scores_location       187937 non-null  float64\n",
      " 31  review_scores_value          187927 non-null  float64\n",
      " 32  instant_bookable             279712 non-null  object \n",
      "dtypes: float64(13), int64(6), object(14)\n",
      "memory usage: 70.4+ MB\n",
      "None\n",
      "\n",
      "Reviews DataFrame Info:\n",
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 5373143 entries, 0 to 5373142\n",
      "Data columns (total 4 columns):\n",
      " #   Column       Dtype \n",
      "---  ------       ----- \n",
      " 0   listing_id   int64 \n",
      " 1   review_id    int64 \n",
      " 2   date         object\n",
      " 3   reviewer_id  int64 \n",
      "dtypes: int64(3), object(1)\n",
      "memory usage: 164.0+ MB\n",
      "None\n",
      "\n",
      "Listings DataFrame:\n",
      "   listing_id                                              name   host_id  \\\n",
      "0      281420    Beautiful Flat in le Village Montmartre, Paris   1466919   \n",
      "1     3705183                   39 mÃÂ² Paris (Sacre CÃ",
      "âur)  10328771   \n",
      "2     4082273               Lovely apartment with Terrace, 60m2  19252768   \n",
      "3     4797344               Cosy studio (close to Eiffel tower)  10668311   \n",
      "4     4823489  Close to Eiffel Tower - Beautiful flat : 2 rooms  24837558   \n",
      "\n",
      "   host_since                 host_location host_response_time  \\\n",
      "0  2011-12-03  Paris, Ile-de-France, France                NaN   \n",
      "1  2013-11-29  Paris, Ile-de-France, France                NaN   \n",
      "2  2014-07-31  Paris, Ile-de-France, France                NaN   \n",
      "3  2013-12-17  Paris, Ile-de-France, France                NaN   \n",
      "4  2014-12-14  Paris, Ile-de-France, France                NaN   \n",
      "\n",
      "   host_response_rate  host_acceptance_rate host_is_superhost  \\\n",
      "0                 NaN                   NaN                 f   \n",
      "1                 NaN                   NaN                 f   \n",
      "2                 NaN                   NaN                 f   \n",
      "3                 NaN                   NaN                 f   \n",
      "4                 NaN                   NaN                 f   \n",
      "\n",
      "   host_total_listings_count  ... minimum_nights maximum_nights  \\\n",
      "0                        1.0  ...              2           1125   \n",
      "1                        1.0  ...              2           1125   \n",
      "2                        1.0  ...              2           1125   \n",
      "3                        1.0  ...              2           1125   \n",
      "4                        1.0  ...              2           1125   \n",
      "\n",
      "  review_scores_rating review_scores_accuracy review_scores_cleanliness  \\\n",
      "0                100.0                   10.0                      10.0   \n",
      "1                100.0                   10.0                      10.0   \n",
      "2                100.0                   10.0                      10.0   \n",
      "3                100.0                   10.0                      10.0   \n",
      "4                100.0                   10.0                      10.0   \n",
      "\n",
      "   review_scores_checkin  review_scores_communication review_scores_location  \\\n",
      "0                   10.0                         10.0                   10.0   \n",
      "1                   10.0                         10.0                   10.0   \n",
      "2                   10.0                         10.0                   10.0   \n",
      "3                   10.0                         10.0                   10.0   \n",
      "4                   10.0                         10.0                   10.0   \n",
      "\n",
      "  review_scores_value  instant_bookable  \n",
      "0                10.0                 f  \n",
      "1                10.0                 f  \n",
      "2                10.0                 f  \n",
      "3                10.0                 f  \n",
      "4                10.0                 f  \n",
      "\n",
      "[5 rows x 33 columns]\n",
      "\n",
      "Reviews DataFrame:\n",
      "   listing_id  review_id        date  reviewer_id\n",
      "0       11798  330265172  2018-09-30     11863072\n",
      "1       15383  330103585  2018-09-30     39147453\n",
      "2       16455  329985788  2018-09-30      1125378\n",
      "3       17919  330016899  2018-09-30    172717984\n",
      "4       26827  329995638  2018-09-30     17542859\n",
      "\n",
      "Missing values in Listings DataFrame:\n",
      "listing_id                          0\n",
      "name                              175\n",
      "host_id                             0\n",
      "host_since                        165\n",
      "host_location                     840\n",
      "host_response_time             128782\n",
      "host_response_rate             128782\n",
      "host_acceptance_rate           113087\n",
      "host_is_superhost                 165\n",
      "host_total_listings_count         165\n",
      "host_has_profile_pic              165\n",
      "host_identity_verified            165\n",
      "neighbourhood                       0\n",
      "district                       242700\n",
      "city                                0\n",
      "latitude                            0\n",
      "longitude                           0\n",
      "property_type                       0\n",
      "room_type                           0\n",
      "accommodates                        0\n",
      "bedrooms                        29435\n",
      "amenities                           0\n",
      "price                               0\n",
      "minimum_nights                      0\n",
      "maximum_nights                      0\n",
      "review_scores_rating            91405\n",
      "review_scores_accuracy          91713\n",
      "review_scores_cleanliness       91665\n",
      "review_scores_checkin           91771\n",
      "review_scores_communication     91687\n",
      "review_scores_location          91775\n",
      "review_scores_value             91785\n",
      "instant_bookable                    0\n",
      "dtype: int64\n",
      "\n",
      "Missing values in Reviews DataFrame:\n",
      "listing_id     0\n",
      "review_id      0\n",
      "date           0\n",
      "reviewer_id    0\n",
      "dtype: int64\n"
     ]
    },
    {
     "ename": "AttributeError",
     "evalue": "Can only use .str accessor with string values!",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[27], line 39\u001b[0m\n\u001b[0;32m     36\u001b[0m reviews\u001b[38;5;241m.\u001b[39mffill(inplace\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m     38\u001b[0m \u001b[38;5;66;03m# Convert price to numerical format\u001b[39;00m\n\u001b[1;32m---> 39\u001b[0m listings[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m listings[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mstr\u001b[38;5;241m.\u001b[39mreplace(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m$\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39mstr\u001b[38;5;241m.\u001b[39mreplace(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m,\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39mastype(\u001b[38;5;28mfloat\u001b[39m)\n\u001b[0;32m     41\u001b[0m \u001b[38;5;66;03m# Convert date to datetime format\u001b[39;00m\n\u001b[0;32m     42\u001b[0m reviews[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mto_datetime(reviews[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m])\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\generic.py:6299\u001b[0m, in \u001b[0;36mNDFrame.__getattr__\u001b[1;34m(self, name)\u001b[0m\n\u001b[0;32m   6292\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m (\n\u001b[0;32m   6293\u001b[0m     name \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_internal_names_set\n\u001b[0;32m   6294\u001b[0m     \u001b[38;5;129;01mand\u001b[39;00m name \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_metadata\n\u001b[0;32m   6295\u001b[0m     \u001b[38;5;129;01mand\u001b[39;00m name \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_accessors\n\u001b[0;32m   6296\u001b[0m     \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_info_axis\u001b[38;5;241m.\u001b[39m_can_hold_identifiers_and_holds_name(name)\n\u001b[0;32m   6297\u001b[0m ):\n\u001b[0;32m   6298\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m[name]\n\u001b[1;32m-> 6299\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mobject\u001b[39m\u001b[38;5;241m.\u001b[39m\u001b[38;5;21m__getattribute__\u001b[39m(\u001b[38;5;28mself\u001b[39m, name)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\accessor.py:224\u001b[0m, in \u001b[0;36mCachedAccessor.__get__\u001b[1;34m(self, obj, cls)\u001b[0m\n\u001b[0;32m    221\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m obj \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m    222\u001b[0m     \u001b[38;5;66;03m# we're accessing the attribute of the class, i.e., Dataset.geo\u001b[39;00m\n\u001b[0;32m    223\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_accessor\n\u001b[1;32m--> 224\u001b[0m accessor_obj \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_accessor(obj)\n\u001b[0;32m    225\u001b[0m \u001b[38;5;66;03m# Replace the property with the accessor object. Inspired by:\u001b[39;00m\n\u001b[0;32m    226\u001b[0m \u001b[38;5;66;03m# https://www.pydanny.com/cached-property.html\u001b[39;00m\n\u001b[0;32m    227\u001b[0m \u001b[38;5;66;03m# We need to use object.__setattr__ because we overwrite __setattr__ on\u001b[39;00m\n\u001b[0;32m    228\u001b[0m \u001b[38;5;66;03m# NDFrame\u001b[39;00m\n\u001b[0;32m    229\u001b[0m \u001b[38;5;28mobject\u001b[39m\u001b[38;5;241m.\u001b[39m\u001b[38;5;21m__setattr__\u001b[39m(obj, \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_name, accessor_obj)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\strings\\accessor.py:191\u001b[0m, in \u001b[0;36mStringMethods.__init__\u001b[1;34m(self, data)\u001b[0m\n\u001b[0;32m    188\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21m__init__\u001b[39m(\u001b[38;5;28mself\u001b[39m, data) \u001b[38;5;241m-\u001b[39m\u001b[38;5;241m>\u001b[39m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m    189\u001b[0m     \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01mpandas\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mcore\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01marrays\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mstring_\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m StringDtype\n\u001b[1;32m--> 191\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_inferred_dtype \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_validate(data)\n\u001b[0;32m    192\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_is_categorical \u001b[38;5;241m=\u001b[39m \u001b[38;5;28misinstance\u001b[39m(data\u001b[38;5;241m.\u001b[39mdtype, CategoricalDtype)\n\u001b[0;32m    193\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_is_string \u001b[38;5;241m=\u001b[39m \u001b[38;5;28misinstance\u001b[39m(data\u001b[38;5;241m.\u001b[39mdtype, StringDtype)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\strings\\accessor.py:245\u001b[0m, in \u001b[0;36mStringMethods._validate\u001b[1;34m(data)\u001b[0m\n\u001b[0;32m    242\u001b[0m inferred_dtype \u001b[38;5;241m=\u001b[39m lib\u001b[38;5;241m.\u001b[39minfer_dtype(values, skipna\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    244\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m inferred_dtype \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m allowed_types:\n\u001b[1;32m--> 245\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mAttributeError\u001b[39;00m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mCan only use .str accessor with string values!\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m    246\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m inferred_dtype\n",
      "\u001b[1;31mAttributeError\u001b[0m: Can only use .str accessor with string values!"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Specify data types for columns with mixed types (update column names as needed)\n",
    "dtype_spec = {\n",
    "    'column_5_name': str,   # Replace 'column_5_name' with the actual column name\n",
    "    'column_13_name': str   # Replace 'column_13_name' with the actual column name\n",
    "}\n",
    "\n",
    "# Read the CSV files with specified encoding and data types\n",
    "listings = pd.read_csv('listings.csv', encoding='latin1', dtype=dtype_spec, low_memory=False)\n",
    "reviews = pd.read_csv('reviews.csv', encoding='latin1', low_memory=False)\n",
    "\n",
    "# Check the structure of each dataset\n",
    "print(\"Listings DataFrame Info:\")\n",
    "print(listings.info())\n",
    "\n",
    "print(\"\\nReviews DataFrame Info:\")\n",
    "print(reviews.info())\n",
    "\n",
    "# Display the first few rows of the datasets\n",
    "print(\"\\nListings DataFrame:\")\n",
    "print(listings.head())\n",
    "\n",
    "print(\"\\nReviews DataFrame:\")\n",
    "print(reviews.head())\n",
    "\n",
    "# Check for missing values\n",
    "print(\"\\nMissing values in Listings DataFrame:\")\n",
    "print(listings.isnull().sum())\n",
    "\n",
    "print(\"\\nMissing values in Reviews DataFrame:\")\n",
    "print(reviews.isnull().sum())\n",
    "\n",
    "# Fill missing values using forward fill method\n",
    "listings.ffill(inplace=True)\n",
    "reviews.ffill(inplace=True)\n",
    "\n",
    "# Convert price to numerical format\n",
    "listings['price'] = listings['price'].str.replace('$', '').str.replace(',', '').astype(float)\n",
    "\n",
    "# Convert date to datetime format\n",
    "reviews['date'] = pd.to_datetime(reviews['date'])\n",
    "\n",
    "# Verify that the missing values have been filled\n",
    "print(\"\\nMissing values after filling in Listings DataFrame:\")\n",
    "print(listings.isnull().sum())\n",
    "\n",
    "print(\"\\nMissing values after filling in Reviews DataFrame:\")\n",
    "print(reviews.isnull().sum())\n",
    "\n",
    "# Proceed with data analysis steps as previously outlined\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "3c57ccde-9731-4414-a1e3-5e8282196e0e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Listings DataFrame Info:\n",
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 279712 entries, 0 to 279711\n",
      "Data columns (total 33 columns):\n",
      " #   Column                       Non-Null Count   Dtype  \n",
      "---  ------                       --------------   -----  \n",
      " 0   listing_id                   279712 non-null  int64  \n",
      " 1   name                         279537 non-null  object \n",
      " 2   host_id                      279712 non-null  int64  \n",
      " 3   host_since                   279547 non-null  object \n",
      " 4   host_location                278872 non-null  object \n",
      " 5   host_response_time           150930 non-null  object \n",
      " 6   host_response_rate           150930 non-null  float64\n",
      " 7   host_acceptance_rate         166625 non-null  float64\n",
      " 8   host_is_superhost            279547 non-null  object \n",
      " 9   host_total_listings_count    279547 non-null  float64\n",
      " 10  host_has_profile_pic         279547 non-null  object \n",
      " 11  host_identity_verified       279547 non-null  object \n",
      " 12  neighbourhood                279712 non-null  object \n",
      " 13  district                     37012 non-null   object \n",
      " 14  city                         279712 non-null  object \n",
      " 15  latitude                     279712 non-null  float64\n",
      " 16  longitude                    279712 non-null  float64\n",
      " 17  property_type                279712 non-null  object \n",
      " 18  room_type                    279712 non-null  object \n",
      " 19  accommodates                 279712 non-null  int64  \n",
      " 20  bedrooms                     250277 non-null  float64\n",
      " 21  amenities                    279712 non-null  object \n",
      " 22  price                        279712 non-null  int64  \n",
      " 23  minimum_nights               279712 non-null  int64  \n",
      " 24  maximum_nights               279712 non-null  int64  \n",
      " 25  review_scores_rating         188307 non-null  float64\n",
      " 26  review_scores_accuracy       187999 non-null  float64\n",
      " 27  review_scores_cleanliness    188047 non-null  float64\n",
      " 28  review_scores_checkin        187941 non-null  float64\n",
      " 29  review_scores_communication  188025 non-null  float64\n",
      " 30  review_scores_location       187937 non-null  float64\n",
      " 31  review_scores_value          187927 non-null  float64\n",
      " 32  instant_bookable             279712 non-null  object \n",
      "dtypes: float64(13), int64(6), object(14)\n",
      "memory usage: 70.4+ MB\n",
      "None\n",
      "\n",
      "Reviews DataFrame Info:\n",
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 5373143 entries, 0 to 5373142\n",
      "Data columns (total 4 columns):\n",
      " #   Column       Dtype \n",
      "---  ------       ----- \n",
      " 0   listing_id   int64 \n",
      " 1   review_id    int64 \n",
      " 2   date         object\n",
      " 3   reviewer_id  int64 \n",
      "dtypes: int64(3), object(1)\n",
      "memory usage: 164.0+ MB\n",
      "None\n",
      "\n",
      "Listings DataFrame:\n",
      "   listing_id                                              name   host_id  \\\n",
      "0      281420    Beautiful Flat in le Village Montmartre, Paris   1466919   \n",
      "1     3705183                   39 mÃÂ² Paris (Sacre CÃ",
      "âur)  10328771   \n",
      "2     4082273               Lovely apartment with Terrace, 60m2  19252768   \n",
      "3     4797344               Cosy studio (close to Eiffel tower)  10668311   \n",
      "4     4823489  Close to Eiffel Tower - Beautiful flat : 2 rooms  24837558   \n",
      "\n",
      "   host_since                 host_location host_response_time  \\\n",
      "0  2011-12-03  Paris, Ile-de-France, France                NaN   \n",
      "1  2013-11-29  Paris, Ile-de-France, France                NaN   \n",
      "2  2014-07-31  Paris, Ile-de-France, France                NaN   \n",
      "3  2013-12-17  Paris, Ile-de-France, France                NaN   \n",
      "4  2014-12-14  Paris, Ile-de-France, France                NaN   \n",
      "\n",
      "   host_response_rate  host_acceptance_rate host_is_superhost  \\\n",
      "0                 NaN                   NaN                 f   \n",
      "1                 NaN                   NaN                 f   \n",
      "2                 NaN                   NaN                 f   \n",
      "3                 NaN                   NaN                 f   \n",
      "4                 NaN                   NaN                 f   \n",
      "\n",
      "   host_total_listings_count  ... minimum_nights maximum_nights  \\\n",
      "0                        1.0  ...              2           1125   \n",
      "1                        1.0  ...              2           1125   \n",
      "2                        1.0  ...              2           1125   \n",
      "3                        1.0  ...              2           1125   \n",
      "4                        1.0  ...              2           1125   \n",
      "\n",
      "  review_scores_rating review_scores_accuracy review_scores_cleanliness  \\\n",
      "0                100.0                   10.0                      10.0   \n",
      "1                100.0                   10.0                      10.0   \n",
      "2                100.0                   10.0                      10.0   \n",
      "3                100.0                   10.0                      10.0   \n",
      "4                100.0                   10.0                      10.0   \n",
      "\n",
      "   review_scores_checkin  review_scores_communication review_scores_location  \\\n",
      "0                   10.0                         10.0                   10.0   \n",
      "1                   10.0                         10.0                   10.0   \n",
      "2                   10.0                         10.0                   10.0   \n",
      "3                   10.0                         10.0                   10.0   \n",
      "4                   10.0                         10.0                   10.0   \n",
      "\n",
      "  review_scores_value  instant_bookable  \n",
      "0                10.0                 f  \n",
      "1                10.0                 f  \n",
      "2                10.0                 f  \n",
      "3                10.0                 f  \n",
      "4                10.0                 f  \n",
      "\n",
      "[5 rows x 33 columns]\n",
      "\n",
      "Reviews DataFrame:\n",
      "   listing_id  review_id        date  reviewer_id\n",
      "0       11798  330265172  2018-09-30     11863072\n",
      "1       15383  330103585  2018-09-30     39147453\n",
      "2       16455  329985788  2018-09-30      1125378\n",
      "3       17919  330016899  2018-09-30    172717984\n",
      "4       26827  329995638  2018-09-30     17542859\n",
      "\n",
      "Missing values in Listings DataFrame:\n",
      "listing_id                          0\n",
      "name                              175\n",
      "host_id                             0\n",
      "host_since                        165\n",
      "host_location                     840\n",
      "host_response_time             128782\n",
      "host_response_rate             128782\n",
      "host_acceptance_rate           113087\n",
      "host_is_superhost                 165\n",
      "host_total_listings_count         165\n",
      "host_has_profile_pic              165\n",
      "host_identity_verified            165\n",
      "neighbourhood                       0\n",
      "district                       242700\n",
      "city                                0\n",
      "latitude                            0\n",
      "longitude                           0\n",
      "property_type                       0\n",
      "room_type                           0\n",
      "accommodates                        0\n",
      "bedrooms                        29435\n",
      "amenities                           0\n",
      "price                               0\n",
      "minimum_nights                      0\n",
      "maximum_nights                      0\n",
      "review_scores_rating            91405\n",
      "review_scores_accuracy          91713\n",
      "review_scores_cleanliness       91665\n",
      "review_scores_checkin           91771\n",
      "review_scores_communication     91687\n",
      "review_scores_location          91775\n",
      "review_scores_value             91785\n",
      "instant_bookable                    0\n",
      "dtype: int64\n",
      "\n",
      "Missing values in Reviews DataFrame:\n",
      "listing_id     0\n",
      "review_id      0\n",
      "date           0\n",
      "reviewer_id    0\n",
      "dtype: int64\n",
      "\n",
      "Missing values after filling in Listings DataFrame:\n",
      "listing_id                         0\n",
      "name                               0\n",
      "host_id                            0\n",
      "host_since                         0\n",
      "host_location                      0\n",
      "host_response_time             26175\n",
      "host_response_rate             26175\n",
      "host_acceptance_rate            9241\n",
      "host_is_superhost                  0\n",
      "host_total_listings_count          0\n",
      "host_has_profile_pic               0\n",
      "host_identity_verified             0\n",
      "neighbourhood                      0\n",
      "district                        9220\n",
      "city                               0\n",
      "latitude                           0\n",
      "longitude                          0\n",
      "property_type                      0\n",
      "room_type                          0\n",
      "accommodates                       0\n",
      "bedrooms                           0\n",
      "amenities                          0\n",
      "price                              0\n",
      "minimum_nights                     0\n",
      "maximum_nights                     0\n",
      "review_scores_rating               0\n",
      "review_scores_accuracy             0\n",
      "review_scores_cleanliness          0\n",
      "review_scores_checkin              0\n",
      "review_scores_communication        0\n",
      "review_scores_location             0\n",
      "review_scores_value                0\n",
      "instant_bookable                   0\n",
      "dtype: int64\n",
      "\n",
      "Missing values after filling in Reviews DataFrame:\n",
      "listing_id     0\n",
      "review_id      0\n",
      "date           0\n",
      "reviewer_id    0\n",
      "dtype: int64\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Specify data types for columns with mixed types (update column names as needed)\n",
    "dtype_spec = {\n",
    "    'column_5_name': str,   # Replace 'column_5_name' with the actual column name\n",
    "    'column_13_name': str   # Replace 'column_13_name' with the actual column name\n",
    "}\n",
    "\n",
    "# Read the CSV files with specified encoding and data types\n",
    "listings = pd.read_csv('listings.csv', encoding='latin1', dtype=dtype_spec, low_memory=False)\n",
    "reviews = pd.read_csv('reviews.csv', encoding='latin1', low_memory=False)\n",
    "\n",
    "# Check the structure of each dataset\n",
    "print(\"Listings DataFrame Info:\")\n",
    "print(listings.info())\n",
    "\n",
    "print(\"\\nReviews DataFrame Info:\")\n",
    "print(reviews.info())\n",
    "\n",
    "# Display the first few rows of the datasets\n",
    "print(\"\\nListings DataFrame:\")\n",
    "print(listings.head())\n",
    "\n",
    "print(\"\\nReviews DataFrame:\")\n",
    "print(reviews.head())\n",
    "\n",
    "# Check for missing values\n",
    "print(\"\\nMissing values in Listings DataFrame:\")\n",
    "print(listings.isnull().sum())\n",
    "\n",
    "print(\"\\nMissing values in Reviews DataFrame:\")\n",
    "print(reviews.isnull().sum())\n",
    "\n",
    "# Fill missing values using forward fill method\n",
    "listings.ffill(inplace=True)\n",
    "reviews.ffill(inplace=True)\n",
    "\n",
    "# Convert price to string format and then clean it\n",
    "listings['price'] = listings['price'].astype(str).str.replace('$', '').str.replace(',', '').astype(float)\n",
    "\n",
    "# Convert date to datetime format\n",
    "reviews['date'] = pd.to_datetime(reviews['date'])\n",
    "\n",
    "# Verify that the missing values have been filled\n",
    "print(\"\\nMissing values after filling in Listings DataFrame:\")\n",
    "print(listings.isnull().sum())\n",
    "\n",
    "print(\"\\nMissing values after filling in Reviews DataFrame:\")\n",
    "print(reviews.isnull().sum())\n",
    "\n",
    "# Proceed with data analysis steps as previously outlined\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "1313bb45-737f-4d41-9fbd-0ca4c8271faa",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "\"Column(s) ['number_of_reviews'] do not exist\"",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[31], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m city_group \u001b[38;5;241m=\u001b[39m listings\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcity\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\n\u001b[0;32m      2\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m: [\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmedian\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstd\u001b[39m\u001b[38;5;124m'\u001b[39m],  \u001b[38;5;66;03m# Aggregate functions for price\u001b[39;00m\n\u001b[0;32m      3\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mnumber_of_reviews\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124msum\u001b[39m\u001b[38;5;124m'\u001b[39m,          \u001b[38;5;66;03m# Sum the number of reviews\u001b[39;00m\n\u001b[0;32m      4\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mroom_type\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;28;01mlambda\u001b[39;00m x: x\u001b[38;5;241m.\u001b[39mvalue_counts()\u001b[38;5;241m.\u001b[39midxmax()  \u001b[38;5;66;03m# Most common room type\u001b[39;00m\n\u001b[0;32m      5\u001b[0m })\u001b[38;5;241m.\u001b[39mreset_index()\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py:1432\u001b[0m, in \u001b[0;36mDataFrameGroupBy.aggregate\u001b[1;34m(self, func, engine, engine_kwargs, *args, **kwargs)\u001b[0m\n\u001b[0;32m   1429\u001b[0m     kwargs[\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mengine_kwargs\u001b[39m\u001b[38;5;124m\"\u001b[39m] \u001b[38;5;241m=\u001b[39m engine_kwargs\n\u001b[0;32m   1431\u001b[0m op \u001b[38;5;241m=\u001b[39m GroupByApply(\u001b[38;5;28mself\u001b[39m, func, args\u001b[38;5;241m=\u001b[39margs, kwargs\u001b[38;5;241m=\u001b[39mkwargs)\n\u001b[1;32m-> 1432\u001b[0m result \u001b[38;5;241m=\u001b[39m op\u001b[38;5;241m.\u001b[39magg()\n\u001b[0;32m   1433\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m is_dict_like(func) \u001b[38;5;129;01mand\u001b[39;00m result \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   1434\u001b[0m     \u001b[38;5;66;03m# GH #52849\u001b[39;00m\n\u001b[0;32m   1435\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mas_index \u001b[38;5;129;01mand\u001b[39;00m is_list_like(func):\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:190\u001b[0m, in \u001b[0;36mApply.agg\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    187\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mapply_str()\n\u001b[0;32m    189\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_dict_like(func):\n\u001b[1;32m--> 190\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39magg_dict_like()\n\u001b[0;32m    191\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m is_list_like(func):\n\u001b[0;32m    192\u001b[0m     \u001b[38;5;66;03m# we require a list, but not a 'str'\u001b[39;00m\n\u001b[0;32m    193\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39magg_list_like()\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:423\u001b[0m, in \u001b[0;36mApply.agg_dict_like\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    415\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21magg_dict_like\u001b[39m(\u001b[38;5;28mself\u001b[39m) \u001b[38;5;241m-\u001b[39m\u001b[38;5;241m>\u001b[39m DataFrame \u001b[38;5;241m|\u001b[39m Series:\n\u001b[0;32m    416\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[0;32m    417\u001b[0m \u001b[38;5;124;03m    Compute aggregation in the case of a dict-like argument.\u001b[39;00m\n\u001b[0;32m    418\u001b[0m \n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    421\u001b[0m \u001b[38;5;124;03m    Result of aggregation.\u001b[39;00m\n\u001b[0;32m    422\u001b[0m \u001b[38;5;124;03m    \"\"\"\u001b[39;00m\n\u001b[1;32m--> 423\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39magg_or_apply_dict_like(op_name\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124magg\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:1608\u001b[0m, in \u001b[0;36mGroupByApply.agg_or_apply_dict_like\u001b[1;34m(self, op_name)\u001b[0m\n\u001b[0;32m   1603\u001b[0m     kwargs\u001b[38;5;241m.\u001b[39mupdate({\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mengine\u001b[39m\u001b[38;5;124m\"\u001b[39m: engine, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mengine_kwargs\u001b[39m\u001b[38;5;124m\"\u001b[39m: engine_kwargs})\n\u001b[0;32m   1605\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m com\u001b[38;5;241m.\u001b[39mtemp_setattr(\n\u001b[0;32m   1606\u001b[0m     obj, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mas_index\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;28;01mTrue\u001b[39;00m, condition\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mhasattr\u001b[39m(obj, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mas_index\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m   1607\u001b[0m ):\n\u001b[1;32m-> 1608\u001b[0m     result_index, result_data \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcompute_dict_like(\n\u001b[0;32m   1609\u001b[0m         op_name, selected_obj, selection, kwargs\n\u001b[0;32m   1610\u001b[0m     )\n\u001b[0;32m   1611\u001b[0m result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mwrap_results_dict_like(selected_obj, result_index, result_data)\n\u001b[0;32m   1612\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m result\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:462\u001b[0m, in \u001b[0;36mApply.compute_dict_like\u001b[1;34m(self, op_name, selected_obj, selection, kwargs)\u001b[0m\n\u001b[0;32m    460\u001b[0m is_groupby \u001b[38;5;241m=\u001b[39m \u001b[38;5;28misinstance\u001b[39m(obj, (DataFrameGroupBy, SeriesGroupBy))\n\u001b[0;32m    461\u001b[0m func \u001b[38;5;241m=\u001b[39m cast(AggFuncTypeDict, \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfunc)\n\u001b[1;32m--> 462\u001b[0m func \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mnormalize_dictlike_arg(op_name, selected_obj, func)\n\u001b[0;32m    464\u001b[0m is_non_unique_col \u001b[38;5;241m=\u001b[39m (\n\u001b[0;32m    465\u001b[0m     selected_obj\u001b[38;5;241m.\u001b[39mndim \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m2\u001b[39m\n\u001b[0;32m    466\u001b[0m     \u001b[38;5;129;01mand\u001b[39;00m selected_obj\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnunique() \u001b[38;5;241m<\u001b[39m \u001b[38;5;28mlen\u001b[39m(selected_obj\u001b[38;5;241m.\u001b[39mcolumns)\n\u001b[0;32m    467\u001b[0m )\n\u001b[0;32m    469\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m selected_obj\u001b[38;5;241m.\u001b[39mndim \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m    470\u001b[0m     \u001b[38;5;66;03m# key only used for output\u001b[39;00m\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:663\u001b[0m, in \u001b[0;36mApply.normalize_dictlike_arg\u001b[1;34m(self, how, obj, func)\u001b[0m\n\u001b[0;32m    661\u001b[0m     cols \u001b[38;5;241m=\u001b[39m Index(\u001b[38;5;28mlist\u001b[39m(func\u001b[38;5;241m.\u001b[39mkeys()))\u001b[38;5;241m.\u001b[39mdifference(obj\u001b[38;5;241m.\u001b[39mcolumns, sort\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(cols) \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m0\u001b[39m:\n\u001b[1;32m--> 663\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mColumn(s) \u001b[39m\u001b[38;5;132;01m{\u001b[39;00m\u001b[38;5;28mlist\u001b[39m(cols)\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m do not exist\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m    665\u001b[0m aggregator_types \u001b[38;5;241m=\u001b[39m (\u001b[38;5;28mlist\u001b[39m, \u001b[38;5;28mtuple\u001b[39m, \u001b[38;5;28mdict\u001b[39m)\n\u001b[0;32m    667\u001b[0m \u001b[38;5;66;03m# if we have a dict of any non-scalars\u001b[39;00m\n\u001b[0;32m    668\u001b[0m \u001b[38;5;66;03m# eg. {'A' : ['mean']}, normalize all to\u001b[39;00m\n\u001b[0;32m    669\u001b[0m \u001b[38;5;66;03m# be list-likes\u001b[39;00m\n\u001b[0;32m    670\u001b[0m \u001b[38;5;66;03m# Cannot use func.values() because arg may be a Series\u001b[39;00m\n",
      "\u001b[1;31mKeyError\u001b[0m: \"Column(s) ['number_of_reviews'] do not exist\""
     ]
    }
   ],
   "source": [
    "city_group = listings.groupby('city').agg({\n",
    "    'price': ['mean', 'median', 'std'],  # Aggregate functions for price\n",
    "    'number_of_reviews': 'sum',          # Sum the number of reviews\n",
    "    'room_type': lambda x: x.value_counts().idxmax()  # Most common room type\n",
    "}).reset_index()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7c16b4e0-7c22-43a2-9a7b-d8379c430fca",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Read the CSV files with specified encoding and data types\n",
    "dtype_spec = {\n",
    "    'column_5_name': str,   # Replace 'column_5_name' with the actual column name\n",
    "    'column_13_name': str   # Replace 'column_13_name' with the actual column name\n",
    "}\n",
    "\n",
    "listings = pd.read_csv('listings.csv', encoding='latin1', dtype=dtype_spec, low_memory=False)\n",
    "reviews = pd.read_csv('reviews.csv', encoding='latin1', low_memory=False)\n",
    "\n",
    "# Fill missing values using forward fill method\n",
    "listings.ffill(inplace=True)\n",
    "reviews.ffill(inplace=True)\n",
    "\n",
    "# Convert price to string format and then clean it\n",
    "listings['price'] = listings['price'].astype(str).str.replace('$', '').str.replace(',', '').astype(float)\n",
    "\n",
    "# Convert date to datetime format\n",
    "reviews['date'] = pd.to_datetime(reviews['date'])\n",
    "\n",
    "# Group by city and calculate aggregates\n",
    "city_group = listings.groupby('city').agg({\n",
    "    'price': ['mean', 'median', 'std'],\n",
    "    'number_of_reviews': 'sum',\n",
    "    'room_type': lambda x: x.value_counts().idxmax()  # Most common room type\n",
    "}).reset_index()\n",
    "\n",
    "# Flatten multi-level columns and rename them\n",
    "city_group.columns = ['City', 'Avg_Price', 'Median_Price', 'Price_STD', 'Total_Reviews', 'Most_Common_Room_Type']\n",
    "\n",
    "# Display the aggregated DataFrame\n",
    "print(city_group)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "49afeb22-9465-429a-9d7f-21d6708472bd",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "\"Column(s) ['number_of_reviews'] do not exist\"",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[35], line 23\u001b[0m\n\u001b[0;32m     20\u001b[0m reviews[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mto_datetime(reviews[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m])\n\u001b[0;32m     22\u001b[0m \u001b[38;5;66;03m# Group by city and calculate aggregates\u001b[39;00m\n\u001b[1;32m---> 23\u001b[0m city_group \u001b[38;5;241m=\u001b[39m listings\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcity\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\n\u001b[0;32m     24\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m: [\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmedian\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstd\u001b[39m\u001b[38;5;124m'\u001b[39m],\n\u001b[0;32m     25\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mnumber_of_reviews\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124msum\u001b[39m\u001b[38;5;124m'\u001b[39m,\n\u001b[0;32m     26\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mroom_type\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;28;01mlambda\u001b[39;00m x: x\u001b[38;5;241m.\u001b[39mvalue_counts()\u001b[38;5;241m.\u001b[39midxmax()  \u001b[38;5;66;03m# Most common room type\u001b[39;00m\n\u001b[0;32m     27\u001b[0m })\u001b[38;5;241m.\u001b[39mreset_index()\n\u001b[0;32m     29\u001b[0m \u001b[38;5;66;03m# Flatten multi-level columns and rename them\u001b[39;00m\n\u001b[0;32m     30\u001b[0m city_group\u001b[38;5;241m.\u001b[39mcolumns \u001b[38;5;241m=\u001b[39m [\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mCity\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mAvg_Price\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mMedian_Price\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mPrice_STD\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mTotal_Reviews\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mMost_Common_Room_Type\u001b[39m\u001b[38;5;124m'\u001b[39m]\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py:1432\u001b[0m, in \u001b[0;36mDataFrameGroupBy.aggregate\u001b[1;34m(self, func, engine, engine_kwargs, *args, **kwargs)\u001b[0m\n\u001b[0;32m   1429\u001b[0m     kwargs[\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mengine_kwargs\u001b[39m\u001b[38;5;124m\"\u001b[39m] \u001b[38;5;241m=\u001b[39m engine_kwargs\n\u001b[0;32m   1431\u001b[0m op \u001b[38;5;241m=\u001b[39m GroupByApply(\u001b[38;5;28mself\u001b[39m, func, args\u001b[38;5;241m=\u001b[39margs, kwargs\u001b[38;5;241m=\u001b[39mkwargs)\n\u001b[1;32m-> 1432\u001b[0m result \u001b[38;5;241m=\u001b[39m op\u001b[38;5;241m.\u001b[39magg()\n\u001b[0;32m   1433\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m is_dict_like(func) \u001b[38;5;129;01mand\u001b[39;00m result \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   1434\u001b[0m     \u001b[38;5;66;03m# GH #52849\u001b[39;00m\n\u001b[0;32m   1435\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mas_index \u001b[38;5;129;01mand\u001b[39;00m is_list_like(func):\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:190\u001b[0m, in \u001b[0;36mApply.agg\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    187\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mapply_str()\n\u001b[0;32m    189\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_dict_like(func):\n\u001b[1;32m--> 190\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39magg_dict_like()\n\u001b[0;32m    191\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m is_list_like(func):\n\u001b[0;32m    192\u001b[0m     \u001b[38;5;66;03m# we require a list, but not a 'str'\u001b[39;00m\n\u001b[0;32m    193\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39magg_list_like()\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:423\u001b[0m, in \u001b[0;36mApply.agg_dict_like\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    415\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21magg_dict_like\u001b[39m(\u001b[38;5;28mself\u001b[39m) \u001b[38;5;241m-\u001b[39m\u001b[38;5;241m>\u001b[39m DataFrame \u001b[38;5;241m|\u001b[39m Series:\n\u001b[0;32m    416\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[0;32m    417\u001b[0m \u001b[38;5;124;03m    Compute aggregation in the case of a dict-like argument.\u001b[39;00m\n\u001b[0;32m    418\u001b[0m \n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    421\u001b[0m \u001b[38;5;124;03m    Result of aggregation.\u001b[39;00m\n\u001b[0;32m    422\u001b[0m \u001b[38;5;124;03m    \"\"\"\u001b[39;00m\n\u001b[1;32m--> 423\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39magg_or_apply_dict_like(op_name\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124magg\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:1608\u001b[0m, in \u001b[0;36mGroupByApply.agg_or_apply_dict_like\u001b[1;34m(self, op_name)\u001b[0m\n\u001b[0;32m   1603\u001b[0m     kwargs\u001b[38;5;241m.\u001b[39mupdate({\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mengine\u001b[39m\u001b[38;5;124m\"\u001b[39m: engine, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mengine_kwargs\u001b[39m\u001b[38;5;124m\"\u001b[39m: engine_kwargs})\n\u001b[0;32m   1605\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m com\u001b[38;5;241m.\u001b[39mtemp_setattr(\n\u001b[0;32m   1606\u001b[0m     obj, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mas_index\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;28;01mTrue\u001b[39;00m, condition\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mhasattr\u001b[39m(obj, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mas_index\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m   1607\u001b[0m ):\n\u001b[1;32m-> 1608\u001b[0m     result_index, result_data \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcompute_dict_like(\n\u001b[0;32m   1609\u001b[0m         op_name, selected_obj, selection, kwargs\n\u001b[0;32m   1610\u001b[0m     )\n\u001b[0;32m   1611\u001b[0m result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mwrap_results_dict_like(selected_obj, result_index, result_data)\n\u001b[0;32m   1612\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m result\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:462\u001b[0m, in \u001b[0;36mApply.compute_dict_like\u001b[1;34m(self, op_name, selected_obj, selection, kwargs)\u001b[0m\n\u001b[0;32m    460\u001b[0m is_groupby \u001b[38;5;241m=\u001b[39m \u001b[38;5;28misinstance\u001b[39m(obj, (DataFrameGroupBy, SeriesGroupBy))\n\u001b[0;32m    461\u001b[0m func \u001b[38;5;241m=\u001b[39m cast(AggFuncTypeDict, \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfunc)\n\u001b[1;32m--> 462\u001b[0m func \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mnormalize_dictlike_arg(op_name, selected_obj, func)\n\u001b[0;32m    464\u001b[0m is_non_unique_col \u001b[38;5;241m=\u001b[39m (\n\u001b[0;32m    465\u001b[0m     selected_obj\u001b[38;5;241m.\u001b[39mndim \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m2\u001b[39m\n\u001b[0;32m    466\u001b[0m     \u001b[38;5;129;01mand\u001b[39;00m selected_obj\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnunique() \u001b[38;5;241m<\u001b[39m \u001b[38;5;28mlen\u001b[39m(selected_obj\u001b[38;5;241m.\u001b[39mcolumns)\n\u001b[0;32m    467\u001b[0m )\n\u001b[0;32m    469\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m selected_obj\u001b[38;5;241m.\u001b[39mndim \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m    470\u001b[0m     \u001b[38;5;66;03m# key only used for output\u001b[39;00m\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:663\u001b[0m, in \u001b[0;36mApply.normalize_dictlike_arg\u001b[1;34m(self, how, obj, func)\u001b[0m\n\u001b[0;32m    661\u001b[0m     cols \u001b[38;5;241m=\u001b[39m Index(\u001b[38;5;28mlist\u001b[39m(func\u001b[38;5;241m.\u001b[39mkeys()))\u001b[38;5;241m.\u001b[39mdifference(obj\u001b[38;5;241m.\u001b[39mcolumns, sort\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(cols) \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m0\u001b[39m:\n\u001b[1;32m--> 663\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mColumn(s) \u001b[39m\u001b[38;5;132;01m{\u001b[39;00m\u001b[38;5;28mlist\u001b[39m(cols)\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m do not exist\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m    665\u001b[0m aggregator_types \u001b[38;5;241m=\u001b[39m (\u001b[38;5;28mlist\u001b[39m, \u001b[38;5;28mtuple\u001b[39m, \u001b[38;5;28mdict\u001b[39m)\n\u001b[0;32m    667\u001b[0m \u001b[38;5;66;03m# if we have a dict of any non-scalars\u001b[39;00m\n\u001b[0;32m    668\u001b[0m \u001b[38;5;66;03m# eg. {'A' : ['mean']}, normalize all to\u001b[39;00m\n\u001b[0;32m    669\u001b[0m \u001b[38;5;66;03m# be list-likes\u001b[39;00m\n\u001b[0;32m    670\u001b[0m \u001b[38;5;66;03m# Cannot use func.values() because arg may be a Series\u001b[39;00m\n",
      "\u001b[1;31mKeyError\u001b[0m: \"Column(s) ['number_of_reviews'] do not exist\""
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Read the CSV files with specified encoding and data types\n",
    "dtype_spec = {\n",
    "    'column_5_name': str,   # Replace 'column_5_name' with the actual column name\n",
    "    'column_13_name': str   # Replace 'column_13_name' with the actual column name\n",
    "}\n",
    "\n",
    "listings = pd.read_csv('listings.csv', encoding='latin1', dtype=dtype_spec, low_memory=False)\n",
    "reviews = pd.read_csv('reviews.csv', encoding='latin1', low_memory=False)\n",
    "\n",
    "# Fill missing values using forward fill method\n",
    "listings.ffill(inplace=True)\n",
    "reviews.ffill(inplace=True)\n",
    "\n",
    "# Convert price to string format and then clean it\n",
    "listings['price'] = listings['price'].astype(str).str.replace('$', '').str.replace(',', '').astype(float)\n",
    "\n",
    "# Convert date to datetime format\n",
    "reviews['date'] = pd.to_datetime(reviews['date'])\n",
    "\n",
    "# Group by city and calculate aggregates\n",
    "city_group = listings.groupby('city').agg({\n",
    "    'price': ['mean', 'median', 'std'],\n",
    "    'number_of_reviews': 'sum',\n",
    "    'room_type': lambda x: x.value_counts().idxmax()  # Most common room type\n",
    "}).reset_index()\n",
    "\n",
    "# Flatten multi-level columns and rename them\n",
    "city_group.columns = ['City', 'Avg_Price', 'Median_Price', 'Price_STD', 'Total_Reviews', 'Most_Common_Room_Type']\n",
    "\n",
    "# Display the aggregated DataFrame\n",
    "print(city_group)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "2900c3b9-ece1-4ac3-93b4-54c91197fb8a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['listing_id', 'name', 'host_id', 'host_since', 'host_location',\n",
      "       'host_response_time', 'host_response_rate', 'host_acceptance_rate',\n",
      "       'host_is_superhost', 'host_total_listings_count',\n",
      "       'host_has_profile_pic', 'host_identity_verified', 'neighbourhood',\n",
      "       'district', 'city', 'latitude', 'longitude', 'property_type',\n",
      "       'room_type', 'accommodates', 'bedrooms', 'amenities', 'price',\n",
      "       'minimum_nights', 'maximum_nights', 'review_scores_rating',\n",
      "       'review_scores_accuracy', 'review_scores_cleanliness',\n",
      "       'review_scores_checkin', 'review_scores_communication',\n",
      "       'review_scores_location', 'review_scores_value', 'instant_bookable'],\n",
      "      dtype='object')\n"
     ]
    },
    {
     "ename": "KeyError",
     "evalue": "\"Column(s) ['reviews'] do not exist\"",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[37], line 27\u001b[0m\n\u001b[0;32m     24\u001b[0m \u001b[38;5;28mprint\u001b[39m(listings\u001b[38;5;241m.\u001b[39mcolumns)\n\u001b[0;32m     26\u001b[0m \u001b[38;5;66;03m# Assuming the correct column names for 'reviews' and 'price' are 'reviews' and 'price_per_night'\u001b[39;00m\n\u001b[1;32m---> 27\u001b[0m city_group \u001b[38;5;241m=\u001b[39m listings\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcity\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\n\u001b[0;32m     28\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m: [\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmedian\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstd\u001b[39m\u001b[38;5;124m'\u001b[39m],\n\u001b[0;32m     29\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreviews\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124msum\u001b[39m\u001b[38;5;124m'\u001b[39m,  \u001b[38;5;66;03m# Use the correct column name for reviews\u001b[39;00m\n\u001b[0;32m     30\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mroom_type\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;28;01mlambda\u001b[39;00m x: x\u001b[38;5;241m.\u001b[39mvalue_counts()\u001b[38;5;241m.\u001b[39midxmax()  \u001b[38;5;66;03m# Most common room type\u001b[39;00m\n\u001b[0;32m     31\u001b[0m })\u001b[38;5;241m.\u001b[39mreset_index()\n\u001b[0;32m     33\u001b[0m \u001b[38;5;66;03m# Flatten multi-level columns and rename them\u001b[39;00m\n\u001b[0;32m     34\u001b[0m city_group\u001b[38;5;241m.\u001b[39mcolumns \u001b[38;5;241m=\u001b[39m [\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mCity\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mAvg_Price\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mMedian_Price\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mPrice_STD\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mTotal_Reviews\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mMost_Common_Room_Type\u001b[39m\u001b[38;5;124m'\u001b[39m]\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py:1432\u001b[0m, in \u001b[0;36mDataFrameGroupBy.aggregate\u001b[1;34m(self, func, engine, engine_kwargs, *args, **kwargs)\u001b[0m\n\u001b[0;32m   1429\u001b[0m     kwargs[\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mengine_kwargs\u001b[39m\u001b[38;5;124m\"\u001b[39m] \u001b[38;5;241m=\u001b[39m engine_kwargs\n\u001b[0;32m   1431\u001b[0m op \u001b[38;5;241m=\u001b[39m GroupByApply(\u001b[38;5;28mself\u001b[39m, func, args\u001b[38;5;241m=\u001b[39margs, kwargs\u001b[38;5;241m=\u001b[39mkwargs)\n\u001b[1;32m-> 1432\u001b[0m result \u001b[38;5;241m=\u001b[39m op\u001b[38;5;241m.\u001b[39magg()\n\u001b[0;32m   1433\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m is_dict_like(func) \u001b[38;5;129;01mand\u001b[39;00m result \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   1434\u001b[0m     \u001b[38;5;66;03m# GH #52849\u001b[39;00m\n\u001b[0;32m   1435\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mas_index \u001b[38;5;129;01mand\u001b[39;00m is_list_like(func):\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:190\u001b[0m, in \u001b[0;36mApply.agg\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    187\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mapply_str()\n\u001b[0;32m    189\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_dict_like(func):\n\u001b[1;32m--> 190\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39magg_dict_like()\n\u001b[0;32m    191\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m is_list_like(func):\n\u001b[0;32m    192\u001b[0m     \u001b[38;5;66;03m# we require a list, but not a 'str'\u001b[39;00m\n\u001b[0;32m    193\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39magg_list_like()\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:423\u001b[0m, in \u001b[0;36mApply.agg_dict_like\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    415\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21magg_dict_like\u001b[39m(\u001b[38;5;28mself\u001b[39m) \u001b[38;5;241m-\u001b[39m\u001b[38;5;241m>\u001b[39m DataFrame \u001b[38;5;241m|\u001b[39m Series:\n\u001b[0;32m    416\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[0;32m    417\u001b[0m \u001b[38;5;124;03m    Compute aggregation in the case of a dict-like argument.\u001b[39;00m\n\u001b[0;32m    418\u001b[0m \n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    421\u001b[0m \u001b[38;5;124;03m    Result of aggregation.\u001b[39;00m\n\u001b[0;32m    422\u001b[0m \u001b[38;5;124;03m    \"\"\"\u001b[39;00m\n\u001b[1;32m--> 423\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39magg_or_apply_dict_like(op_name\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124magg\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:1608\u001b[0m, in \u001b[0;36mGroupByApply.agg_or_apply_dict_like\u001b[1;34m(self, op_name)\u001b[0m\n\u001b[0;32m   1603\u001b[0m     kwargs\u001b[38;5;241m.\u001b[39mupdate({\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mengine\u001b[39m\u001b[38;5;124m\"\u001b[39m: engine, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mengine_kwargs\u001b[39m\u001b[38;5;124m\"\u001b[39m: engine_kwargs})\n\u001b[0;32m   1605\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m com\u001b[38;5;241m.\u001b[39mtemp_setattr(\n\u001b[0;32m   1606\u001b[0m     obj, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mas_index\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;28;01mTrue\u001b[39;00m, condition\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mhasattr\u001b[39m(obj, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mas_index\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m   1607\u001b[0m ):\n\u001b[1;32m-> 1608\u001b[0m     result_index, result_data \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcompute_dict_like(\n\u001b[0;32m   1609\u001b[0m         op_name, selected_obj, selection, kwargs\n\u001b[0;32m   1610\u001b[0m     )\n\u001b[0;32m   1611\u001b[0m result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mwrap_results_dict_like(selected_obj, result_index, result_data)\n\u001b[0;32m   1612\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m result\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:462\u001b[0m, in \u001b[0;36mApply.compute_dict_like\u001b[1;34m(self, op_name, selected_obj, selection, kwargs)\u001b[0m\n\u001b[0;32m    460\u001b[0m is_groupby \u001b[38;5;241m=\u001b[39m \u001b[38;5;28misinstance\u001b[39m(obj, (DataFrameGroupBy, SeriesGroupBy))\n\u001b[0;32m    461\u001b[0m func \u001b[38;5;241m=\u001b[39m cast(AggFuncTypeDict, \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfunc)\n\u001b[1;32m--> 462\u001b[0m func \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mnormalize_dictlike_arg(op_name, selected_obj, func)\n\u001b[0;32m    464\u001b[0m is_non_unique_col \u001b[38;5;241m=\u001b[39m (\n\u001b[0;32m    465\u001b[0m     selected_obj\u001b[38;5;241m.\u001b[39mndim \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m2\u001b[39m\n\u001b[0;32m    466\u001b[0m     \u001b[38;5;129;01mand\u001b[39;00m selected_obj\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnunique() \u001b[38;5;241m<\u001b[39m \u001b[38;5;28mlen\u001b[39m(selected_obj\u001b[38;5;241m.\u001b[39mcolumns)\n\u001b[0;32m    467\u001b[0m )\n\u001b[0;32m    469\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m selected_obj\u001b[38;5;241m.\u001b[39mndim \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m    470\u001b[0m     \u001b[38;5;66;03m# key only used for output\u001b[39;00m\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:663\u001b[0m, in \u001b[0;36mApply.normalize_dictlike_arg\u001b[1;34m(self, how, obj, func)\u001b[0m\n\u001b[0;32m    661\u001b[0m     cols \u001b[38;5;241m=\u001b[39m Index(\u001b[38;5;28mlist\u001b[39m(func\u001b[38;5;241m.\u001b[39mkeys()))\u001b[38;5;241m.\u001b[39mdifference(obj\u001b[38;5;241m.\u001b[39mcolumns, sort\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(cols) \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m0\u001b[39m:\n\u001b[1;32m--> 663\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mColumn(s) \u001b[39m\u001b[38;5;132;01m{\u001b[39;00m\u001b[38;5;28mlist\u001b[39m(cols)\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m do not exist\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m    665\u001b[0m aggregator_types \u001b[38;5;241m=\u001b[39m (\u001b[38;5;28mlist\u001b[39m, \u001b[38;5;28mtuple\u001b[39m, \u001b[38;5;28mdict\u001b[39m)\n\u001b[0;32m    667\u001b[0m \u001b[38;5;66;03m# if we have a dict of any non-scalars\u001b[39;00m\n\u001b[0;32m    668\u001b[0m \u001b[38;5;66;03m# eg. {'A' : ['mean']}, normalize all to\u001b[39;00m\n\u001b[0;32m    669\u001b[0m \u001b[38;5;66;03m# be list-likes\u001b[39;00m\n\u001b[0;32m    670\u001b[0m \u001b[38;5;66;03m# Cannot use func.values() because arg may be a Series\u001b[39;00m\n",
      "\u001b[1;31mKeyError\u001b[0m: \"Column(s) ['reviews'] do not exist\""
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Specify data types for columns with mixed types (update column names as needed)\n",
    "dtype_spec = {\n",
    "    'column_5_name': str,   # Replace 'column_5_name' with the actual column name\n",
    "    'column_13_name': str   # Replace 'column_13_name' with the actual column name\n",
    "}\n",
    "\n",
    "# Read the CSV files with specified encoding and data types\n",
    "listings = pd.read_csv('listings.csv', encoding='latin1', dtype=dtype_spec, low_memory=False)\n",
    "reviews = pd.read_csv('reviews.csv', encoding='latin1', low_memory=False)\n",
    "\n",
    "# Fill missing values using forward fill method\n",
    "listings.ffill(inplace=True)\n",
    "reviews.ffill(inplace=True)\n",
    "\n",
    "# Convert price to string format and then clean it\n",
    "listings['price'] = listings['price'].astype(str).str.replace('$', '').str.replace(',', '').astype(float)\n",
    "\n",
    "# Convert date to datetime format\n",
    "reviews['date'] = pd.to_datetime(reviews['date'])\n",
    "\n",
    "# Check column names\n",
    "print(listings.columns)\n",
    "\n",
    "# Assuming the correct column names for 'reviews' and 'price' are 'reviews' and 'price_per_night'\n",
    "city_group = listings.groupby('city').agg({\n",
    "    'price': ['mean', 'median', 'std'],\n",
    "    'reviews': 'sum',  # Use the correct column name for reviews\n",
    "    'room_type': lambda x: x.value_counts().idxmax()  # Most common room type\n",
    "}).reset_index()\n",
    "\n",
    "# Flatten multi-level columns and rename them\n",
    "city_group.columns = ['City', 'Avg_Price', 'Median_Price', 'Price_STD', 'Total_Reviews', 'Most_Common_Room_Type']\n",
    "\n",
    "# Display the aggregated DataFrame\n",
    "print(city_group)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "746eb94c-886f-4a50-9d1e-135ff5ef71ab",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['listing_id', 'name', 'host_id', 'host_since', 'host_location',\n",
      "       'host_response_time', 'host_response_rate', 'host_acceptance_rate',\n",
      "       'host_is_superhost', 'host_total_listings_count',\n",
      "       'host_has_profile_pic', 'host_identity_verified', 'neighbourhood',\n",
      "       'district', 'city', 'latitude', 'longitude', 'property_type',\n",
      "       'room_type', 'accommodates', 'bedrooms', 'amenities', 'price',\n",
      "       'minimum_nights', 'maximum_nights', 'review_scores_rating',\n",
      "       'review_scores_accuracy', 'review_scores_cleanliness',\n",
      "       'review_scores_checkin', 'review_scores_communication',\n",
      "       'review_scores_location', 'review_scores_value', 'instant_bookable'],\n",
      "      dtype='object')\n"
     ]
    },
    {
     "ename": "KeyError",
     "evalue": "\"Column(s) ['number_of_reviews'] do not exist\"",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[39], line 27\u001b[0m\n\u001b[0;32m     23\u001b[0m \u001b[38;5;28mprint\u001b[39m(listings\u001b[38;5;241m.\u001b[39mcolumns)\n\u001b[0;32m     25\u001b[0m \u001b[38;5;66;03m# Adjust column names as needed\u001b[39;00m\n\u001b[0;32m     26\u001b[0m \u001b[38;5;66;03m# For example, if 'number_of_reviews' and 'price' are correct:\u001b[39;00m\n\u001b[1;32m---> 27\u001b[0m city_group \u001b[38;5;241m=\u001b[39m listings\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcity\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\n\u001b[0;32m     28\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m: [\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmedian\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstd\u001b[39m\u001b[38;5;124m'\u001b[39m],\n\u001b[0;32m     29\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mnumber_of_reviews\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124msum\u001b[39m\u001b[38;5;124m'\u001b[39m,  \u001b[38;5;66;03m# Use the correct column name for reviews\u001b[39;00m\n\u001b[0;32m     30\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mroom_type\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;28;01mlambda\u001b[39;00m x: x\u001b[38;5;241m.\u001b[39mvalue_counts()\u001b[38;5;241m.\u001b[39midxmax()  \u001b[38;5;66;03m# Most common room type\u001b[39;00m\n\u001b[0;32m     31\u001b[0m })\u001b[38;5;241m.\u001b[39mreset_index()\n\u001b[0;32m     33\u001b[0m \u001b[38;5;66;03m# Flatten multi-level columns and rename them\u001b[39;00m\n\u001b[0;32m     34\u001b[0m city_group\u001b[38;5;241m.\u001b[39mcolumns \u001b[38;5;241m=\u001b[39m [\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mCity\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mAvg_Price\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mMedian_Price\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mPrice_STD\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mTotal_Reviews\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mMost_Common_Room_Type\u001b[39m\u001b[38;5;124m'\u001b[39m]\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py:1432\u001b[0m, in \u001b[0;36mDataFrameGroupBy.aggregate\u001b[1;34m(self, func, engine, engine_kwargs, *args, **kwargs)\u001b[0m\n\u001b[0;32m   1429\u001b[0m     kwargs[\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mengine_kwargs\u001b[39m\u001b[38;5;124m\"\u001b[39m] \u001b[38;5;241m=\u001b[39m engine_kwargs\n\u001b[0;32m   1431\u001b[0m op \u001b[38;5;241m=\u001b[39m GroupByApply(\u001b[38;5;28mself\u001b[39m, func, args\u001b[38;5;241m=\u001b[39margs, kwargs\u001b[38;5;241m=\u001b[39mkwargs)\n\u001b[1;32m-> 1432\u001b[0m result \u001b[38;5;241m=\u001b[39m op\u001b[38;5;241m.\u001b[39magg()\n\u001b[0;32m   1433\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m is_dict_like(func) \u001b[38;5;129;01mand\u001b[39;00m result \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   1434\u001b[0m     \u001b[38;5;66;03m# GH #52849\u001b[39;00m\n\u001b[0;32m   1435\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mas_index \u001b[38;5;129;01mand\u001b[39;00m is_list_like(func):\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:190\u001b[0m, in \u001b[0;36mApply.agg\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    187\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mapply_str()\n\u001b[0;32m    189\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_dict_like(func):\n\u001b[1;32m--> 190\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39magg_dict_like()\n\u001b[0;32m    191\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m is_list_like(func):\n\u001b[0;32m    192\u001b[0m     \u001b[38;5;66;03m# we require a list, but not a 'str'\u001b[39;00m\n\u001b[0;32m    193\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39magg_list_like()\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:423\u001b[0m, in \u001b[0;36mApply.agg_dict_like\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    415\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21magg_dict_like\u001b[39m(\u001b[38;5;28mself\u001b[39m) \u001b[38;5;241m-\u001b[39m\u001b[38;5;241m>\u001b[39m DataFrame \u001b[38;5;241m|\u001b[39m Series:\n\u001b[0;32m    416\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[0;32m    417\u001b[0m \u001b[38;5;124;03m    Compute aggregation in the case of a dict-like argument.\u001b[39;00m\n\u001b[0;32m    418\u001b[0m \n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    421\u001b[0m \u001b[38;5;124;03m    Result of aggregation.\u001b[39;00m\n\u001b[0;32m    422\u001b[0m \u001b[38;5;124;03m    \"\"\"\u001b[39;00m\n\u001b[1;32m--> 423\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39magg_or_apply_dict_like(op_name\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124magg\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:1608\u001b[0m, in \u001b[0;36mGroupByApply.agg_or_apply_dict_like\u001b[1;34m(self, op_name)\u001b[0m\n\u001b[0;32m   1603\u001b[0m     kwargs\u001b[38;5;241m.\u001b[39mupdate({\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mengine\u001b[39m\u001b[38;5;124m\"\u001b[39m: engine, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mengine_kwargs\u001b[39m\u001b[38;5;124m\"\u001b[39m: engine_kwargs})\n\u001b[0;32m   1605\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m com\u001b[38;5;241m.\u001b[39mtemp_setattr(\n\u001b[0;32m   1606\u001b[0m     obj, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mas_index\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;28;01mTrue\u001b[39;00m, condition\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mhasattr\u001b[39m(obj, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mas_index\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m   1607\u001b[0m ):\n\u001b[1;32m-> 1608\u001b[0m     result_index, result_data \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcompute_dict_like(\n\u001b[0;32m   1609\u001b[0m         op_name, selected_obj, selection, kwargs\n\u001b[0;32m   1610\u001b[0m     )\n\u001b[0;32m   1611\u001b[0m result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mwrap_results_dict_like(selected_obj, result_index, result_data)\n\u001b[0;32m   1612\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m result\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:462\u001b[0m, in \u001b[0;36mApply.compute_dict_like\u001b[1;34m(self, op_name, selected_obj, selection, kwargs)\u001b[0m\n\u001b[0;32m    460\u001b[0m is_groupby \u001b[38;5;241m=\u001b[39m \u001b[38;5;28misinstance\u001b[39m(obj, (DataFrameGroupBy, SeriesGroupBy))\n\u001b[0;32m    461\u001b[0m func \u001b[38;5;241m=\u001b[39m cast(AggFuncTypeDict, \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfunc)\n\u001b[1;32m--> 462\u001b[0m func \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mnormalize_dictlike_arg(op_name, selected_obj, func)\n\u001b[0;32m    464\u001b[0m is_non_unique_col \u001b[38;5;241m=\u001b[39m (\n\u001b[0;32m    465\u001b[0m     selected_obj\u001b[38;5;241m.\u001b[39mndim \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m2\u001b[39m\n\u001b[0;32m    466\u001b[0m     \u001b[38;5;129;01mand\u001b[39;00m selected_obj\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnunique() \u001b[38;5;241m<\u001b[39m \u001b[38;5;28mlen\u001b[39m(selected_obj\u001b[38;5;241m.\u001b[39mcolumns)\n\u001b[0;32m    467\u001b[0m )\n\u001b[0;32m    469\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m selected_obj\u001b[38;5;241m.\u001b[39mndim \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m    470\u001b[0m     \u001b[38;5;66;03m# key only used for output\u001b[39;00m\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:663\u001b[0m, in \u001b[0;36mApply.normalize_dictlike_arg\u001b[1;34m(self, how, obj, func)\u001b[0m\n\u001b[0;32m    661\u001b[0m     cols \u001b[38;5;241m=\u001b[39m Index(\u001b[38;5;28mlist\u001b[39m(func\u001b[38;5;241m.\u001b[39mkeys()))\u001b[38;5;241m.\u001b[39mdifference(obj\u001b[38;5;241m.\u001b[39mcolumns, sort\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(cols) \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m0\u001b[39m:\n\u001b[1;32m--> 663\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mColumn(s) \u001b[39m\u001b[38;5;132;01m{\u001b[39;00m\u001b[38;5;28mlist\u001b[39m(cols)\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m do not exist\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m    665\u001b[0m aggregator_types \u001b[38;5;241m=\u001b[39m (\u001b[38;5;28mlist\u001b[39m, \u001b[38;5;28mtuple\u001b[39m, \u001b[38;5;28mdict\u001b[39m)\n\u001b[0;32m    667\u001b[0m \u001b[38;5;66;03m# if we have a dict of any non-scalars\u001b[39;00m\n\u001b[0;32m    668\u001b[0m \u001b[38;5;66;03m# eg. {'A' : ['mean']}, normalize all to\u001b[39;00m\n\u001b[0;32m    669\u001b[0m \u001b[38;5;66;03m# be list-likes\u001b[39;00m\n\u001b[0;32m    670\u001b[0m \u001b[38;5;66;03m# Cannot use func.values() because arg may be a Series\u001b[39;00m\n",
      "\u001b[1;31mKeyError\u001b[0m: \"Column(s) ['number_of_reviews'] do not exist\""
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Read the CSV files with specified encoding and data types\n",
    "dtype_spec = {\n",
    "    'column_5_name': str,   # Replace 'column_5_name' with the actual column name\n",
    "    'column_13_name': str   # Replace 'column_13_name' with the actual column name\n",
    "}\n",
    "\n",
    "listings = pd.read_csv('listings.csv', encoding='latin1', dtype=dtype_spec, low_memory=False)\n",
    "reviews = pd.read_csv('reviews.csv', encoding='latin1', low_memory=False)\n",
    "\n",
    "# Fill missing values using forward fill method\n",
    "listings.ffill(inplace=True)\n",
    "reviews.ffill(inplace=True)\n",
    "\n",
    "# Convert price to string format and then clean it\n",
    "listings['price'] = listings['price'].astype(str).str.replace('$', '').str.replace(',', '').astype(float)\n",
    "\n",
    "# Convert date to datetime format\n",
    "reviews['date'] = pd.to_datetime(reviews['date'])\n",
    "\n",
    "# Check column names\n",
    "print(listings.columns)\n",
    "\n",
    "# Adjust column names as needed\n",
    "# For example, if 'number_of_reviews' and 'price' are correct:\n",
    "city_group = listings.groupby('city').agg({\n",
    "    'price': ['mean', 'median', 'std'],\n",
    "    'number_of_reviews': 'sum',  # Use the correct column name for reviews\n",
    "    'room_type': lambda x: x.value_counts().idxmax()  # Most common room type\n",
    "}).reset_index()\n",
    "\n",
    "# Flatten multi-level columns and rename them\n",
    "city_group.columns = ['City', 'Avg_Price', 'Median_Price', 'Price_STD', 'Total_Reviews', 'Most_Common_Room_Type']\n",
    "\n",
    "# Display the aggregated DataFrame\n",
    "print(city_group)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "3a10788e-2073-4a23-b686-e44be5872140",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['listing_id', 'name', 'host_id', 'host_since', 'host_location',\n",
      "       'host_response_time', 'host_response_rate', 'host_acceptance_rate',\n",
      "       'host_is_superhost', 'host_total_listings_count',\n",
      "       'host_has_profile_pic', 'host_identity_verified', 'neighbourhood',\n",
      "       'district', 'city', 'latitude', 'longitude', 'property_type',\n",
      "       'room_type', 'accommodates', 'bedrooms', 'amenities', 'price',\n",
      "       'minimum_nights', 'maximum_nights', 'review_scores_rating',\n",
      "       'review_scores_accuracy', 'review_scores_cleanliness',\n",
      "       'review_scores_checkin', 'review_scores_communication',\n",
      "       'review_scores_location', 'review_scores_value', 'instant_bookable'],\n",
      "      dtype='object')\n"
     ]
    },
    {
     "ename": "KeyError",
     "evalue": "\"Column(s) ['review_count'] do not exist\"",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[43], line 22\u001b[0m\n\u001b[0;32m     18\u001b[0m \u001b[38;5;28mprint\u001b[39m(listings\u001b[38;5;241m.\u001b[39mcolumns)\n\u001b[0;32m     20\u001b[0m \u001b[38;5;66;03m# Adjust column names as needed\u001b[39;00m\n\u001b[0;32m     21\u001b[0m \u001b[38;5;66;03m# For example, if 'review_count' and 'price' are correct:\u001b[39;00m\n\u001b[1;32m---> 22\u001b[0m city_group \u001b[38;5;241m=\u001b[39m listings\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcity\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\n\u001b[0;32m     23\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m: [\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmedian\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstd\u001b[39m\u001b[38;5;124m'\u001b[39m],\n\u001b[0;32m     24\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_count\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124msum\u001b[39m\u001b[38;5;124m'\u001b[39m,  \u001b[38;5;66;03m# Adjust this based on actual column name\u001b[39;00m\n\u001b[0;32m     25\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mroom_type\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;28;01mlambda\u001b[39;00m x: x\u001b[38;5;241m.\u001b[39mvalue_counts()\u001b[38;5;241m.\u001b[39midxmax()  \u001b[38;5;66;03m# Most common room type\u001b[39;00m\n\u001b[0;32m     26\u001b[0m })\u001b[38;5;241m.\u001b[39mreset_index()\n\u001b[0;32m     28\u001b[0m \u001b[38;5;66;03m# Flatten multi-level columns and rename them\u001b[39;00m\n\u001b[0;32m     29\u001b[0m city_group\u001b[38;5;241m.\u001b[39mcolumns \u001b[38;5;241m=\u001b[39m [\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mCity\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mAvg_Price\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mMedian_Price\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mPrice_STD\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mTotal_Reviews\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mMost_Common_Room_Type\u001b[39m\u001b[38;5;124m'\u001b[39m]\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py:1432\u001b[0m, in \u001b[0;36mDataFrameGroupBy.aggregate\u001b[1;34m(self, func, engine, engine_kwargs, *args, **kwargs)\u001b[0m\n\u001b[0;32m   1429\u001b[0m     kwargs[\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mengine_kwargs\u001b[39m\u001b[38;5;124m\"\u001b[39m] \u001b[38;5;241m=\u001b[39m engine_kwargs\n\u001b[0;32m   1431\u001b[0m op \u001b[38;5;241m=\u001b[39m GroupByApply(\u001b[38;5;28mself\u001b[39m, func, args\u001b[38;5;241m=\u001b[39margs, kwargs\u001b[38;5;241m=\u001b[39mkwargs)\n\u001b[1;32m-> 1432\u001b[0m result \u001b[38;5;241m=\u001b[39m op\u001b[38;5;241m.\u001b[39magg()\n\u001b[0;32m   1433\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m is_dict_like(func) \u001b[38;5;129;01mand\u001b[39;00m result \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   1434\u001b[0m     \u001b[38;5;66;03m# GH #52849\u001b[39;00m\n\u001b[0;32m   1435\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mas_index \u001b[38;5;129;01mand\u001b[39;00m is_list_like(func):\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:190\u001b[0m, in \u001b[0;36mApply.agg\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    187\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mapply_str()\n\u001b[0;32m    189\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_dict_like(func):\n\u001b[1;32m--> 190\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39magg_dict_like()\n\u001b[0;32m    191\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m is_list_like(func):\n\u001b[0;32m    192\u001b[0m     \u001b[38;5;66;03m# we require a list, but not a 'str'\u001b[39;00m\n\u001b[0;32m    193\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39magg_list_like()\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:423\u001b[0m, in \u001b[0;36mApply.agg_dict_like\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    415\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21magg_dict_like\u001b[39m(\u001b[38;5;28mself\u001b[39m) \u001b[38;5;241m-\u001b[39m\u001b[38;5;241m>\u001b[39m DataFrame \u001b[38;5;241m|\u001b[39m Series:\n\u001b[0;32m    416\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[0;32m    417\u001b[0m \u001b[38;5;124;03m    Compute aggregation in the case of a dict-like argument.\u001b[39;00m\n\u001b[0;32m    418\u001b[0m \n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    421\u001b[0m \u001b[38;5;124;03m    Result of aggregation.\u001b[39;00m\n\u001b[0;32m    422\u001b[0m \u001b[38;5;124;03m    \"\"\"\u001b[39;00m\n\u001b[1;32m--> 423\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39magg_or_apply_dict_like(op_name\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124magg\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:1608\u001b[0m, in \u001b[0;36mGroupByApply.agg_or_apply_dict_like\u001b[1;34m(self, op_name)\u001b[0m\n\u001b[0;32m   1603\u001b[0m     kwargs\u001b[38;5;241m.\u001b[39mupdate({\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mengine\u001b[39m\u001b[38;5;124m\"\u001b[39m: engine, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mengine_kwargs\u001b[39m\u001b[38;5;124m\"\u001b[39m: engine_kwargs})\n\u001b[0;32m   1605\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m com\u001b[38;5;241m.\u001b[39mtemp_setattr(\n\u001b[0;32m   1606\u001b[0m     obj, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mas_index\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;28;01mTrue\u001b[39;00m, condition\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mhasattr\u001b[39m(obj, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mas_index\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m   1607\u001b[0m ):\n\u001b[1;32m-> 1608\u001b[0m     result_index, result_data \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcompute_dict_like(\n\u001b[0;32m   1609\u001b[0m         op_name, selected_obj, selection, kwargs\n\u001b[0;32m   1610\u001b[0m     )\n\u001b[0;32m   1611\u001b[0m result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mwrap_results_dict_like(selected_obj, result_index, result_data)\n\u001b[0;32m   1612\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m result\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:462\u001b[0m, in \u001b[0;36mApply.compute_dict_like\u001b[1;34m(self, op_name, selected_obj, selection, kwargs)\u001b[0m\n\u001b[0;32m    460\u001b[0m is_groupby \u001b[38;5;241m=\u001b[39m \u001b[38;5;28misinstance\u001b[39m(obj, (DataFrameGroupBy, SeriesGroupBy))\n\u001b[0;32m    461\u001b[0m func \u001b[38;5;241m=\u001b[39m cast(AggFuncTypeDict, \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfunc)\n\u001b[1;32m--> 462\u001b[0m func \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mnormalize_dictlike_arg(op_name, selected_obj, func)\n\u001b[0;32m    464\u001b[0m is_non_unique_col \u001b[38;5;241m=\u001b[39m (\n\u001b[0;32m    465\u001b[0m     selected_obj\u001b[38;5;241m.\u001b[39mndim \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m2\u001b[39m\n\u001b[0;32m    466\u001b[0m     \u001b[38;5;129;01mand\u001b[39;00m selected_obj\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnunique() \u001b[38;5;241m<\u001b[39m \u001b[38;5;28mlen\u001b[39m(selected_obj\u001b[38;5;241m.\u001b[39mcolumns)\n\u001b[0;32m    467\u001b[0m )\n\u001b[0;32m    469\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m selected_obj\u001b[38;5;241m.\u001b[39mndim \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m    470\u001b[0m     \u001b[38;5;66;03m# key only used for output\u001b[39;00m\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\apply.py:663\u001b[0m, in \u001b[0;36mApply.normalize_dictlike_arg\u001b[1;34m(self, how, obj, func)\u001b[0m\n\u001b[0;32m    661\u001b[0m     cols \u001b[38;5;241m=\u001b[39m Index(\u001b[38;5;28mlist\u001b[39m(func\u001b[38;5;241m.\u001b[39mkeys()))\u001b[38;5;241m.\u001b[39mdifference(obj\u001b[38;5;241m.\u001b[39mcolumns, sort\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(cols) \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m0\u001b[39m:\n\u001b[1;32m--> 663\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mColumn(s) \u001b[39m\u001b[38;5;132;01m{\u001b[39;00m\u001b[38;5;28mlist\u001b[39m(cols)\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m do not exist\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m    665\u001b[0m aggregator_types \u001b[38;5;241m=\u001b[39m (\u001b[38;5;28mlist\u001b[39m, \u001b[38;5;28mtuple\u001b[39m, \u001b[38;5;28mdict\u001b[39m)\n\u001b[0;32m    667\u001b[0m \u001b[38;5;66;03m# if we have a dict of any non-scalars\u001b[39;00m\n\u001b[0;32m    668\u001b[0m \u001b[38;5;66;03m# eg. {'A' : ['mean']}, normalize all to\u001b[39;00m\n\u001b[0;32m    669\u001b[0m \u001b[38;5;66;03m# be list-likes\u001b[39;00m\n\u001b[0;32m    670\u001b[0m \u001b[38;5;66;03m# Cannot use func.values() because arg may be a Series\u001b[39;00m\n",
      "\u001b[1;31mKeyError\u001b[0m: \"Column(s) ['review_count'] do not exist\""
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Assuming the column names are corrected and files are read correctly\n",
    "listings = pd.read_csv('listings.csv', encoding='latin1', dtype=dtype_spec, low_memory=False)\n",
    "reviews = pd.read_csv('reviews.csv', encoding='latin1', low_memory=False)\n",
    "\n",
    "# Fill missing values using forward fill method\n",
    "listings.ffill(inplace=True)\n",
    "reviews.ffill(inplace=True)\n",
    "\n",
    "# Convert price to numeric format\n",
    "listings['price'] = listings['price'].astype(str).str.replace('$', '').str.replace(',', '').astype(float)\n",
    "\n",
    "# Convert date to datetime format\n",
    "reviews['date'] = pd.to_datetime(reviews['date'])\n",
    "\n",
    "# Check column names\n",
    "print(listings.columns)\n",
    "\n",
    "# Adjust column names as needed\n",
    "# For example, if 'review_count' and 'price' are correct:\n",
    "city_group = listings.groupby('city').agg({\n",
    "    'price': ['mean', 'median', 'std'],\n",
    "    'review_count': 'sum',  # Adjust this based on actual column name\n",
    "    'room_type': lambda x: x.value_counts().idxmax()  # Most common room type\n",
    "}).reset_index()\n",
    "\n",
    "# Flatten multi-level columns and rename them\n",
    "city_group.columns = ['City', 'Avg_Price', 'Median_Price', 'Price_STD', 'Total_Reviews', 'Most_Common_Room_Type']\n",
    "\n",
    "# Display the aggregated DataFrame\n",
    "print(city_group)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "ad68a145-d91a-43a5-bf17-111ee8ae7aaf",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['listing_id', 'name', 'host_id', 'host_since', 'host_location',\n",
      "       'host_response_time', 'host_response_rate', 'host_acceptance_rate',\n",
      "       'host_is_superhost', 'host_total_listings_count',\n",
      "       'host_has_profile_pic', 'host_identity_verified', 'neighbourhood',\n",
      "       'district', 'city', 'latitude', 'longitude', 'property_type',\n",
      "       'room_type', 'accommodates', 'bedrooms', 'amenities', 'price',\n",
      "       'minimum_nights', 'maximum_nights', 'review_scores_rating',\n",
      "       'review_scores_accuracy', 'review_scores_cleanliness',\n",
      "       'review_scores_checkin', 'review_scores_communication',\n",
      "       'review_scores_location', 'review_scores_value', 'instant_bookable'],\n",
      "      dtype='object')\n"
     ]
    }
   ],
   "source": [
    "print(listings.columns)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "7a5657d5-1634-4142-94b1-cd633ba5f27c",
   "metadata": {},
   "outputs": [],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "31ad9e60-fe29-4f87-8551-15c04d732d52",
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'city_group' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[49], line 3\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;66;03m# Example of city_group DataFrame setup\u001b[39;00m\n\u001b[0;32m      2\u001b[0m \u001b[38;5;66;03m# Ensure that 'city_group' is already defined with necessary data\u001b[39;00m\n\u001b[1;32m----> 3\u001b[0m \u001b[38;5;28mprint\u001b[39m(city_group\u001b[38;5;241m.\u001b[39mhead())\n",
      "\u001b[1;31mNameError\u001b[0m: name 'city_group' is not defined"
     ]
    }
   ],
   "source": [
    "# Example of city_group DataFrame setup\n",
    "# Ensure that 'city_group' is already defined with necessary data\n",
    "print(city_group.head())  # Check the first few rows to verify data\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "9f1c12dd-a290-4038-bd49-10213a40b49d",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Example of creating the city_group DataFrame\n",
    "# This is a mock example; replace with your actual data and column names\n",
    "data = {\n",
    "    'city': ['New York', 'Los Angeles', 'Chicago', 'Houston', 'Phoenix'],\n",
    "    'price': [200, 150, 180, 170, 160],\n",
    "    'number_of_reviews': [100, 80, 120, 90, 110],\n",
    "    'room_type': ['Entire home', 'Private room', 'Entire home', 'Entire home', 'Private room']\n",
    "}\n",
    "\n",
    "# Creating a sample DataFrame\n",
    "listings = pd.DataFrame(data)\n",
    "\n",
    "# Group by city and calculate aggregates\n",
    "city_group = listings.groupby('city').agg({\n",
    "    'price': ['mean', 'median', 'std'],\n",
    "    'number_of_reviews': 'sum',\n",
    "    'room_type': lambda x: x.value_counts().idxmax()  # Most common room type\n",
    "}).reset_index()\n",
    "\n",
    "# Flatten multi-level columns and rename them\n",
    "city_group.columns = ['City', 'Avg_Price', 'Median_Price', 'Price_STD', 'Total_Reviews', 'Most_Common_Room_Type']\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "ac944f00-7438-4378-b171-792f84259e05",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['City', 'Avg_Price', 'Median_Price', 'Price_STD', 'Total_Reviews',\n",
      "       'Most_Common_Room_Type'],\n",
      "      dtype='object')\n",
      "          City  Avg_Price  Median_Price  Price_STD  Total_Reviews  \\\n",
      "0      Chicago      180.0         180.0        NaN            120   \n",
      "1      Houston      170.0         170.0        NaN             90   \n",
      "2  Los Angeles      150.0         150.0        NaN             80   \n",
      "3     New York      200.0         200.0        NaN            100   \n",
      "4      Phoenix      160.0         160.0        NaN            110   \n",
      "\n",
      "  Most_Common_Room_Type  \n",
      "0           Entire home  \n",
      "1           Entire home  \n",
      "2          Private room  \n",
      "3           Entire home  \n",
      "4          Private room  \n"
     ]
    }
   ],
   "source": [
    "print(city_group.columns)  # Verify column names\n",
    "print(city_group.head())   # Check the first few rows\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "6d09bc43-6dbc-4fed-9fd6-4a5617046d97",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA+4AAAIhCAYAAADQLeBrAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjguNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8fJSN1AAAACXBIWXMAAA9hAAAPYQGoP6dpAABQT0lEQVR4nO3de3zP9f//8fvbDm/DNmZmG3NsiKEcOtCHzWmtckhF+JRDSWHS6CAdqD6UTzo4pGjmWHwSkvMIKRKT86EpQjZKZuYwsz1/f/h6/7xtzGrzfs1u18vldbl4PZ/P1+v9eL289t77vtfhbTPGGAEAAAAAAEsq5uoCAAAAAADA1RHcAQAAAACwMII7AAAAAAAWRnAHAAAAAMDCCO4AAAAAAFgYwR0AAAAAAAsjuAMAAAAAYGEEdwAAAAAALIzgDgAAAACAhRHcAQBFypgxY2Sz2RQWFubqUiwnPDxcNpvNMXl5eal+/fr64IMPlJWVdV3rsNlsGjZsWMEWeoXw8PAb9v+Znp6ucePG6Z577lGZMmXk6empChUqqFOnTlqzZo1j3OrVq2Wz2bR69WpH2+LFi2/4vgEA3BwI7gCAImXy5MmSpJ07d2rDhg0ursZ6qlWrpvXr12v9+vWaPXu2KlSooOeee05Dhgy5ruXXr1+vJ598soCrdI0///xTTZs2VUxMjMLCwjRlyhStXLlSo0ePlpubm1q2bKmtW7dKkho0aKD169erQYMGjuUXL16s4cOHu6p8AEAhZjPGGFcXAQDAjbBp0yY1btxY999/vxYtWqTevXtr4sSJN7QGY4zOnTsnLy+vG/q61yM8PFx//vmnduzY4WjLyMhQrVq1lJycrJSUFHl4eGRbztXblFPdBeG+++5TfHy8li1bphYtWmTr37hxo8qXL69KlSrluHz//v01fvx48dELAJBXnHEHABQZsbGxkqS3335bTZo00axZs3TmzBlJFwNqQECAHnvssWzLpaSkyMvLSzExMY621NRUDR48WFWrVnVcLj1w4ECdPn3aaVmbzab+/fvr448/1q233iq73a6pU6dKkoYPH64777xTfn5+8vHxUYMGDRQbG5st2KWnp2vQoEEKDAxUiRIl1KxZMyUkJKhKlSrq0aOH09jk5GT16dNHFStWlKenp6pWrarhw4frwoULf2ufeXh4qGHDhjpz5oz++OOPXLcpp0vlf//9dz311FMKCQmRp6engoOD9fDDD+vo0aN53p/XsnbtWt11113y8vJShQoV9OqrryozM1PSxT8uhIaGKjIyMttyaWlp8vX1Vb9+/a667oSEBC1ZskRPPPFEjqFdkho3buwI7VdeKt+jRw+NHz/esY8uTQcOHFDLli1Vq1atbP/vxhjdcsstuv/++697HwAAbk7uri4AAIAb4ezZs/r888/VuHFjhYWFqVevXnryySf1xRdfqHv37vLw8NC///1vffzxxxo/frx8fHwcy37++ec6d+6cevbsKUk6c+aMmjdvrsOHD+vll19WvXr1tHPnTr322mvavn27VqxYIZvN5lh+/vz5Wrt2rV577TUFBgYqICBAknTgwAH16dPHEfZ++OEHRUdH6/fff9drr73mWL5nz56aPXu2XnjhBbVo0UK7du3Sgw8+qNTUVKdtTE5O1h133KFixYrptddeU/Xq1bV+/Xq99dZbOnDggOLi4v7Wvvvll1/k7u6uMmXK5LpNV/r999/VuHFjZWRkOPbV8ePHtWzZMp04cULly5fP8/7MSXJysh599FG99NJLeuONN7Ro0SK99dZbOnHihMaNGyebzabo6GgNHDhQiYmJCg0NdSw7bdo0paamXjO4L1++XJLUoUOHPOy5/+/VV1/V6dOnNWfOHK1fv97RHhQUpGeffVbt27fXypUr1apVK0ffkiVL9Msvv2jMmDF/6zUBADcRAwBAETBt2jQjyXz88cfGGGNOnTplSpUqZf71r385xmzbts1IMhMnTnRa9o477jANGzZ0zI8cOdIUK1bMbNy40WncnDlzjCSzePFiR5sk4+vra/76669r1peZmWkyMjLMG2+8YcqWLWuysrKMMcbs3LnTSDIvvvii0/jPP//cSDLdu3d3tPXp08eUKlXK/Pbbb05j3333XSPJ7Ny585o1NG/e3NSpU8dkZGSYjIwMc+TIEfPSSy8ZSeaRRx65rm2SZF5//XXHfK9evYyHh4fZtWvXVV83L/vzanVLMl999ZVTe+/evU2xYsUc+yM1NdV4e3ubZ5991mlc7dq1TURExDVf4+mnnzaSzJ49e6457pJVq1YZSWbVqlWOtn79+pmcPnplZmaaatWqmfbt2zu1R0VFmerVqzuOBQBA0cWl8gCAIiE2NlZeXl569NFHJUmlSpXSI488orVr1yoxMVGSVLduXTVs2NDpzPTu3bv1448/qlevXo62hQsXKiwsTLfddpsuXLjgmCIjI7M9SVySWrRo4XS2+pJvvvlGrVq1kq+vr9zc3OTh4aHXXntNx48f17FjxyTJ8aTyTp06OS378MMPy93d+cK5hQsXKiIiQsHBwU51RUVFOa3rWnbu3CkPDw95eHgoODhYo0ePVrdu3TRp0qTr2qYrLVmyRBEREbr11luvOiav+zMn3t7eateunVNb165dlZWVpW+//dYxpmfPnpoyZYrjEvxvvvlGu3btUv/+/XN9jYJSrFgx9e/fXwsXLtTBgwclXbzKYenSperbt2+uVxsAAG5+BHcAwE1v3759+vbbb3X//ffLGKOUlBSlpKTo4YcflvT/nzQvSb169dL69eu1Z88eSVJcXJzsdru6dOniGHP06FFt27bNEXAvTd7e3jLG6M8//3R6/aCgoGw1/fjjj2rTpo0kadKkSfr++++1ceNGDR06VNLFS/sl6fjx45Kk8uXLOy3v7u6usmXLOrUdPXpUX3/9dba66tSpI0nZ6spJ9erVtXHjRm3atEk7duxQSkqKZsyYIV9f31y3KSd//PGHKlaseM0xed2fObly/0hSYGCgpP+/DyUpOjpap06d0syZMyVJ48aNU8WKFdW+fftrrv/S7Qz79+/PtZa/o1evXvLy8tLHH38sSRo/fry8vLyc/mAEACi6uMcdAHDTmzx5sowxmjNnjubMmZOtf+rUqXrrrbfk5uamLl26KCYmRlOmTNF//vMfTZ8+XR06dHA6u+zv7y8vLy+nwH85f39/p/mczpjOmjVLHh4eWrhwoYoXL+5onz9/vtO4S+H86NGjqlChgqP9woULToH00uvWq1dP//nPf3KsKzg4OMf2yxUvXlyNGjXKddz1ngUuV66cDh8+fM0xed2fObn8QXeXJCcnS5LTHzhuueUWRUVFafz48YqKitKCBQs0fPhwubm5XXP9kZGRevnllzV//nzde++9udaTV76+vurevbs+/fRTDR48WHFxceratatKly6d768FACh8CO4AgJtaZmampk6dqurVq+vTTz/N1r9w4UKNHj1aS5Ys0QMPPKAyZcqoQ4cOmjZtmu6++24lJydnO+v5wAMPaMSIESpbtqyqVq36t+qy2Wxyd3d3Coxnz57V9OnTncY1a9ZMkjR79myn7wSfM2dOtifFP/DAA1q8eLGqV69+XZex3whRUVGaPn269u7dq5o1a+Y4Jj/256lTp7RgwQKny+U/++wzFStWzLEPL3n22WfVpk0bde/eXW5uburdu3eu62/QoIGioqIUGxurTp065fhk+U2bNikgIOCqXwdnt9slXfx/zumr8wYMGKCPPvpIDz/8sFJSUlx6+T4AwFoI7gCAm9qSJUt05MgRvfPOOwoPD8/WHxYWpnHjxik2NlYPPPCApIuXLc+ePVv9+/dXxYoVnZ70LUkDBw7Ul19+qWbNmum5555TvXr1lJWVpYMHD2r58uUaNGiQ7rzzzmvWdf/99+u9995T165d9dRTT+n48eN69913HeHukjp16qhLly4aPXq03Nzc1KJFC+3cuVOjR4+Wr6+vihX7/3e9vfHGG4qPj1eTJk00YMAA1axZU+fOndOBAwe0ePFiffzxx7letp7f3njjDS1ZskTNmjXTyy+/rLp16yolJUVLly5VTEyMatWqlS/7s2zZsnrmmWd08OBB1ahRQ4sXL9akSZP0zDPPZAvSrVu3Vu3atbVq1Sr9+9//vuoT8a80bdo03XvvvYqKilKvXr0UFRWlMmXKKCkpSV9//bU+//xzJSQkXDW4161bV5L0zjvvKCoqSm5ubqpXr548PT0lSTVq1NC9996rJUuW6J577lH9+vWvqy4AQBHg2mfjAQBQsDp06GA8PT3NsWPHrjrm0UcfNe7u7iY5OdkYc/Ep3yEhIUaSGTp0aI7LpKWlmVdeecXUrFnTeHp6Gl9fX1O3bl3z3HPPOdZjzMWnrPfr1y/HdUyePNnUrFnT2O12U61aNTNy5EgTGxtrJJn9+/c7xp07d87ExMSYgIAAU7x4cXPXXXeZ9evXG19fX/Pcc885rfOPP/4wAwYMMFWrVjUeHh7Gz8/PNGzY0AwdOtSkpaVdc19deqp8bq61TbriqfLGGHPo0CHTq1cvExgYaDw8PExwcLDp1KmTOXr0qGPM9e7Pa9W9evVq06hRI2O3201QUJB5+eWXTUZGRo7LDBs2zEgyP/zwQ67be7mzZ8+aMWPGmLvvvtv4+PgYd3d3ExwcbDp27GgWLVrkGJfTU+XT09PNk08+acqVK2dsNlu2/2djjJkyZYqRZGbNmpWnugAANzebMca47K8GAADgb1m3bp2aNm2qmTNnqmvXrq4up9Bp1KiRbDabNm7c6OpSnDz00EP64YcfdODAAXl4eLi6HACARXCpPAAAFhcfH6/169erYcOG8vLy0tatW/X2228rNDRUHTt2dHV5hUZqaqp27NihhQsXKiEhQfPmzXN1SZKk9PR0bd68WT/++KPmzZun9957j9AOAHBCcAcAwOJ8fHy0fPlyffDBBzp16pT8/f0VFRWlkSNHOj2RHte2efNmRUREqGzZsnr99dfVoUMHV5ckSUpKSlKTJk3k4+OjPn36KDo62tUlAQAshkvlAQAAAACwsGK5DwEAAAAAAK5CcAcAAAAAwMII7gAAAAAAWBgPp5OUlZWlI0eOyNvbWzabzdXlAAAAAABucsYYnTp1SsHBwSpW7Nrn1Anuko4cOaKQkBBXlwEAAAAAKGIOHTqkihUrXnMMwV2St7e3pIs7zMfHx8XVAAAAAABudqmpqQoJCXHk0WshuEuOy+N9fHwI7gAAAACAG+Z6btfm4XQAAAAAAFgYwR0AAAAAAAsjuAMAAAAAYGEEdwAAAAAALIzgDgAAAACAhRHcAQAAAACwMII7AAAAAAAWRnAHAAAAAMDCCO4AAAAAAFgYwR0AAAAAAAsjuAMAAAAAYGEEdwAAAAAALIzgDgAAAACAhRHcAQAAAACwMII7AAAAAAAW5tLgPnLkSDVu3Fje3t4KCAhQhw4dtHfvXqcxxhgNGzZMwcHB8vLyUnh4uHbu3Ok0Jj09XdHR0fL391fJkiXVrl07HT58+EZuCgAAAAAABcKlwX3NmjXq16+ffvjhB8XHx+vChQtq06aNTp8+7RgzatQovffeexo3bpw2btyowMBAtW7dWqdOnXKMGThwoObNm6dZs2bpu+++U1pamh544AFlZma6YrMAAAAAAMg3NmOMcXURl/zxxx8KCAjQmjVr1KxZMxljFBwcrIEDB+rFF1+UdPHsevny5fXOO++oT58+OnnypMqVK6fp06erc+fOkqQjR44oJCREixcvVmRkZK6vm5qaKl9fX508eVI+Pj4Fuo0AAAAAAOQlh1rqHveTJ09Kkvz8/CRJ+/fvV3Jystq0aeMYY7fb1bx5c61bt06SlJCQoIyMDKcxwcHBCgsLc4y5Unp6ulJTU50mAAAAAACsyN3VBVxijFFMTIzuuecehYWFSZKSk5MlSeXLl3caW758ef3222+OMZ6enipTpky2MZeWv9LIkSM1fPjw/N4EAACAQqfh89NcXQJuIgn/fdzVJQA3Jcucce/fv7+2bdumzz//PFufzWZzmjfGZGu70rXGDBkyRCdPnnRMhw4d+vuFAwAAAABQgCwR3KOjo7VgwQKtWrVKFStWdLQHBgZKUrYz58eOHXOchQ8MDNT58+d14sSJq465kt1ul4+Pj9MEAAAAAIAVuTS4G2PUv39/zZ07V998842qVq3q1F+1alUFBgYqPj7e0Xb+/HmtWbNGTZo0kSQ1bNhQHh4eTmOSkpK0Y8cOxxgAAAAAAAorl97j3q9fP3322Wf66quv5O3t7Tiz7uvrKy8vL9lsNg0cOFAjRoxQaGioQkNDNWLECJUoUUJdu3Z1jH3iiSc0aNAglS1bVn5+fho8eLDq1q2rVq1auXLzAAAAAAD4x1wa3CdMmCBJCg8Pd2qPi4tTjx49JEkvvPCCzp49q759++rEiRO68847tXz5cnl7ezvGv//++3J3d1enTp109uxZtWzZUlOmTJGbm9uN2hQAAAAAAAqEpb7H3VX4HncAAFBU8VR55CeeKg9cv0L7Pe4AAAAAAMAZwR0AAAAAAAsjuAMAAAAAYGEEdwAAAAAALIzgDgAAAACAhRHcAQAAAACwMII7AAAAAAAWRnAHAAAAAMDCCO4AAAAAAFgYwR0AAAAAAAsjuAMAAAAAYGEEdwAAAAAALIzgDgAAAACAhRHcAQAAAACwMII7AAAAAAAWRnAHAAAAAMDCCO4AAAAAAFgYwR0AAAAAAAsjuAMAAAAAYGEEdwAAAAAALIzgDgAAAACAhRHcAQAAAACwMII7AAAAAAAWRnAHAAAAAMDCCO4AAAAAAFgYwR0AAAAAAAsjuAMAAAAAYGEEdwAAAAAALIzgDgAAAACAhRHcAQAAAACwMII7AAAAAAAWRnAHAAAAAMDCCO4AAAAAAFgYwR0AAAAAAAsjuAMAAAAAYGEEdwAAAAAALIzgDgAAAACAhbm7uoCbUcPnp7m6BNxEEv77uKtLAAAAAOBCnHEHAAAAAMDCCO4AAAAAAFgYwR0AAAAAAAsjuAMAAAAAYGEEdwAAAAAALIzgDgAAAACAhbk0uH/77bdq27atgoODZbPZNH/+fKd+m82W4/Tf//7XMSY8PDxb/6OPPnqDtwQAAAAAgILh0uB++vRp1a9fX+PGjcuxPykpyWmaPHmybDabHnroIadxvXv3dhr3ySef3IjyAQAAAAAocO6ufPGoqChFRUVdtT8wMNBp/quvvlJERISqVavm1F6iRIlsYwEAAAAAuBkUmnvcjx49qkWLFumJJ57I1jdz5kz5+/urTp06Gjx4sE6dOnXNdaWnpys1NdVpAgAAAADAilx6xj0vpk6dKm9vb3Xs2NGpvVu3bqpataoCAwO1Y8cODRkyRFu3blV8fPxV1zVy5EgNHz68oEsGAAAAAOAfKzTBffLkyerWrZuKFy/u1N67d2/Hv8PCwhQaGqpGjRpp8+bNatCgQY7rGjJkiGJiYhzzqampCgkJKZjCAQAAAAD4BwpFcF+7dq327t2r2bNn5zq2QYMG8vDwUGJi4lWDu91ul91uz+8yAQAAAADId4XiHvfY2Fg1bNhQ9evXz3Xszp07lZGRoaCgoBtQGQAAAAAABculZ9zT0tK0b98+x/z+/fu1ZcsW+fn5qVKlSpIuXsb+xRdfaPTo0dmW/+WXXzRz5kzdd9998vf3165duzRo0CDdfvvtatq06Q3bDgAAAAAACopLg/umTZsUERHhmL9033n37t01ZcoUSdKsWbNkjFGXLl2yLe/p6amVK1fqww8/VFpamkJCQnT//ffr9ddfl5ub2w3ZBgAAAAAACpJLg3t4eLiMMdcc89RTT+mpp57KsS8kJERr1qwpiNIAAAAAALCEQnGPOwAAAAAARRXBHQAAAAAACyO4AwAAAABgYQR3AAAAAAAszKUPpwNQeDV8fpqrS8BNJOG/j7u6BAAAAMvijDsAAAAAABZGcAcAAAAAwMII7gAAAAAAWBjBHQAAAAAACyO4AwAAAABgYQR3AAAAAAAsjOAOAAAAAICFEdwBAAAAALAwgjsAAAAAABZGcAcAAAAAwMII7gAAAAAAWBjBHQAAAAAACyO4AwAAAABgYQR3AAAAAAAsjOAOAAAAAICFEdwBAAAAALAwgjsAAAAAABZGcAcAAAAAwMII7gAAAAAAWBjBHQAAAAAACyO4AwAAAABgYe6uLgAAAAAAClLD56e5ugTcRBL++/gNf03OuAMAAAAAYGEEdwAAAAAALIzgDgAAAACAhRHcAQAAAACwMII7AAAAAAAWRnAHAAAAAMDCCO4AAAAAAFgYwR0AAAAAAAsjuAMAAAAAYGEEdwAAAAAALIzgDgAAAACAhRHcAQAAAACwMII7AAAAAAAWRnAHAAAAAMDCCO4AAAAAAFgYwR0AAAAAAAsjuAMAAAAAYGEuDe7ffvut2rZtq+DgYNlsNs2fP9+pv0ePHrLZbE7TXXfd5TQmPT1d0dHR8vf3V8mSJdWuXTsdPnz4Bm4FAAAAAAAFx6XB/fTp06pfv77GjRt31TH33nuvkpKSHNPixYud+gcOHKh58+Zp1qxZ+u6775SWlqYHHnhAmZmZBV0+AAAAAAAFzt2VLx4VFaWoqKhrjrHb7QoMDMyx7+TJk4qNjdX06dPVqlUrSdKMGTMUEhKiFStWKDIyMt9rBgAAAADgRrL8Pe6rV69WQECAatSood69e+vYsWOOvoSEBGVkZKhNmzaOtuDgYIWFhWndunVXXWd6erpSU1OdJgAAAAAArMilZ9xzExUVpUceeUSVK1fW/v379eqrr6pFixZKSEiQ3W5XcnKyPD09VaZMGaflypcvr+Tk5Kuud+TIkRo+fHhBlw8AKOQaPj/N1SXgJpLw38ddXQIAoJCydHDv3Lmz499hYWFq1KiRKleurEWLFqljx45XXc4YI5vNdtX+IUOGKCYmxjGfmpqqkJCQ/CkaAAAAAIB8ZPlL5S8XFBSkypUrKzExUZIUGBio8+fP68SJE07jjh07pvLly191PXa7XT4+Pk4TAAAAAABWVKiC+/Hjx3Xo0CEFBQVJkho2bCgPDw/Fx8c7xiQlJWnHjh1q0qSJq8oEAAAAACDfuPRS+bS0NO3bt88xv3//fm3ZskV+fn7y8/PTsGHD9NBDDykoKEgHDhzQyy+/LH9/fz344IOSJF9fXz3xxBMaNGiQypYtKz8/Pw0ePFh169Z1PGUeAAAAAIDCzKXBfdOmTYqIiHDMX7rvvHv37powYYK2b9+uadOmKSUlRUFBQYqIiNDs2bPl7e3tWOb999+Xu7u7OnXqpLNnz6ply5aaMmWK3Nzcbvj2AAAAAACQ31wa3MPDw2WMuWr/smXLcl1H8eLFNXbsWI0dOzY/SwMAAAAAwBIK1T3uAAAAAAAUNQR3AAAAAAAsjOAOAAAAAICFEdwBAAAAALAwgjsAAAAAABZGcAcAAAAAwMII7gAAAAAAWBjBHQAAAAAACyO4AwAAAABgYQR3AAAAAAAsjOAOAAAAAICFEdwBAAAAALAwgjsAAAAAABZGcAcAAAAAwMII7gAAAAAAWBjBHQAAAAAACyO4AwAAAABgYQR3AAAAAAAsjOAOAAAAAICFEdwBAAAAALAwgjsAAAAAABZGcAcAAAAAwMII7gAAAAAAWBjBHQAAAAAACyO4AwAAAABgYQR3AAAAAAAsjOAOAAAAAICFEdwBAAAAALAwgjsAAAAAABZGcAcAAAAAwMII7gAAAAAAWBjBHQAAAAAACyO4AwAAAABgYQR3AAAAAAAsjOAOAAAAAICFEdwBAAAAALAwgjsAAAAAABZGcAcAAAAAwMII7gAAAAAAWBjBHQAAAAAACyO4AwAAAABgYQR3AAAAAAAsjOAOAAAAAICFEdwBAAAAALAwlwb3b7/9Vm3btlVwcLBsNpvmz5/v6MvIyNCLL76ounXrqmTJkgoODtbjjz+uI0eOOK0jPDxcNpvNaXr00Udv8JYAAAAAAFAwXBrcT58+rfr162vcuHHZ+s6cOaPNmzfr1Vdf1ebNmzV37lz9/PPPateuXbaxvXv3VlJSkmP65JNPbkT5AAAAAAAUOHdXvnhUVJSioqJy7PP19VV8fLxT29ixY3XHHXfo4MGDqlSpkqO9RIkSCgwMLNBaAQAAAABwhUJ1j/vJkydls9lUunRpp/aZM2fK399fderU0eDBg3Xq1Klrric9PV2pqalOEwAAAAAAVuTSM+55ce7cOb300kvq2rWrfHx8HO3dunVT1apVFRgYqB07dmjIkCHaunVrtrP1lxs5cqSGDx9+I8oGAAAAAOAfKRTBPSMjQ48++qiysrL00UcfOfX17t3b8e+wsDCFhoaqUaNG2rx5sxo0aJDj+oYMGaKYmBjHfGpqqkJCQgqmeAAAAAAA/gHLB/eMjAx16tRJ+/fv1zfffON0tj0nDRo0kIeHhxITE68a3O12u+x2e0GUCwAAAABAvrJ0cL8U2hMTE7Vq1SqVLVs212V27typjIwMBQUF3YAKAQAAAAAoWC4N7mlpadq3b59jfv/+/dqyZYv8/PwUHByshx9+WJs3b9bChQuVmZmp5ORkSZKfn588PT31yy+/aObMmbrvvvvk7++vXbt2adCgQbr99tvVtGlTV20WAAAAAAD5xqXBfdOmTYqIiHDMX7rvvHv37ho2bJgWLFggSbrtttucllu1apXCw8Pl6emplStX6sMPP1RaWppCQkJ0//336/XXX5ebm9sN2w4AAAAAAAqKS4N7eHi4jDFX7b9WnySFhIRozZo1+V0WAAAAAACWUai+xx0AAAAAgKKG4A4AAAAAgIUR3AEAAAAAsDCCOwAAAAAAFkZwBwAAAADAwgjuAAAAAABY2D8K7ufOncuvOgAAAAAAQA7yHNyzsrL05ptvqkKFCipVqpR+/fVXSdKrr76q2NjYfC8QAAAAAICiLM/B/a233tKUKVM0atQoeXp6Otrr1q2rTz/9NF+LAwAAAACgqMtzcJ82bZomTpyobt26yc3NzdFer1497dmzJ1+LAwAAAACgqMtzcP/99991yy23ZGvPyspSRkZGvhQFAAAAAAAuynNwr1OnjtauXZut/YsvvtDtt9+eL0UBAAAAAICL3PO6wOuvv67HHntMv//+u7KysjR37lzt3btX06ZN08KFCwuiRgAAAAAAiqw8n3Fv27atZs+ercWLF8tms+m1117T7t279fXXX6t169YFUSMAAAAAAEVWns+4S1JkZKQiIyPzuxYAAAAAAHCFPJ9x37hxozZs2JCtfcOGDdq0aVO+FAUAAAAAAC7Kc3Dv16+fDh06lK39999/V79+/fKlKAAAAAAAcFGeg/uuXbvUoEGDbO233367du3alS9FAQAAAACAi/Ic3O12u44ePZqtPSkpSe7uf+uWeQAAAAAAcBV5Du6tW7fWkCFDdPLkSUdbSkqKXn75ZZ4qDwAAAABAPsvzKfLRo0erWbNmqly5sm6//XZJ0pYtW1S+fHlNnz493wsEAAAAAKAoy3Nwr1ChgrZt26aZM2dq69at8vLyUs+ePdWlSxd5eHgURI0AAAAAABRZf+um9JIlS+qpp57K71oAAAAAAMAVriu4L1iwQFFRUfLw8NCCBQuuObZdu3b5UhgAAAAAALjO4N6hQwclJycrICBAHTp0uOo4m82mzMzM/KoNAAAAAIAi77qCe1ZWVo7/BgAAAAAABStPXweXkZGhiIgI/fzzzwVVDwAAAAAAuEyegruHh4d27Nghm81WUPUAAAAAAIDL5Cm4S9Ljjz+u2NjYgqgFAAAAAABcIc9fB3f+/Hl9+umnio+PV6NGjVSyZEmn/vfeey/figMAAAAAoKjLc3DfsWOHGjRoIEnZ7nXnEnoAAAAAAPJXnoP7qlWrCqIOAAAAAACQgzwF9y+++ELz589XRkaGWrVqpaeeeqqg6gIAAAAAAMpDcJ84caKefvpphYaGqnjx4vryyy+1f/9+jRw5siDrAwAAAACgSLvup8qPHTtWQ4cO1d69e7V161bFxsZq3LhxBVkbAAAAAABF3nUH919//VU9e/Z0zD/22GNKT09XcnJygRQGAAAAAADyENzPnj2rUqVKOebd3Nxkt9t15syZAikMAAAAAADk8eF0n376qVN4v3DhgqZMmSJ/f39H24ABA/KvOgAAAAAAirjrDu6VKlXSpEmTnNoCAwM1ffp0x7zNZiO4AwAAAACQj647uB84cKAAywAAAAAAADm57nvc86pu3bo6dOhQQa0eAAAAAIAiocCC+4EDB5SRkVFQqwcAAAAAoEgosOAOAAAAAAD+OYI7AAAAAAAW5tLg/u2336pt27YKDg6WzWbT/PnznfqNMRo2bJiCg4Pl5eWl8PBw7dy502lMenq6oqOj5e/vr5IlS6pdu3Y6fPjwDdwKAAAAAAAKjkuD++nTp1W/fn2NGzcux/5Ro0bpvffe07hx47Rx40YFBgaqdevWOnXqlGPMwIEDNW/ePM2aNUvfffed0tLS9MADDygzM/NGbQYAAAAAAAXmur8OriBERUUpKioqxz5jjD744AMNHTpUHTt2lCRNnTpV5cuX12effaY+ffro5MmTio2N1fTp09WqVStJ0owZMxQSEqIVK1YoMjLyhm0LAAAAAAAFocDOuH/yyScqX778315+//79Sk5OVps2bRxtdrtdzZs317p16yRJCQkJysjIcBoTHByssLAwx5icpKenKzU11WkCAAAAAMCK8nzGfcyYMTm222w2FS9eXLfccouaNWumrl27/qPCkpOTJSlb+C9fvrx+++03xxhPT0+VKVMm25hLy+dk5MiRGj58+D+qDwAAAACAGyHPwf3999/XH3/8oTNnzqhMmTIyxiglJUUlSpRQqVKldOzYMVWrVk2rVq1SSEjIPy7QZrM5zRtjsrVdKbcxQ4YMUUxMjGM+NTU1X2oFAAAAACC/5flS+REjRqhx48ZKTEzU8ePH9ddff+nnn3/WnXfeqQ8//FAHDx5UYGCgnnvuuX9UWGBgoCRlO3N+7Ngxx1n4wMBAnT9/XidOnLjqmJzY7Xb5+Pg4TQAAAAAAWFGeg/srr7yi999/X9WrV3e03XLLLXr33Xc1ZMgQVaxYUaNGjdL333//jwqrWrWqAgMDFR8f72g7f/681qxZoyZNmkiSGjZsKA8PD6cxSUlJ2rFjh2MMAAAAAACFWZ4vlU9KStKFCxeytV+4cMFxdjw4ONjpK9uuJi0tTfv27XPM79+/X1u2bJGfn58qVaqkgQMHasSIEQoNDVVoaKhGjBihEiVKOO6f9/X11RNPPKFBgwapbNmy8vPz0+DBg1W3bl3HU+YBAAAAACjM8hzcIyIi1KdPH3366ae6/fbbJUk//fSTnnnmGbVo0UKStH37dlWtWjXXdW3atEkRERGO+Uv3nXfv3l1TpkzRCy+8oLNnz6pv3746ceKE7rzzTi1fvlze3t6OZd5//325u7urU6dOOnv2rFq2bKkpU6bIzc0tr5sGAAAAAIDl5Dm4x8bG6rHHHnNcpi5dPNvesmVLxcbGSpJKlSql0aNH57qu8PBwGWOu2m+z2TRs2DANGzbsqmOKFy+usWPHauzYsXnbEAAAAAAACoE8B/dL953v2bNHP//8s4wxqlWrlmrWrOkYc/lZdAAAAAAA8PflObivWbNGzZs3V61atVSrVq2CqAkAAAAAAPyfPD9VvnXr1qpUqZJeeukl7dixoyBqAgAAAAAA/yfPwf3IkSN64YUXtHbtWtWrV0/16tXTqFGjdPjw4YKoDwAAAACAIi3Pwd3f31/9+/fX999/r19++UWdO3fWtGnTVKVKFcdT5QEAAAAAQP7Ic3C/XNWqVfXSSy/p7bffVt26dbVmzZr8qgsAAAAAAOgfBPfvv/9effv2VVBQkLp27ao6depo4cKF+VkbAAAAAABFXp6D+8svv6yqVasqIiJCv/32mz744AMlJydrxowZCgoKKogaAQAAAAAosvL8dXCrV6/W4MGD1blzZ/n7++vkyZOaMmWKYmNjtWXLFmVmZhZEnQAAAAAAFEl5Du7r1q2TJH3zzTeaPHmy5s6dq8qVK+uhhx7Sp59+mu8FAgAAAABQlOUpuB8+fFhTpkxRXFyc0tLS1KlTJ2VkZOjLL79U7dq1C6pGAAAAAACKrOu+x/2+++5T7dq1tXPnTo0ZM0ZHjhzR2LFjC7I2AAAAAACKvOs+4758+XINGDBAzzzzjEJDQwuyJgAAAAAA8H+u+4z72rVrderUKTVq1Eh33nmnxo0bpz/++KMgawMAAAAAoMi77uB+9913a9KkSUpKSlKfPn00a9YsVahQQVlZWYqPj9epU6cKsk4AAAAAAIqkPH+Pe4kSJdSrVy9999132r59uwYNGqS3335bAQEBateuXUHUCAAAAABAkZXn4H65mjVratSoUTp8+LA+//zz/KoJAAAAAAD8n38U3C9xc3NThw4dtGDBgvxYHQAAAAAA+D/5EtwBAAAAAEDBILgDAAAAAGBhBHcAAAAAACyM4A4AAAAAgIUR3AEAAAAAsDCCOwAAAAAAFkZwBwAAAADAwgjuAAAAAABYGMEdAAAAAAALI7gDAAAAAGBhBHcAAAAAACyM4A4AAAAAgIUR3AEAAAAAsDCCOwAAAAAAFkZwBwAAAADAwgjuAAAAAABYGMEdAAAAAAALI7gDAAAAAGBhBHcAAAAAACyM4A4AAAAAgIUR3AEAAAAAsDCCOwAAAAAAFkZwBwAAAADAwgjuAAAAAABYGMEdAAAAAAALI7gDAAAAAGBhlg/uVapUkc1myzb169dPktSjR49sfXfddZeLqwYAAAAAIH+4u7qA3GzcuFGZmZmO+R07dqh169Z65JFHHG333nuv4uLiHPOenp43tEYAAAAAAAqK5YN7uXLlnObffvttVa9eXc2bN3e02e12BQYG3ujSAAAAAAAocJa/VP5y58+f14wZM9SrVy/ZbDZH++rVqxUQEKAaNWqod+/eOnbs2DXXk56ertTUVKcJAAAAAAArKlTBff78+UpJSVGPHj0cbVFRUZo5c6a++eYbjR49Whs3blSLFi2Unp5+1fWMHDlSvr6+jikkJOQGVA8AAAAAQN5Z/lL5y8XGxioqKkrBwcGOts6dOzv+HRYWpkaNGqly5cpatGiROnbsmON6hgwZopiYGMd8amoq4R0AAAAAYEmFJrj/9ttvWrFihebOnXvNcUFBQapcubISExOvOsZut8tut+d3iQAAAAAA5LtCc6l8XFycAgICdP/9919z3PHjx3Xo0CEFBQXdoMoAAAAAACg4hSK4Z2VlKS4uTt27d5e7+/+/SCAtLU2DBw/W+vXrdeDAAa1evVpt27aVv7+/HnzwQRdWDAAAAABA/igUl8qvWLFCBw8eVK9evZza3dzctH37dk2bNk0pKSkKCgpSRESEZs+eLW9vbxdVCwAAAABA/ikUwb1NmzYyxmRr9/Ly0rJly1xQEQAAAAAAN0ahuFQeAAAAAICiiuAOAAAAAICFEdwBAAAAALAwgjsAAAAAABZGcAcAAAAAwMII7gAAAAAAWBjBHQAAAAAACyO4AwAAAABgYQR3AAAAAAAsjOAOAAAAAICFEdwBAAAAALAwgjsAAAAAABZGcAcAAAAAwMII7gAAAAAAWBjBHQAAAAAACyO4AwAAAABgYQR3AAAAAAAsjOAOAAAAAICFEdwBAAAAALAwgjsAAAAAABZGcAcAAAAAwMII7gAAAAAAWBjBHQAAAAAACyO4AwAAAABgYQR3AAAAAAAsjOAOAAAAAICFEdwBAAAAALAwgjsAAAAAABZGcAcAAAAAwMII7gAAAAAAWBjBHQAAAAAACyO4AwAAAABgYQR3AAAAAAAsjOAOAAAAAICFEdwBAAAAALAwgjsAAAAAABZGcAcAAAAAwMII7gAAAAAAWBjBHQAAAAAACyO4AwAAAABgYQR3AAAAAAAsjOAOAAAAAICFEdwBAAAAALAwgjsAAAAAABZm+eA+bNgw2Ww2pykwMNDRb4zRsGHDFBwcLC8vL4WHh2vnzp0urBgAAAAAgPxj+eAuSXXq1FFSUpJj2r59u6Nv1KhReu+99zRu3Dht3LhRgYGBat26tU6dOuXCigEAAAAAyB+FIri7u7srMDDQMZUrV07SxbPtH3zwgYYOHaqOHTsqLCxMU6dO1ZkzZ/TZZ5+5uGoAAAAAAP65QhHcExMTFRwcrKpVq+rRRx/Vr7/+Kknav3+/kpOT1aZNG8dYu92u5s2ba926dVddX3p6ulJTU50mAAAAAACsyPLB/c4779S0adO0bNkyTZo0ScnJyWrSpImOHz+u5ORkSVL58uWdlilfvryjLycjR46Ur6+vYwoJCSnQbQAAAAAA4O+yfHCPiorSQw89pLp166pVq1ZatGiRJGnq1KmOMTabzWkZY0y2tssNGTJEJ0+edEyHDh0qmOIBAAAAAPiHLB/cr1SyZEnVrVtXiYmJjqfLX3l2/dixY9nOwl/ObrfLx8fHaQIAAAAAwIoKXXBPT0/X7t27FRQUpKpVqyowMFDx8fGO/vPnz2vNmjVq0qSJC6sEAAAAACB/uLu6gNwMHjxYbdu2VaVKlXTs2DG99dZbSk1NVffu3WWz2TRw4ECNGDFCoaGhCg0N1YgRI1SiRAl17drV1aUDAAAAAPCPWT64Hz58WF26dNGff/6pcuXK6a677tIPP/ygypUrS5JeeOEFnT17Vn379tWJEyd05513avny5fL29nZx5QAAAAAA/HOWD+6zZs26Zr/NZtOwYcM0bNiwG1MQAAAAAAA3UKG7xx0AAAAAgKKE4A4AAAAAgIUR3AEAAAAAsDCCOwAAAAAAFkZwBwAAAADAwgjuAAAAAABYGMEdAAAAAAALI7gDAAAAAGBhBHcAAAAAACyM4A4AAAAAgIUR3AEAAAAAsDCCOwAAAAAAFkZwBwAAAADAwgjuAAAAAABYGMEdAAAAAAALI7gDAAAAAGBhBHcAAAAAACyM4A4AAAAAgIUR3AEAAAAAsDCCOwAAAAAAFkZwBwAAAADAwgjuAAAAAABYGMEdAAAAAAALI7gDAAAAAGBhBHcAAAAAACyM4A4AAAAAgIUR3AEAAAAAsDCCOwAAAAAAFkZwBwAAAADAwgjuAAAAAABYGMEdAAAAAAALI7gDAAAAAGBhBHcAAAAAACyM4A4AAAAAgIUR3AEAAAAAsDCCOwAAAAAAFkZwBwAAAADAwgjuAAAAAABYGMEdAAAAAAALI7gDAAAAAGBhBHcAAAAAACyM4A4AAAAAgIUR3AEAAAAAsDCCOwAAAAAAFmb54D5y5Eg1btxY3t7eCggIUIcOHbR3716nMT169JDNZnOa7rrrLhdVDAAAAABA/rF8cF+zZo369eunH374QfHx8bpw4YLatGmj06dPO4279957lZSU5JgWL17soooBAAAAAMg/7q4uIDdLly51mo+Li1NAQIASEhLUrFkzR7vdbldgYOCNLg8AAAAAgAJl+TPuVzp58qQkyc/Pz6l99erVCggIUI0aNdS7d28dO3bsqutIT09Xamqq0wQAAAAAgBUVquBujFFMTIzuuecehYWFOdqjoqI0c+ZMffPNNxo9erQ2btyoFi1aKD09Pcf1jBw5Ur6+vo4pJCTkRm0CAAAAAAB5YvlL5S/Xv39/bdu2Td99951Te+fOnR3/DgsLU6NGjVS5cmUtWrRIHTt2zLaeIUOGKCYmxjGfmppKeAcAAAAAWFKhCe7R0dFasGCBvv32W1WsWPGaY4OCglS5cmUlJibm2G+322W32wuiTAAAAAAA8pXlg7sxRtHR0Zo3b55Wr16tqlWr5rrM8ePHdejQIQUFBd2ACgEAAAAAKDiWv8e9X79+mjFjhj777DN5e3srOTlZycnJOnv2rCQpLS1NgwcP1vr163XgwAGtXr1abdu2lb+/vx588EEXVw8AAAAAwD9j+TPuEyZMkCSFh4c7tcfFxalHjx5yc3PT9u3bNW3aNKWkpCgoKEgRERGaPXu2vL29XVAxAAAAAAD5x/LB3RhzzX4vLy8tW7bsBlUDAAAAAMCNZflL5QEAAAAAKMoI7gAAAAAAWBjBHQAAAAAACyO4AwAAAABgYQR3AAAAAAAsjOAOAAAAAICFEdwBAAAAALAwgjsAAAAAABZGcAcAAAAAwMII7gAAAAAAWBjBHQAAAAAACyO4AwAAAABgYQR3AAAAAAAsjOAOAAAAAICFEdwBAAAAALAwgjsAAAAAABZGcAcAAAAAwMII7gAAAAAAWBjBHQAAAAAACyO4AwAAAABgYQR3AAAAAAAsjOAOAAAAAICFEdwBAAAAALAwgjsAAAAAABZGcAcAAAAAwMII7gAAAAAAWBjBHQAAAAAACyO4AwAAAABgYQR3AAAAAAAsjOAOAAAAAICFEdwBAAAAALAwgjsAAAAAABZGcAcAAAAAwMII7gAAAAAAWBjBHQAAAAAACyO4AwAAAABgYQR3AAAAAAAsjOAOAAAAAICFEdwBAAAAALAwgjsAAAAAABZGcAcAAAAAwMII7gAAAAAAWBjBHQAAAAAACyO4AwAAAABgYTdNcP/oo49UtWpVFS9eXA0bNtTatWtdXRIAAAAAAP/YTRHcZ8+erYEDB2ro0KH66aef9K9//UtRUVE6ePCgq0sDAAAAAOAfuSmC+3vvvacnnnhCTz75pG699VZ98MEHCgkJ0YQJE1xdGgAAAAAA/4i7qwv4p86fP6+EhAS99NJLTu1t2rTRunXrclwmPT1d6enpjvmTJ09KklJTU/Olpsz0s/myHkDKv+Myv3GcIz9xnKMo4DhHUcBxjqIgv47zS+sxxuQ61mauZ5SFHTlyRBUqVND333+vJk2aONpHjBihqVOnau/evdmWGTZsmIYPH34jywQAAAAAIJtDhw6pYsWK1xxT6M+4X2Kz2ZzmjTHZ2i4ZMmSIYmJiHPNZWVn666+/VLZs2asug/yVmpqqkJAQHTp0SD4+Pq4uBygQHOcoCjjOURRwnKMo4Di/8YwxOnXqlIKDg3MdW+iDu7+/v9zc3JScnOzUfuzYMZUvXz7HZex2u+x2u1Nb6dKlC6pEXIOPjw9vDLjpcZyjKOA4R1HAcY6igOP8xvL19b2ucYX+4XSenp5q2LCh4uPjndrj4+OdLp0HAAAAAKAwKvRn3CUpJiZGjz32mBo1aqS7775bEydO1MGDB/X000+7ujQAAAAAAP6RmyK4d+7cWcePH9cbb7yhpKQkhYWFafHixapcubKrS8NV2O12vf7669luWQBuJhznKAo4zlEUcJyjKOA4t7ZC/1R5AAAAAABuZoX+HncAAAAAAG5mBHcAAAAAACyM4A4AAAAAgIUR3PG32Gw2zZ8//6r9q1evls1mU0pKyg2rCQBw8+nRo4c6dOjg6jKAAjdlyhSVLl3a1WWgELLS5+7w8HANHDjQ1WXclAjuyFFycrKio6NVrVo12e12hYSEqG3btlq5cuV1Ld+kSRMlJSXJ19e3gCsF8u5qQeBG/+LL7Q9gwCWuCq9t2rSRm5ubfvjhhxv+2kBOevToIZvNprffftupff78+bLZbDekhp9//lklSpTQZ5995tSelZWlJk2a6MEHH7whdaBouXTs22w2eXh4qFq1aho8eLBOnz7t6tKczJ07V2+++aary7gpEdyRzYEDB9SwYUN98803GjVqlLZv366lS5cqIiJC/fr1u651eHp6KjAw8Ib9EgUA5K+DBw9q/fr16t+/v2JjY11dDuBQvHhxvfPOOzpx4oRLXr9GjRp6++23FR0draSkJEf76NGjtW/fPn3yySd5XmdGRkZ+loib1L333qukpCT9+uuveuutt/TRRx9p8ODBri7LiZ+fn7y9vV1dxk2J4I5s+vbtK5vNph9//FEPP/ywatSooTp16igmJsbprMuff/6pBx98UCVKlFBoaKgWLFjg6MvpzOX333+v5s2bq0SJEipTpowiIyMdv3SXLl2qe+65R6VLl1bZsmX1wAMP6JdffnGqa926dbrttttUvHhxNWrUyPHX9S1btjjGrFmzRnfccYfsdruCgoL00ksv6cKFCwWzo3DT+/LLL1WnTh3Z7XZVqVJFo0ePdurP6Yx56dKlNWXKFEnS+fPn1b9/fwUFBal48eKqUqWKRo4cKUmqUqWKJOnBBx+UzWZzzEvShAkTVL16dXl6eqpmzZqaPn16ttf99NNPr/rzh6Int/e+OXPmqG7duvLy8lLZsmXVqlWrXM/SxMXF6YEHHtAzzzyj2bNnZxsfHh6uAQMG6IUXXpCfn58CAwM1bNgwpzF79uzRPffco+LFi6t27dpasWJFtp+b33//XZ07d1aZMmVUtmxZtW/fXgcOHLhqXcYYjRo1StWqVZOXl5fq16+vOXPmOPpPnDihbt26qVy5cvLy8lJoaKji4uJy34koNFq1aqXAwEDH++nVrFu3Ts2aNZOXl5dCQkI0YMAAx3E8duxY1a1b1zH20meK8ePHO9oiIyM1ZMiQHNcdHR2t2267Tb1795Z08Vh/7bXXNHHiRPn7++uNN95QxYoVZbfbddttt2np0qWOZQ8cOCCbzab//e9/Cg8PV/HixTVjxoxsr3H8+HHdcccdateunc6dO3f9Owg3LbvdrsDAQIWEhKhr167q1q2b0/tpQkKCGjVqpBIlSqhJkybau3ev0/K5fb44efKknnrqKQUEBMjHx0ctWrTQ1q1bHf3Dhg3TbbfdpunTp6tKlSry9fXVo48+qlOnTjnGXH6p/J49e7JdnTJ37lwVL15c27dvz8c9UzQQ3OHkr7/+0tKlS9WvXz+VLFkyW//l914NHz5cnTp10rZt23TfffepW7du+uuvv3Jc75YtW9SyZUvVqVNH69ev13fffae2bdsqMzNTknT69GnFxMRo48aNWrlypYoVK6YHH3xQWVlZkqRTp06pbdu2qlu3rjZv3qw333xTL774otNr/P7777rvvvvUuHFjbd26VRMmTFBsbKzeeuutfNo7KEoSEhLUqVMnPfroo9q+fbuGDRumV1991RHKr8eYMWO0YMEC/e9//9PevXs1Y8YMR0DfuHGjpIvhKCkpyTE/b948Pfvssxo0aJB27NihPn36qGfPnlq1apXTuvPy84ebW27vfUlJSerSpYt69eql3bt3a/Xq1erYsaOMMVddpzFGcXFx+ve//61atWqpRo0a+t///pdt3NSpU1WyZElt2LBBo0aN0htvvKH4+HhJFy8b7tChg0qUKKENGzZo4sSJGjp0qNPyZ86cUUREhEqVKqVvv/1W3333nUqVKqV7771X58+fz7G2V155RXFxcZowYYJ27typ5557Tv/+97+1Zs0aSdKrr76qXbt2acmSJdq9e7cmTJggf3//v7VvYU1ubm4aMWKExo4dq8OHD+c4Zvv27YqMjFTHjh21bds2zZ49W99995369+8v6WK42Llzp/78809JF//45e/v7ziOLly4oHXr1ql58+Y5rt9msykuLk5r167VpEmT1KNHD3Xu3FkdOnTQhx9+qNGjR+vdd9/Vtm3bFBkZqXbt2ikxMdFpHS+++KIGDBig3bt3KzIy0qnv8OHD+te//qVatWo5gg5wJS8vL6erNYYOHarRo0dr06ZNcnd3V69evRx9uX2+MMbo/vvvV3JyshYvXqyEhAQ1aNBALVu2dPp88csvv2j+/PlauHChFi5cqDVr1mS7deWSWrVq6d1331Xfvn3122+/6ciRI+rdu7fefvttpz+c4ToZ4DIbNmwwkszcuXOvOU6SeeWVVxzzaWlpxmazmSVLlhhjjFm1apWRZE6cOGGMMaZLly6madOm113HsWPHjCSzfft2Y4wxEyZMMGXLljVnz551jJk0aZKRZH766SdjjDEvv/yyqVmzpsnKynKMGT9+vClVqpTJzMy87tfGza979+7Gzc3NlCxZ0mkqXry447jt2rWrad26tdNyzz//vKldu7ZjXpKZN2+e0xhfX18TFxdnjDEmOjratGjRwumYvFxOyzdp0sT07t3bqe2RRx4x9913n9Ny1/r5w82ne/fupn379jn25fbel5CQYCSZAwcOXPfrLV++3JQrV85kZGQYY4x5//33s72HN2/e3Nxzzz1ObY0bNzYvvviiMcaYJUuWGHd3d5OUlOToj4+PdzruY2Njs9Wenp5uvLy8zLJly7Jte1pamilevLhZt26d0+s+8cQTpkuXLsYYY9q2bWt69ux53duKwuXy4+Guu+4yvXr1MsYYM2/ePHP5x9rHHnvMPPXUU07Lrl271hQrVsycPXvWZGVlGX9/fzNnzhxjjDG33XabGTlypAkICDDGGLNu3Trj7u5uTp06dc16Jk+ebIoVK2ZCQkJMSkqKMcaY4OBg85///MdpXOPGjU3fvn2NMcbs37/fSDIffPCB05i4uDjj6+tr9u7daypVqmSio6Ov+vsDRc+Vvwc2bNhgypYtazp16uT43L1ixQpH/6JFi4wkx2fn3D5frFy50vj4+Jhz5845jalevbr55JNPjDHGvP7666ZEiRImNTXV0f/888+bO++80zHfvHlz8+yzzzqt4/777zf/+te/TMuWLU3r1q05rv8mzrjDifm/MzDXc296vXr1HP8uWbKkvL29dezYsRzHXjrjfjW//PKLunbtqmrVqsnHx0dVq1aVdPEeS0nau3ev6tWr5/QX5zvuuMNpHbt379bdd9/tVHvTpk2VlpZ21b/Io+iKiIjQli1bnKZPP/3U0b979241bdrUaZmmTZsqMTHRcaVIbnr06KEtW7aoZs2aGjBggJYvX57rMld73d27dzu15eXnDze33N776tevr5YtW6pu3bp65JFHNGnSpFzvDY6NjVXnzp3l7u4uSerSpYs2bNiQ7bLLy49DSQoKCnIch3v37lVISIgCAwMd/Ve+byckJGjfvn3y9vZWqVKlVKpUKfn5+encuXPZbpeSpF27duncuXNq3bq1Y3ypUqU0bdo0x/hnnnlGs2bN0m233aYXXnhB69aty20XopB65513NHXqVO3atStbX0JCgqZMmeJ0nERGRiorK0v79++XzWZTs2bNtHr1aqWkpGjnzp16+umnlZmZ6bgypUGDBipVqtQ1a+jZs6eCgoI0YMAA+fr6KjU1VUeOHLmu9/FGjRplW9/Zs2d1zz33qEOHDhozZgzPCoKThQsXqlSpUipevLjuvvtuNWvWTGPHjnX0X/6eHBQUJEmO9+TcPl8kJCQoLS1NZcuWdfq52b9/v9P7cZUqVZzuYb/8ff9qJk+erG3btmnz5s2aMmUKx/Xf5O7qAmAtoaGhstls2r17d65PMPbw8HCat9lsjkvbr+Tl5XXNdbVt21YhISGaNGmSgoODlZWVpbCwMMelksaYbD/k5orLPK81hjcIXKlkyZK65ZZbnNou/wPP9RxzNpstW9vll6w1aNBA+/fv15IlS7RixQp16tRJrVq1crofNyc5ve6VbXn5+cPNLbf3Pjc3N8XHx2vdunVavny5xo4dq6FDh2rDhg2OP5Je7q+//tL8+fOVkZGhCRMmONozMzM1efJkvfPOO462ax2HOdV1paysLDVs2FAzZ87M1leuXLkcx0vSokWLVKFCBac+u90uSYqKitJvv/2mRYsWacWKFWrZsqX69eund99995q1oPBp1qyZIiMj9fLLL6tHjx5OfVlZWerTp48GDBiQbblKlSpJuni5/MSJE7V27VrVr19fpUuXVrNmzbRmzRqtXr1a4eHh11WHu7u7449cl1zP+3hOtyTa7Xa1atVKixYt0vPPP6+KFSteVw0oGiIiIjRhwgR5eHgoODjY8R586Y9Xl78nXzreLv9scK3jMisrS0FBQVq9enW21738Vtm/8/lj69atOn36tIoVK6bk5GQFBwfnsqXICWfc4cTPz0+RkZEaP358jg8u+rtfk1WvXr2rfpXc8ePHtXv3br3yyitq2bKlbr311mxng2rVqqVt27YpPT3d0bZp0yanMbVr19a6deucgtS6devk7e2d7QMekJvatWvru+++c2pbt26datSoITc3N0kXg8XlTxROTEzUmTNnnJbx8fFR586dNWnSJM2ePVtffvml414xDw+PbGfvb7311hxf99Zbb823bcPN5Xre+2w2m5o2barhw4frp59+kqenp+bNm5fj+mbOnKmKFStq69atTlekfPDBB5o6dep1P/CzVq1aOnjwoI4ePepou/Qsh0saNGigxMREBQQE6JZbbnGacvo60dq1a8tut+vgwYPZxoeEhDjGlStXTj169NCMGTP0wQcfaOLEiddVMwqft99+W19//XW2KysaNGignTt3ZjtObrnlFnl6ekr6//e5z5kzxxHSmzdvrhUrVlzz/vZr8fHxUXBw8N9+Hy9WrJimT5+uhg0bqkWLFjpy5Eiea8DN69JJh8qVK2cL0LnJ7fNFgwYNlJycLHd392w/M//kOSF//fWXevTooaFDh6pnz57q1q2bzp49+7fXV5QR3JHNRx99pMzMTN1xxx368ssvlZiYqN27d2vMmDG6++67/9Y6hwwZoo0bN6pv377atm2b9uzZowkTJujPP/90PEl44sSJ2rdvn7755hvFxMQ4Ld+1a1dlZWXpqaee0u7du7Vs2TLH2ZNLfyns27evDh06pOjoaO3Zs0dfffWVXn/9dcXExKhYMQ515M2gQYO0cuVKvfnmm/r55581depUjRs3zulrV1q0aKFx48Zp8+bN2rRpk55++mmnX6Tvv/++Zs2apT179ujnn3/WF198ocDAQMdfrqtUqaKVK1cqOTnZ8ceq559/XlOmTNHHH3+sxMREvffee5o7d67lvu4FN97Jkyez3d5x8ODBXN/7NmzYoBEjRmjTpk06ePCg5s6dqz/++OOqISI2NlYPP/ywwsLCnKZevXopJSVFixYtuq56W7durerVq6t79+7atm2bvv/+e8fD6S69b3fr1k3+/v5q37691q5dq/3792vNmjV69tlnc7zFydvbW4MHD9Zzzz2nqVOn6pdfftFPP/2k8ePHa+rUqZKk1157TV999ZX27dunnTt3auHChfzh6yZWt25ddevWzelyYenig9/Wr1+vfv36acuWLUpMTNSCBQsUHR3tGBMWFqayZctq5syZjuAeHh6u+fPnOy5Z/zuef/55vfPOO5o9e7b27t2rl156SVu2bNGzzz57Xcu7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",
      "text/plain": [
       "<Figure size 1200x600 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "\n",
    "# Set up the figure size for the plot\n",
    "plt.figure(figsize=(12, 6))\n",
    "\n",
    "# Create a bar plot for average price by city\n",
    "sns.barplot(x='City', y='Avg_Price', data=city_group)\n",
    "\n",
    "# Set the title of the plot\n",
    "plt.title('Average Price by City')\n",
    "\n",
    "# Display the plot\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "id": "9535bced-b9e8-46fb-9cc2-2cf415ae95b0",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['City', 'Avg_Price', 'Median_Price', 'Price_STD', 'Total_Reviews',\n",
      "       'Most_Common_Room_Type'],\n",
      "      dtype='object')\n",
      "          City  Avg_Price  Median_Price  Price_STD  Total_Reviews  \\\n",
      "0      Chicago      180.0         180.0        NaN            120   \n",
      "1      Houston      170.0         170.0        NaN             90   \n",
      "2  Los Angeles      150.0         150.0        NaN             80   \n",
      "3     New York      200.0         200.0        NaN            100   \n",
      "4      Phoenix      160.0         160.0        NaN            110   \n",
      "\n",
      "  Most_Common_Room_Type  \n",
      "0           Entire home  \n",
      "1           Entire home  \n",
      "2          Private room  \n",
      "3           Entire home  \n",
      "4          Private room  \n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA+4AAAIhCAYAAADQLeBrAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjguNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8fJSN1AAAACXBIWXMAAA9hAAAPYQGoP6dpAABQT0lEQVR4nO3de3zP9f//8fvbDm/DNmZmG3NsiKEcOtCHzWmtckhF+JRDSWHS6CAdqD6UTzo4pGjmWHwSkvMIKRKT86EpQjZKZuYwsz1/f/h6/7xtzGrzfs1u18vldbl4PZ/P1+v9eL289t77vtfhbTPGGAEAAAAAAEsq5uoCAAAAAADA1RHcAQAAAACwMII7AAAAAAAWRnAHAAAAAMDCCO4AAAAAAFgYwR0AAAAAAAsjuAMAAAAAYGEEdwAAAAAALIzgDgAAAACAhRHcAQBFypgxY2Sz2RQWFubqUiwnPDxcNpvNMXl5eal+/fr64IMPlJWVdV3rsNlsGjZsWMEWeoXw8PAb9v+Znp6ucePG6Z577lGZMmXk6empChUqqFOnTlqzZo1j3OrVq2Wz2bR69WpH2+LFi2/4vgEA3BwI7gCAImXy5MmSpJ07d2rDhg0ursZ6qlWrpvXr12v9+vWaPXu2KlSooOeee05Dhgy5ruXXr1+vJ598soCrdI0///xTTZs2VUxMjMLCwjRlyhStXLlSo0ePlpubm1q2bKmtW7dKkho0aKD169erQYMGjuUXL16s4cOHu6p8AEAhZjPGGFcXAQDAjbBp0yY1btxY999/vxYtWqTevXtr4sSJN7QGY4zOnTsnLy+vG/q61yM8PFx//vmnduzY4WjLyMhQrVq1lJycrJSUFHl4eGRbztXblFPdBeG+++5TfHy8li1bphYtWmTr37hxo8qXL69KlSrluHz//v01fvx48dELAJBXnHEHABQZsbGxkqS3335bTZo00axZs3TmzBlJFwNqQECAHnvssWzLpaSkyMvLSzExMY621NRUDR48WFWrVnVcLj1w4ECdPn3aaVmbzab+/fvr448/1q233iq73a6pU6dKkoYPH64777xTfn5+8vHxUYMGDRQbG5st2KWnp2vQoEEKDAxUiRIl1KxZMyUkJKhKlSrq0aOH09jk5GT16dNHFStWlKenp6pWrarhw4frwoULf2ufeXh4qGHDhjpz5oz++OOPXLcpp0vlf//9dz311FMKCQmRp6engoOD9fDDD+vo0aN53p/XsnbtWt11113y8vJShQoV9OqrryozM1PSxT8uhIaGKjIyMttyaWlp8vX1Vb9+/a667oSEBC1ZskRPPPFEjqFdkho3buwI7VdeKt+jRw+NHz/esY8uTQcOHFDLli1Vq1atbP/vxhjdcsstuv/++697HwAAbk7uri4AAIAb4ezZs/r888/VuHFjhYWFqVevXnryySf1xRdfqHv37vLw8NC///1vffzxxxo/frx8fHwcy37++ec6d+6cevbsKUk6c+aMmjdvrsOHD+vll19WvXr1tHPnTr322mvavn27VqxYIZvN5lh+/vz5Wrt2rV577TUFBgYqICBAknTgwAH16dPHEfZ++OEHRUdH6/fff9drr73mWL5nz56aPXu2XnjhBbVo0UK7du3Sgw8+qNTUVKdtTE5O1h133KFixYrptddeU/Xq1bV+/Xq99dZbOnDggOLi4v7Wvvvll1/k7u6uMmXK5LpNV/r999/VuHFjZWRkOPbV8ePHtWzZMp04cULly5fP8/7MSXJysh599FG99NJLeuONN7Ro0SK99dZbOnHihMaNGyebzabo6GgNHDhQiYmJCg0NdSw7bdo0paamXjO4L1++XJLUoUOHPOy5/+/VV1/V6dOnNWfOHK1fv97RHhQUpGeffVbt27fXypUr1apVK0ffkiVL9Msvv2jMmDF/6zUBADcRAwBAETBt2jQjyXz88cfGGGNOnTplSpUqZf71r385xmzbts1IMhMnTnRa9o477jANGzZ0zI8cOdIUK1bMbNy40WncnDlzjCSzePFiR5sk4+vra/76669r1peZmWkyMjLMG2+8YcqWLWuysrKMMcbs3LnTSDIvvvii0/jPP//cSDLdu3d3tPXp08eUKlXK/Pbbb05j3333XSPJ7Ny585o1NG/e3NSpU8dkZGSYjIwMc+TIEfPSSy8ZSeaRRx65rm2SZF5//XXHfK9evYyHh4fZtWvXVV83L/vzanVLMl999ZVTe+/evU2xYsUc+yM1NdV4e3ubZ5991mlc7dq1TURExDVf4+mnnzaSzJ49e6457pJVq1YZSWbVqlWOtn79+pmcPnplZmaaatWqmfbt2zu1R0VFmerVqzuOBQBA0cWl8gCAIiE2NlZeXl569NFHJUmlSpXSI488orVr1yoxMVGSVLduXTVs2NDpzPTu3bv1448/qlevXo62hQsXKiwsTLfddpsuXLjgmCIjI7M9SVySWrRo4XS2+pJvvvlGrVq1kq+vr9zc3OTh4aHXXntNx48f17FjxyTJ8aTyTp06OS378MMPy93d+cK5hQsXKiIiQsHBwU51RUVFOa3rWnbu3CkPDw95eHgoODhYo0ePVrdu3TRp0qTr2qYrLVmyRBEREbr11luvOiav+zMn3t7eateunVNb165dlZWVpW+//dYxpmfPnpoyZYrjEvxvvvlGu3btUv/+/XN9jYJSrFgx9e/fXwsXLtTBgwclXbzKYenSperbt2+uVxsAAG5+BHcAwE1v3759+vbbb3X//ffLGKOUlBSlpKTo4YcflvT/nzQvSb169dL69eu1Z88eSVJcXJzsdru6dOniGHP06FFt27bNEXAvTd7e3jLG6M8//3R6/aCgoGw1/fjjj2rTpo0kadKkSfr++++1ceNGDR06VNLFS/sl6fjx45Kk8uXLOy3v7u6usmXLOrUdPXpUX3/9dba66tSpI0nZ6spJ9erVtXHjRm3atEk7duxQSkqKZsyYIV9f31y3KSd//PGHKlaseM0xed2fObly/0hSYGCgpP+/DyUpOjpap06d0syZMyVJ48aNU8WKFdW+fftrrv/S7Qz79+/PtZa/o1evXvLy8tLHH38sSRo/fry8vLyc/mAEACi6uMcdAHDTmzx5sowxmjNnjubMmZOtf+rUqXrrrbfk5uamLl26KCYmRlOmTNF//vMfTZ8+XR06dHA6u+zv7y8vLy+nwH85f39/p/mczpjOmjVLHh4eWrhwoYoXL+5onz9/vtO4S+H86NGjqlChgqP9woULToH00uvWq1dP//nPf3KsKzg4OMf2yxUvXlyNGjXKddz1ngUuV66cDh8+fM0xed2fObn8QXeXJCcnS5LTHzhuueUWRUVFafz48YqKitKCBQs0fPhwubm5XXP9kZGRevnllzV//nzde++9udaTV76+vurevbs+/fRTDR48WHFxceratatKly6d768FACh8CO4AgJtaZmampk6dqurVq+vTTz/N1r9w4UKNHj1aS5Ys0QMPPKAyZcqoQ4cOmjZtmu6++24lJydnO+v5wAMPaMSIESpbtqyqVq36t+qy2Wxyd3d3Coxnz57V9OnTncY1a9ZMkjR79myn7wSfM2dOtifF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nDihbt26qVy5cvLy8lJoaKji4uJy34koNFq1aqXAwEDH++nVrFu3Ts2aNZOXl5dCQkI0YMAAx3E8duxY1a1b1zH20meK8ePHO9oiIyM1ZMiQHNcdHR2t2267Tb1795Z08Vh/7bXXNHHiRPn7++uNN95QxYoVZbfbddttt2np0qWOZQ8cOCCbzab//e9/Cg8PV/HixTVjxoxsr3H8+HHdcccdateunc6dO3f9Owg3LbvdrsDAQIWEhKhr167q1q2b0/tpQkKCGjVqpBIlSqhJkybau3ev0/K5fb44efKknnrqKQUEBMjHx0ctWrTQ1q1bHf3Dhg3TbbfdpunTp6tKlSry9fXVo48+qlOnTjnGXH6p/J49e7JdnTJ37lwVL15c27dvz8c9UzQQ3OHkr7/+0tKlS9WvXz+VLFkyW//l914NHz5cnTp10rZt23TfffepW7du+uuvv3Jc75YtW9SyZUvVqVNH69ev13fffae2bdsqMzNTknT69GnFxMRo48aNWrlypYoVK6YHH3xQWVlZkqRTp06pbdu2qlu3rjZv3qw333xTL774otNr/P7777rvvvvUuHFjbd26VRMmTFBsbKzeeuutfNo7KEoSEhLUqVMnPfroo9q+fbuGDRumV1991RHKr8eYMWO0YMEC/e9//9PevXs1Y8YMR0DfuHGjpIvhKCkpyTE/b948Pfvssxo0aJB27NihPn36qGfPnlq1apXTuvPy84ebW27vfUlJSerSpYt69eql3bt3a/Xq1erYsaOMMVddpzFGcXFx+ve//61atWqpRo0a+t///pdt3NSpU1WyZElt2LBBo0aN0htvvKH4+HhJFy8b7tChg0qUKKENGzZo4sSJGjp0qNPyZ86cUUREhEqVKqVvv/1W3333nUqVKqV7771X58+fz7G2V155RXFxcZowYYJ27typ5557Tv/+97+1Zs0aSdKrr76qXbt2acmSJdq9e7cmTJggf3//v7VvYU1ubm4aMWKExo4dq8OHD+c4Zvv27YqMjFTHjh21bds2zZ49W99995369+8v6WK42Llzp/78809JF//45e/v7ziOLly4oHXr1ql58+Y5rt9msykuLk5r167VpEmT1KNHD3Xu3FkdOnTQhx9+qNGjR+vdd9/Vtm3bFBkZqXbt2ikxMdFpHS+++KIGDBig3bt3KzIy0qnv8OHD+te//qVatWo5gg5wJS8vL6erNYYOHarRo0dr06ZNcnd3V69evRx9uX2+MMbo/vvvV3JyshYvXqyEhAQ1aNBALVu2dPp88csvv2j+/PlauHChFi5cqDVr1mS7deWSWrVq6d1331Xfvn3122+/6ciRI+rdu7fefvttpz+c4ToZ4DIbNmwwkszcuXOvOU6SeeWVVxzzaWlpxmazmSVLlhhjjFm1apWRZE6cOGGMMaZLly6madOm113HsWPHjCSzfft2Y4wxEyZMMGXLljVnz551jJk0aZKRZH766SdjjDEvv/yyqVmzpsnKynKMGT9+vClVqpTJzMy87tfGza979+7Gzc3NlCxZ0mkqXry447jt2rWrad26tdNyzz//vKldu7ZjXpKZN2+e0xhfX18TFxdnjDEmOjratGjRwumYvFxOyzdp0sT07t3bqe2RRx4x9913n9Ny1/r5w82ne/fupn379jn25fbel5CQYCSZAwcOXPfrLV++3JQrV85kZGQYY4x5//33s72HN2/e3Nxzzz1ObY0bNzYvvviiMcaYJUuWGHd3d5OUlOToj4+PdzruY2Njs9Wenp5uvLy8zLJly7Jte1pamilevLhZt26d0+s+8cQTpkuXLsYYY9q2bWt69ux53duKwuXy4+Guu+4yvXr1MsYYM2/ePHP5x9rHHnvMPPXUU07Lrl271hQrVsycPXvWZGVlGX9/fzNnzhxjjDG33XabGTlypAkICDDGGLNu3Trj7u5uTp06dc16Jk+ebIoVK2ZCQkJMSkqKMcaY4OBg85///MdpXOPGjU3fvn2NMcbs37/fSDIffPCB05i4uDjj6+tr9u7daypVqmSio6Ov+vsDRc+Vvwc2bNhgypYtazp16uT43L1ixQpH/6JFi4wkx2fn3D5frFy50vj4+Jhz5845jalevbr55JNPjDHGvP7666ZEiRImNTXV0f/888+bO++80zHfvHlz8+yzzzqt4/777zf/+te/TMuWLU3r1q05rv8mzrjDifm/MzDXc296vXr1HP8uWbKkvL29dezYsRzHXjrjfjW//PKLunbtqmrVqsnHx0dVq1aVdPEeS0nau3ev6tWr5/QX5zvuuMNpHbt379bdd9/tVHvTpk2VlpZ21b/Io+iKiIjQli1bnKZPP/3U0b979241bdrUaZmmTZsqMTHRcaVIbnr06KEtW7aoZs2aGjBggJYvX57rMld73d27dzu15eXnDze33N776tevr5YtW6pu3bp65JFHNGnSpFzvDY6NjVXnzp3l7u4uSerSpYs2bNiQ7bLLy49DSQoKCnIch3v37lVISIgCAwMd/Ve+byckJGjfvn3y9vZWqVKlVKpUKfn5+encuXPZbpeSpF27duncuXNq3bq1Y3ypUqU0bdo0x/hnnnlGs2bN0m233aYXXnhB69aty20XopB65513NHXqVO3atStbX0JCgqZMmeJ0nERGRiorK0v79++XzWZTs2bNtHr1aqWkpGjnzp16+umnlZmZ6bgypUGDBipVqtQ1a+jZs6eCgoI0YMAA+fr6KjU1VUeOHLmu9/FGjRplW9/Zs2d1zz33qEOHDhozZgzPCoKThQsXqlSpUipevLjuvvtuNWvWTGPHjnX0X/6eHBQUJEmO9+TcPl8kJCQoLS1NZcuWdfq52b9/v9P7cZUqVZzuYb/8ff9qJk+erG3btmnz5s2aMmUKx/Xf5O7qAmAtoaGhstls2r17d65PMPbw8HCat9lsjkvbr+Tl5XXNdbVt21YhISGaNGmSgoODlZWVpbCwMMelksaYbD/k5orLPK81hjcIXKlkyZK65ZZbnNou/wPP9RxzNpstW9vll6w1aNBA+/fv15IlS7RixQp16tRJrVq1crofNyc5ve6VbXn5+cPNLbf3Pjc3N8XHx2vdunVavny5xo4dq6FDh2rDhg2OP5Je7q+//tL8+fOVkZGhCRMmONozMzM1efJkvfPOO462ax2HOdV1paysLDVs2FAzZ87M1leuXLkcx0vSokWLVKFCBac+u90uSYqKitJvv/2mRYsWacWKFWrZsqX69eund99995q1oPBp1qyZIiMj9fLLL6tHjx5OfVlZWerTp48GDBiQbblKlSpJuni5/MSJE7V27VrVr19fpUuXVrNmzbRmzRqtXr1a4eHh11WHu7u7449cl1zP+3hOtyTa7Xa1atVKixYt0vPPP6+KFSteVw0oGiIiIjRhwgR5eHgoODjY8R586Y9Xl78nXzreLv9scK3jMisrS0FBQVq9enW21738Vtm/8/lj69atOn36tIoVK6bk5GQFBwfnsqXICWfc4cTPz0+RkZEaP358jg8u+rtfk1WvXr2rfpXc8ePHtXv3br3yyitq2bKlbr311mxng2rVqqVt27YpPT3d0bZp0yanMbVr19a6deucgtS6devk7e2d7QMekJvatWvru+++c2pbt26datSoITc3N0kXg8XlTxROTEzUmTNnnJbx8fFR586dNWnSJM2ePVtffvml414xDw+PbGfvb7311hxf99Zbb823bcPN5Xre+2w2m5o2barhw4frp59+kqenp+bNm5fj+mbOnKmKFStq69atTlekfPDBB5o6dep1P/CzVq1aOnjwoI4ePepou/Qsh0saNGigxMREBQQE6JZbbnGacvo60dq1a8tut+vgwYPZxoeEhDjGlStXTj169NCMGTP0wQcfaOLEiddVMwqft99+W19//XW2KysaNGignTt3ZjtObrnlFnl6ekr6//e5z5kzxxHSmzdvrhUrVlzz/vZr8fHxUXBw8N9+Hy9WrJimT5+uhg0bqkWLFjpy5Eiea8DN69JJh8qVK2cL0LnJ7fNFgwYNlJycLHd392w/M//kOSF//fWXevTooaFDh6pnz57q1q2bzp49+7fXV5QR3JHNRx99pMzMTN1xxx368ssvlZiYqN27d2vMmDG6++67/9Y6hwwZoo0bN6pv377atm2b9uzZowkTJujPP/90PEl44sSJ2rdvn7755hvFxMQ4Ld+1a1dlZWXpqaee0u7du7Vs2TLH2ZNLfyns27evDh06pOjoaO3Zs0dfffWVXn/9dcXExKhYMQ515M2gQYO0cuVKvfnmm/r55581depUjRs3zulrV1q0aKFx48Zp8+bN2rRpk55++mmnX6Tvv/++Zs2apT179ujnn3/WF198ocDAQMdfrqtUqaKVK1cqOTnZ8ceq559/XlOmTNHHH3+sxMREvffee5o7d67lvu4FN97Jkyez3d5x8ODBXN/7NmzYoBEjRmjTpk06ePCg5s6dqz/++OOqISI2NlYPP/ywwsLCnKZevXopJSVFixYtuq56W7durerVq6t79+7atm2bvv/+e8fD6S69b3fr1k3+/v5q37691q5dq/3792vNmjV69tlnc7zFydvbW4MHD9Zzzz2nqVOn6pdfftFPP/2k8ePHa+rUqZKk1157TV999ZX27dunnTt3auHChfzh6yZWt25ddevWzelyYenig9/Wr1+vfv36acuWLUpMTNSCBQsUHR3tGBMWFqayZctq5syZjuAeHh6u+fPnOy5Z/zuef/55vfPOO5o9e7b27t2rl156SVu2bNGzzz57Xcu7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",
      "text/plain": [
       "<Figure size 1200x600 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "\n",
    "# Sample data for demonstration\n",
    "data = {\n",
    "    'city': ['New York', 'Los Angeles', 'Chicago', 'Houston', 'Phoenix'],\n",
    "    'price': [200, 150, 180, 170, 160],\n",
    "    'number_of_reviews': [100, 80, 120, 90, 110],\n",
    "    'room_type': ['Entire home', 'Private room', 'Entire home', 'Entire home', 'Private room']\n",
    "}\n",
    "\n",
    "# Creating a sample DataFrame\n",
    "listings = pd.DataFrame(data)\n",
    "\n",
    "# Group by city and calculate aggregates\n",
    "city_group = listings.groupby('city').agg({\n",
    "    'price': ['mean', 'median', 'std'],\n",
    "    'number_of_reviews': 'sum',\n",
    "    'room_type': lambda x: x.value_counts().idxmax()  # Most common room type\n",
    "}).reset_index()\n",
    "\n",
    "# Flatten multi-level columns and rename them\n",
    "city_group.columns = ['City', 'Avg_Price', 'Median_Price', 'Price_STD', 'Total_Reviews', 'Most_Common_Room_Type']\n",
    "\n",
    "# Check DataFrame\n",
    "print(city_group.columns)\n",
    "print(city_group.head())\n",
    "\n",
    "# Create the plot\n",
    "plt.figure(figsize=(12, 6))\n",
    "sns.barplot(x='City', y='Avg_Price', data=city_group)\n",
    "plt.title('Average Price by City')\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "id": "010f7423-3d7a-4f18-bb8a-4d11188c3ba8",
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "could not convert string to float: 'New York'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[61], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m corr \u001b[38;5;241m=\u001b[39m listings\u001b[38;5;241m.\u001b[39mcorr()\n\u001b[0;32m      2\u001b[0m corr[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39msort_values(ascending\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:11049\u001b[0m, in \u001b[0;36mDataFrame.corr\u001b[1;34m(self, method, min_periods, numeric_only)\u001b[0m\n\u001b[0;32m  11047\u001b[0m cols \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcolumns\n\u001b[0;32m  11048\u001b[0m idx \u001b[38;5;241m=\u001b[39m cols\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[1;32m> 11049\u001b[0m mat \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mto_numpy(dtype\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mfloat\u001b[39m, na_value\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mnan, copy\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m)\n\u001b[0;32m  11051\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m method \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mpearson\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n\u001b[0;32m  11052\u001b[0m     correl \u001b[38;5;241m=\u001b[39m libalgos\u001b[38;5;241m.\u001b[39mnancorr(mat, minp\u001b[38;5;241m=\u001b[39mmin_periods)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:1993\u001b[0m, in \u001b[0;36mDataFrame.to_numpy\u001b[1;34m(self, dtype, copy, na_value)\u001b[0m\n\u001b[0;32m   1991\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m dtype \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   1992\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m np\u001b[38;5;241m.\u001b[39mdtype(dtype)\n\u001b[1;32m-> 1993\u001b[0m result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_mgr\u001b[38;5;241m.\u001b[39mas_array(dtype\u001b[38;5;241m=\u001b[39mdtype, copy\u001b[38;5;241m=\u001b[39mcopy, na_value\u001b[38;5;241m=\u001b[39mna_value)\n\u001b[0;32m   1994\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m result\u001b[38;5;241m.\u001b[39mdtype \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m dtype:\n\u001b[0;32m   1995\u001b[0m     result \u001b[38;5;241m=\u001b[39m np\u001b[38;5;241m.\u001b[39masarray(result, dtype\u001b[38;5;241m=\u001b[39mdtype)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\internals\\managers.py:1694\u001b[0m, in \u001b[0;36mBlockManager.as_array\u001b[1;34m(self, dtype, copy, na_value)\u001b[0m\n\u001b[0;32m   1692\u001b[0m         arr\u001b[38;5;241m.\u001b[39mflags\u001b[38;5;241m.\u001b[39mwriteable \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m   1693\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m-> 1694\u001b[0m     arr \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_interleave(dtype\u001b[38;5;241m=\u001b[39mdtype, na_value\u001b[38;5;241m=\u001b[39mna_value)\n\u001b[0;32m   1695\u001b[0m     \u001b[38;5;66;03m# The underlying data was copied within _interleave, so no need\u001b[39;00m\n\u001b[0;32m   1696\u001b[0m     \u001b[38;5;66;03m# to further copy if copy=True or setting na_value\u001b[39;00m\n\u001b[0;32m   1698\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m na_value \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default:\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\internals\\managers.py:1753\u001b[0m, in \u001b[0;36mBlockManager._interleave\u001b[1;34m(self, dtype, na_value)\u001b[0m\n\u001b[0;32m   1751\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m   1752\u001b[0m         arr \u001b[38;5;241m=\u001b[39m blk\u001b[38;5;241m.\u001b[39mget_values(dtype)\n\u001b[1;32m-> 1753\u001b[0m     result[rl\u001b[38;5;241m.\u001b[39mindexer] \u001b[38;5;241m=\u001b[39m arr\n\u001b[0;32m   1754\u001b[0m     itemmask[rl\u001b[38;5;241m.\u001b[39mindexer] \u001b[38;5;241m=\u001b[39m \u001b[38;5;241m1\u001b[39m\n\u001b[0;32m   1756\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m itemmask\u001b[38;5;241m.\u001b[39mall():\n",
      "\u001b[1;31mValueError\u001b[0m: could not convert string to float: 'New York'"
     ]
    }
   ],
   "source": [
    "corr = listings.corr()\n",
    "corr['price'].sort_values(ascending=False)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "id": "8f7cd59d-79e7-44aa-9e9b-ad192b8ae04b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "city                 object\n",
      "price                 int64\n",
      "number_of_reviews     int64\n",
      "room_type            object\n",
      "dtype: object\n"
     ]
    }
   ],
   "source": [
    "print(listings.dtypes)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "id": "c51697b1-0073-4f40-b62c-b22a852da8d9",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   price  number_of_reviews\n",
      "0    200                100\n",
      "1    150                 80\n",
      "2    180                120\n",
      "3    170                 90\n",
      "4    160                110\n"
     ]
    }
   ],
   "source": [
    "numeric_columns = listings.select_dtypes(include=['number'])\n",
    "print(numeric_columns.head())  # Check the numeric columns\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "id": "e11cc521-a4e6-4dd1-9e51-cb6f5a243151",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "price                1.000000\n",
      "number_of_reviews    0.410997\n",
      "Name: price, dtype: float64\n"
     ]
    }
   ],
   "source": [
    "corr = numeric_columns.corr()\n",
    "print(corr['price'].sort_values(ascending=False))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "23b83e48-335a-46e9-8dff-70592c25855c",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "id": "fd78d3b9-b113-42f7-9d79-8bf8f388c33f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Data Types:\n",
      " city                 object\n",
      "price                 int64\n",
      "number_of_reviews     int64\n",
      "room_type            object\n",
      "dtype: object\n",
      "Correlation with Price:\n",
      " price                1.000000\n",
      "number_of_reviews    0.410997\n",
      "Name: price, dtype: float64\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Sample data for demonstration (replace with your actual data)\n",
    "data = {\n",
    "    'city': ['New York', 'Los Angeles', 'Chicago', 'Houston', 'Phoenix'],\n",
    "    'price': [200, 150, 180, 170, 160],\n",
    "    'number_of_reviews': [100, 80, 120, 90, 110],\n",
    "    'room_type': ['Entire home', 'Private room', 'Entire home', 'Entire home', 'Private room']\n",
    "}\n",
    "\n",
    "# Creating a sample DataFrame\n",
    "listings = pd.DataFrame(data)\n",
    "\n",
    "# Print data types to identify non-numeric columns\n",
    "print(\"Data Types:\\n\", listings.dtypes)\n",
    "\n",
    "# Filter out non-numeric columns\n",
    "numeric_columns = listings.select_dtypes(include=['number'])\n",
    "\n",
    "# Compute correlation matrix\n",
    "corr = numeric_columns.corr()\n",
    "print(\"Correlation with Price:\\n\", corr['price'].sort_values(ascending=False))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "id": "daad9937-d054-454a-bd8b-4e9b5fb0e590",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   price  number_of_reviews  city_Chicago  city_Houston  city_Los Angeles  \\\n",
      "0    200                100         False         False             False   \n",
      "1    150                 80         False         False              True   \n",
      "2    180                120          True         False             False   \n",
      "3    170                 90         False          True             False   \n",
      "4    160                110         False         False             False   \n",
      "\n",
      "   city_New York  city_Phoenix  room_type_Entire home  room_type_Private room  \n",
      "0           True         False                   True                   False  \n",
      "1          False         False                  False                    True  \n",
      "2          False         False                   True                   False  \n",
      "3          False         False                   True                   False  \n",
      "4          False          True                  False                    True  \n",
      "price                     1.000000\n",
      "city_New York             0.813733\n",
      "room_type_Entire home     0.806784\n",
      "number_of_reviews         0.410997\n",
      "city_Chicago              0.232495\n",
      "city_Houston             -0.058124\n",
      "city_Phoenix             -0.348743\n",
      "city_Los Angeles         -0.639362\n",
      "room_type_Private room   -0.806784\n",
      "Name: price, dtype: float64\n"
     ]
    }
   ],
   "source": [
    "listings_encoded = pd.get_dummies(listings, columns=['city', 'room_type'])\n",
    "print(listings_encoded.head())\n",
    "\n",
    "# Compute correlation on the encoded DataFrame\n",
    "corr_encoded = listings_encoded.corr()\n",
    "print(corr_encoded['price'].sort_values(ascending=False))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "id": "65be3b0f-5d7c-41a9-8f53-fcc3172d4fe4",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "\"['accommodates', 'bedrooms', 'bathrooms', 'review_scores_rating'] not in index\"",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[74], line 7\u001b[0m\n\u001b[0;32m      5\u001b[0m \u001b[38;5;66;03m# Select relevant features\u001b[39;00m\n\u001b[0;32m      6\u001b[0m features \u001b[38;5;241m=\u001b[39m [\u001b[38;5;124m'\u001b[39m\u001b[38;5;124maccommodates\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mbedrooms\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mbathrooms\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mnumber_of_reviews\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_scores_rating\u001b[39m\u001b[38;5;124m'\u001b[39m]\n\u001b[1;32m----> 7\u001b[0m X \u001b[38;5;241m=\u001b[39m listings[features]\n\u001b[0;32m      8\u001b[0m y \u001b[38;5;241m=\u001b[39m listings[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m]\n\u001b[0;32m     10\u001b[0m X_train, X_test, y_train, y_test \u001b[38;5;241m=\u001b[39m train_test_split(X, y, test_size\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m0.3\u001b[39m, random_state\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m42\u001b[39m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:4108\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4106\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m is_iterator(key):\n\u001b[0;32m   4107\u001b[0m         key \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mlist\u001b[39m(key)\n\u001b[1;32m-> 4108\u001b[0m     indexer \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39m_get_indexer_strict(key, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mcolumns\u001b[39m\u001b[38;5;124m\"\u001b[39m)[\u001b[38;5;241m1\u001b[39m]\n\u001b[0;32m   4110\u001b[0m \u001b[38;5;66;03m# take() does not accept boolean indexers\u001b[39;00m\n\u001b[0;32m   4111\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mgetattr\u001b[39m(indexer, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mdtype\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;28;01mNone\u001b[39;00m) \u001b[38;5;241m==\u001b[39m \u001b[38;5;28mbool\u001b[39m:\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:6200\u001b[0m, in \u001b[0;36mIndex._get_indexer_strict\u001b[1;34m(self, key, axis_name)\u001b[0m\n\u001b[0;32m   6197\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m   6198\u001b[0m     keyarr, indexer, new_indexer \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_reindex_non_unique(keyarr)\n\u001b[1;32m-> 6200\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_raise_if_missing(keyarr, indexer, axis_name)\n\u001b[0;32m   6202\u001b[0m keyarr \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mtake(indexer)\n\u001b[0;32m   6203\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(key, Index):\n\u001b[0;32m   6204\u001b[0m     \u001b[38;5;66;03m# GH 42790 - Preserve name from an Index\u001b[39;00m\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:6252\u001b[0m, in \u001b[0;36mIndex._raise_if_missing\u001b[1;34m(self, key, indexer, axis_name)\u001b[0m\n\u001b[0;32m   6249\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mNone of [\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mkey\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m] are in the [\u001b[39m\u001b[38;5;132;01m{\u001b[39;00maxis_name\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m]\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m   6251\u001b[0m not_found \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mlist\u001b[39m(ensure_index(key)[missing_mask\u001b[38;5;241m.\u001b[39mnonzero()[\u001b[38;5;241m0\u001b[39m]]\u001b[38;5;241m.\u001b[39munique())\n\u001b[1;32m-> 6252\u001b[0m \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mnot_found\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m not in index\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
      "\u001b[1;31mKeyError\u001b[0m: \"['accommodates', 'bedrooms', 'bathrooms', 'review_scores_rating'] not in index\""
     ]
    }
   ],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.linear_model import LinearRegression\n",
    "from sklearn.metrics import mean_squared_error, r2_score\n",
    "\n",
    "# Select relevant features\n",
    "features = ['accommodates', 'bedrooms', 'bathrooms', 'number_of_reviews', 'review_scores_rating']\n",
    "X = listings[features]\n",
    "y = listings['price']\n",
    "\n",
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)\n",
    "\n",
    "model = LinearRegression()\n",
    "model.fit(X_train, y_train)\n",
    "\n",
    "y_pred = model.predict(X_test)\n",
    "\n",
    "print(f'Mean Squared Error: {mean_squared_error(y_test, y_pred)}')\n",
    "print(f'R^2 Score: {r2_score(y_test, y_pred)}')\n",
    "print(f'Coefficients: {model.coef_}')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "id": "c297ceeb-ceeb-426a-9196-c08c7c30944c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['city', 'price', 'number_of_reviews', 'room_type'], dtype='object')\n"
     ]
    }
   ],
   "source": [
    "print(listings.columns)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "id": "3f26a8cf-222e-469a-9f25-6f793642b39b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Columns in the DataFrame:\n",
      " Index(['accommodates', 'bedrooms', 'bathrooms', 'number_of_reviews',\n",
      "       'review_scores_rating', 'price'],\n",
      "      dtype='object')\n",
      "Training data and target:\n",
      "   accommodates  bedrooms  bathrooms  number_of_reviews  review_scores_rating\n",
      "0             1         1          1                 10                   8.5\n",
      "2             3         1          1                  5                   7.5 0    100\n",
      "2    200\n",
      "Name: price, dtype: int64\n",
      "Testing data and target:\n",
      "   accommodates  bedrooms  bathrooms  number_of_reviews  review_scores_rating\n",
      "1             2         2          1                 15                   9.0\n",
      "3             4         3          2                 20                   8.0 1    150\n",
      "3    250\n",
      "Name: price, dtype: int64\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "from sklearn.model_selection import train_test_split\n",
    "\n",
    "# Sample DataFrame for demonstration (replace with your actual data)\n",
    "data = {\n",
    "    'accommodates': [1, 2, 3, 4],\n",
    "    'bedrooms': [1, 2, 1, 3],\n",
    "    'bathrooms': [1, 1, 1, 2],\n",
    "    'number_of_reviews': [10, 15, 5, 20],\n",
    "    'review_scores_rating': [8.5, 9.0, 7.5, 8.0],\n",
    "    'price': [100, 150, 200, 250]\n",
    "}\n",
    "\n",
    "# Creating the DataFrame\n",
    "listings = pd.DataFrame(data)\n",
    "\n",
    "# Print the column names to verify\n",
    "print(\"Columns in the DataFrame:\\n\", listings.columns)\n",
    "\n",
    "# Define features and target variable\n",
    "features = ['accommodates', 'bedrooms', 'bathrooms', 'number_of_reviews', 'review_scores_rating']\n",
    "target = 'price'\n",
    "\n",
    "# Select features and target\n",
    "X = listings[features]\n",
    "y = listings[target]\n",
    "\n",
    "# Split the data into training and testing sets\n",
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)\n",
    "\n",
    "print(\"Training data and target:\")\n",
    "print(X_train.head(), y_train.head())\n",
    "\n",
    "print(\"Testing data and target:\")\n",
    "print(X_test.head(), y_test.head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 80,
   "id": "c7d8d49f-8cac-4c92-b039-9abaf8fa37c1",
   "metadata": {},
   "outputs": [],
   "source": [
    "features = ['accommodates', 'bedrooms', 'bathrooms', 'number_of_reviews', 'review_score_rating']\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 86,
   "id": "a27257cd-2095-4d87-b5ff-c8820ed63b2a",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyboardInterrupt",
     "evalue": "",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[86], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m reviews[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124myear\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m reviews[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mdt\u001b[38;5;241m.\u001b[39myear\n\u001b[0;32m      2\u001b[0m reviews[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmonth\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m reviews[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mdt\u001b[38;5;241m.\u001b[39mmonth\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\accessor.py:96\u001b[0m, in \u001b[0;36mPandasDelegate._add_delegate_accessors.<locals>._create_delegator_property.<locals>._getter\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     95\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21m_getter\u001b[39m(\u001b[38;5;28mself\u001b[39m):\n\u001b[1;32m---> 96\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_delegate_property_get(name)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\accessors.py:93\u001b[0m, in \u001b[0;36mProperties._delegate_property_get\u001b[1;34m(self, name)\u001b[0m\n\u001b[0;32m     89\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01mpandas\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m Series\n\u001b[0;32m     91\u001b[0m values \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_get_values()\n\u001b[1;32m---> 93\u001b[0m result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mgetattr\u001b[39m(values, name)\n\u001b[0;32m     95\u001b[0m \u001b[38;5;66;03m# maybe need to upcast (ints)\u001b[39;00m\n\u001b[0;32m     96\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(result, np\u001b[38;5;241m.\u001b[39mndarray):\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\extension.py:68\u001b[0m, in \u001b[0;36m_inherit_from_data.<locals>.fget\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     67\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mfget\u001b[39m(\u001b[38;5;28mself\u001b[39m):\n\u001b[1;32m---> 68\u001b[0m     result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mgetattr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_data, name)\n\u001b[0;32m     69\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m wrap:\n\u001b[0;32m     70\u001b[0m         \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(result, \u001b[38;5;28mtype\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_data)):\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\arrays\\datetimes.py:152\u001b[0m, in \u001b[0;36m_field_accessor.<locals>.f\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    149\u001b[0m     result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_maybe_mask_results(result, fill_value\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mNone\u001b[39;00m)\n\u001b[0;32m    151\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 152\u001b[0m     result \u001b[38;5;241m=\u001b[39m fields\u001b[38;5;241m.\u001b[39mget_date_field(values, field, reso\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_creso)\n\u001b[0;32m    153\u001b[0m     result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_maybe_mask_results(\n\u001b[0;32m    154\u001b[0m         result, fill_value\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mNone\u001b[39;00m, convert\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mfloat64\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    155\u001b[0m     )\n\u001b[0;32m    157\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m result\n",
      "\u001b[1;31mKeyboardInterrupt\u001b[0m: "
     ]
    }
   ],
   "source": [
    "reviews['year'] = reviews['date'].dt.year\n",
    "reviews['month'] = reviews['date'].dt.month\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 92,
   "id": "75b067d2-b5ff-49a4-9414-95bb5557b113",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Work with a smaller sample of the data\n",
    "sample_reviews = reviews.sample(n=1000, random_state=42)\n",
    "sample_reviews['year'] = sample_reviews['date'].dt.year\n",
    "sample_reviews['month'] = sample_reviews['date'].dt.month\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 94,
   "id": "51be862f-b6cc-4330-8199-ea7a328301a1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Number of rows: 5373143\n"
     ]
    }
   ],
   "source": [
    "print(f\"Number of rows: {len(reviews)}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "id": "8df9b894-3d34-4ddc-b4e2-bf71cc1c95d0",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0   2018-09-30\n",
      "1   2018-09-30\n",
      "2   2018-09-30\n",
      "3   2018-09-30\n",
      "4   2018-09-30\n",
      "Name: date, dtype: datetime64[ns]\n"
     ]
    }
   ],
   "source": [
    "# Convert 'date' column to datetime if not already\n",
    "reviews['date'] = pd.to_datetime(reviews['date'], errors='coerce')  # 'coerce' handles errors gracefully\n",
    "\n",
    "# Check for any conversion issues\n",
    "print(reviews['date'].head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 98,
   "id": "88de7181-7d61-4488-a781-7dad730fe51f",
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "Could not convert object to NumPy datetime",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[98], line 4\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;28;01mimport\u001b[39;00m \u001b[38;5;21;01mnumpy\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m \u001b[38;5;21;01mnp\u001b[39;00m\n\u001b[0;32m      3\u001b[0m \u001b[38;5;66;03m# Extract year and month using numpy functions for large datasets\u001b[39;00m\n\u001b[1;32m----> 4\u001b[0m reviews[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124myear\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m np\u001b[38;5;241m.\u001b[39mdatetime64(reviews[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mastype(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdatetime64[Y]\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39mastype(\u001b[38;5;28mint\u001b[39m) \u001b[38;5;241m+\u001b[39m \u001b[38;5;241m1970\u001b[39m\n\u001b[0;32m      5\u001b[0m reviews[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmonth\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m np\u001b[38;5;241m.\u001b[39mdatetime64(reviews[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mastype(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdatetime64[M]\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39mastype(\u001b[38;5;28mint\u001b[39m) \u001b[38;5;241m%\u001b[39m \u001b[38;5;241m12\u001b[39m \u001b[38;5;241m+\u001b[39m \u001b[38;5;241m1\u001b[39m\n",
      "\u001b[1;31mValueError\u001b[0m: Could not convert object to NumPy datetime"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "\n",
    "# Extract year and month using numpy functions for large datasets\n",
    "reviews['year'] = np.datetime64(reviews['date']).astype('datetime64[Y]').astype(int) + 1970\n",
    "reviews['month'] = np.datetime64(reviews['date']).astype('datetime64[M]').astype(int) % 12 + 1\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 100,
   "id": "6e434727-8607-473e-be13-fc52af78c3a7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0\n"
     ]
    }
   ],
   "source": [
    "print(reviews['date'].isnull().sum())  # Check for null values\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 102,
   "id": "54024588-ecbb-412e-b256-413063b2d07f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "        date  year  month\n",
      "0 2024-01-01  2024      1\n",
      "1 2024-02-01  2024      2\n",
      "2 2024-03-01  2024      3\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Sample data (replace with your actual data loading process)\n",
    "data = {\n",
    "    'date': ['2024-01-01', '2024-02-01', '2024-03-01']  # Sample dates\n",
    "}\n",
    "reviews = pd.DataFrame(data)\n",
    "\n",
    "# Convert 'date' column to datetime\n",
    "reviews['date'] = pd.to_datetime(reviews['date'], errors='coerce')\n",
    "\n",
    "# Extract year and month\n",
    "reviews['year'] = reviews['date'].dt.year\n",
    "reviews['month'] = reviews['date'].dt.month\n",
    "\n",
    "print(reviews.head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 104,
   "id": "3db25ddd-9805-49ea-9d09-7dd50a35e6eb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>month</th>\n",
       "      <th>review_count</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2024</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2024</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2024</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   year  month  review_count\n",
       "0  2024      1             1\n",
       "1  2024      2             1\n",
       "2  2024      3             1"
      ]
     },
     "execution_count": 104,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "monthly_reviews = reviews.groupby(['year', 'month']).size().reset_index(name='review_count')\n",
    "monthly_reviews\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "id": "dff18270-2a47-4cdf-a703-e80a41365406",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAABI0AAAJuCAYAAAA9yPIiAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjguNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8fJSN1AAAACXBIWXMAAA9hAAAPYQGoP6dpAABRIklEQVR4nO3daZQV1dk/7PtAN92IdAsyz0MUxQERjCIO4ABOGGOC+iRRMEZFVFTMA5I4+yjOiTOKoMEYRxzQoIIKOIAiCjhrjIBG6SCotIJMTb0ffDl/2wKkm4am4brWOmt5du3a566z+1jxl6pdmSRJkgAAAACAH6hW2QUAAAAAsOkRGgEAAACQIjQCAAAAIEVoBAAAAECK0AgAAACAFKERAAAAAClCIwAAAABShEYAAAAApAiNAAAAAEgRGgHAJujuu++OTCYTmUwmJk6cmNqeJEn87Gc/i0wmE926ddugtUyePDkuvvji+Prrr1PbWrVqFUccccRPjjFx4sQ1Hkt5/PD7yWQykZOTE40bN47jjjsu/vWvf1XIZ/zUZ8+ePXuDfs66evHFF+OYY46Jpk2bRo0aNaKwsDD23nvvuO2222LRokWVXV5ERNx6661x9913r3P/TCYTZ5xxxgar55prrolMJhNjxoxZ7faePXtG3bp14/PPP99gNQBAVSA0AoBNWO3atWPEiBGp9kmTJsW///3vqF279gavYfLkyXHJJZesNjSqbHfddVdMmTIlnn322TjjjDNizJgxsc8++8RXX321wT7z8MMPjylTpkTjxo032Gesq4suuij222+/+Oyzz+Kyyy6L8ePHx/333x8HHnhgXHzxxXH++edXdokRUfbQaEM799xzY5999olTTz01vvzyy1Lb7rjjjhg3blzceuut0aRJk0qqEAA2DTmVXQAAsGbHHnts3HvvvXHLLbdEQUFBtn3EiBHRpUuXKC4ursTqKt/OO+8cnTt3joiIbt26RUlJSVx00UXx2GOPxYknnrhBPrN+/fpRv379DTJ2WTz00ENx6aWXxkknnRTDhw+PTCaT3XbooYfGoEGDYsqUKZVY4aarWrVq8be//S06dOgQp59+etx3330RETFnzpz44x//GL17947jjjtuo9Ty3XffRc2aNTfKZwFAWbnSCAA2Yf/zP/8TEZH9j9qIiIULF8bo0aPj97///Wr3+fLLL6N///7Z25XatGkTf/7zn2Pp0qWl+q26Beiee+6JHXfcMbbaaqvo0KFDPPnkk9k+F198cfzv//5vRES0bt16jbfMPf3007H77rtHzZo1Y4cddoiRI0eu9bjuueeeyGQyqw01Lr300sjNzS3XrUGrAqT//ve/pdqnTZsWRx55ZNStWzfy8/OjY8eO8eCDD2a3z5w5MzKZzGqv6nrqqadK3cq0ptvTnn322TjwwAOjoKAgttpqq+jatWs899xz2e3vvPNOZDKZeOihh7Jtr7/+emQymdhpp51KjXXkkUdGp06d1nqsl156adSpUyduvPHGUoHRKrVr144ePXpk3y9ZsiSGDBkSrVu3jho1akTTpk3j9NNPT11Blslk4uKLL06N16pVq+jbt2/2/arvYcKECXHaaadFvXr1Ytttt42jjz661Ny1atUq3nnnnZg0aVL276dVq1ZrPbZVbr/99th+++0jLy8v2rdvH/fff3922+zZsyMnJyeGDh2a2u+FF15Ifdc/1qZNm7j22mvj/vvvj9GjR0eSJHHSSSdFrVq14rbbbouIiKKiojj11FOjWbNmUaNGjWjdunVccsklsWLFilJjXXLJJbHnnntG3bp1o6CgIHbfffcYMWJEJEmS+g6POOKIeOSRR6Jjx46Rn58fl1xyyTp9FwBQKRIAYJNz1113JRGRvPbaa8nxxx+f/PznP89uu+2225JatWolxcXFyU477ZTsv//+2W3fffddsuuuuya1atVKrr322mTcuHHJBRdckOTk5CSHHXZYqc+IiKRVq1bJz3/+8+TBBx9Mxo4dm3Tr1i3JyclJ/v3vfydJkiSffvppcuaZZyYRkTzyyCPJlClTkilTpiQLFy5MkiRJWrZsmTRr1ixp3759MmrUqOSZZ55JevfunUREMmnSpOxnTZgwIYmIZMKECUmSJMnSpUuTRo0aJb/97W9L1bR8+fKkSZMmSe/evdf5+/mhm2++OYmIZPTo0dm2559/PqlRo0ay7777Jg888EDy9NNPJ3379k0iIrnrrruy/Tp27Jh07do19VnHHHNM0qBBg2T58uWlPnvWrFnZPvfcc0+SyWSSo446KnnkkUeSJ554IjniiCOS6tWrJ88++2y2X+PGjZNTTjkl+/7KK69MatasmURE8tlnn2W/g4KCgmTQoEFrPP7PP/88iYjk2GOPXev3tMrKlSuTnj17Jjk5OckFF1yQjBs3Lrn22muTWrVqJR07dkyWLFmS7RsRyUUXXZQao2XLlkmfPn2y71d9D23atEnOPPPM5JlnnknuvPPOpE6dOkn37t2z/d54442kTZs2SceOHbN/P2+88cZa642IpHnz5kn79u2T++67LxkzZkxyyCGHJBGRPPTQQ9l+v/zlL5MWLVokK1asKLV/7969kyZNmmTnbG0OOeSQpH79+smll16aRETyxBNPJEmSJHPnzk2aN2+etGzZMrn99tuTZ599NrnsssuSvLy8pG/fvqXG6Nu3bzJixIhk/Pjxyfjx45PLLrssqVmzZnLJJZekvsPGjRsnbdq0SUaOHJlMmDAhmTp16k/WCACVRWgEAJugH4YiqwKXt99+O0mSJNljjz2y/9H649Bo2LBhSUQkDz74YKnxrrrqqiQiknHjxmXbIiJp2LBhUlxcnG0rKipKqlWrlgwdOjTbds0116RCklVatmyZ5OfnJ3PmzMm2fffdd0ndunWTU089Ndv249AoSZLkoosuSmrUqJH897//zbY98MADqcBpbd/PK6+8kixfvjz55ptvkqeffjpp1KhRst9++5UKC3bYYYekY8eOqQDhiCOOSBo3bpyUlJQkSZIkN954YxIRyQcffJDt8+WXXyZ5eXnJueeem/rsVd/HokWLkrp16ya9evUqNX5JSUnSoUOHUoHf7373u6RNmzbZ9wcddFBy8sknJ3Xq1En+9re/JUmSJC+//HJqrn7slVdeSSIiOe+889b6Pa3y9NNPJxGRXH311aXaV33fd9xxR7atrKFR//79S/W7+uqrk4hI5s6dm2378d/pT4mIpGbNmklRUVG2bcWKFckOO+yQ/OxnP8u2rfq7evTRR7Ntn332WZKTk5MKbNbks88+S+rUqZNERHLSSSdl20899dRk6623LvW3nSRJcu211yYRkbzzzjurHa+kpCRZvnx5cumllybbbrttsnLlyuy2li1bJtWrVy/1NwYAmzK3pwHAJm7//fePtm3bxsiRI+Ott96K1157bY23pj3//PNRq1at+PWvf12qfdVtRT+8XSoionv37qUW027YsGE0aNAg5syZs8717bbbbtGiRYvs+/z8/Nh+++1/cozTTjstIiKGDx+ebbv55ptjl112if3222+dPnuvvfaK3NzcqF27dhxyyCFRp06dePzxxyMn5/tlGz/66KN4//3347e//W1ERKxYsSL7Ouyww2Lu3LnxwQcfRETEb3/728jLyyu1YPN9990XS5cuXev6SJMnT44vv/wy+vTpU2r8lStXxiGHHBKvvfZa9ilmBx54YHz88ccxa9asWLJkSbz00ktxyCGHRPfu3WP8+PER8f1tbnl5ebHPPvus03ewLp5//vmIiFK3l0VE9O7dO2rVqpX6uyiLI488stT7XXfdNSKiTH9Dq3PggQdGw4YNs++rV68exx57bHz00Ufxn//8JyK+X8eqQ4cOccstt2T7DRs2LDKZTJxyyinr9DlNmjSJU089NSK+v+VvlSeffDK6d+8eTZo0KTWvhx56aER8vxj9Ks8//3wcdNBBUVhYGNWrV4/c3Ny48MILY8GCBTFv3rxSn7frrrvG9ttvX8ZvAwAqh9AIADZxmUwmTjzxxPj73/8ew4YNi+233z723Xff1fZdsGBBNGrUKLXGTYMGDSInJycWLFhQqn3bbbdNjZGXlxfffffdOtdX3jEaNmwYxx57bNx+++1RUlISb775Zrz44otletT6qFGj4rXXXovnn38+Tj311Hjvvfey60BF/L+1jf74xz9Gbm5uqVf//v0jImL+/PkREVG3bt048sgjY9SoUVFSUhIR36/b8/Of/zy15tAPrfqMX//616nPuOqqqyJJkuwTug466KCI+D4Yeumll2L58uVxwAEHxEEHHZQNbp599tno2rXrWhdHXhXSzZo1a52+pwULFkROTk5qAe9MJhONGjVK/V2UxY/nPy8vLyKiTH9Dq9OoUaM1tv2w3gEDBsRzzz0XH3zwQSxfvjyGDx8ev/71r1e7/5qsqrlGjRrZtv/+97/xxBNPpOZ01d/Cqr+bqVOnZteOGj58eLz88svx2muvxZ///OeISH8Pm8JT9wBgXXl6GgBUAX379o0LL7wwhg0bFpdffvka+2277bbx6quvRpIkpYKjefPmxYoVK6JevXobo9x1dtZZZ8U999wTjz/+eDz99NOxzTbbZK8KWhc77rhjdvHr7t27R0lJSdx5553x8MMPx69//evs8Q4ZMiSOPvro1Y7Rrl277D+feOKJ8dBDD8X48eOjRYsW8dprr2UXRV6TVZ9x0003xV577bXaPquumGnWrFlsv/328eyzz0arVq2ic+fOsc0228SBBx4Y/fv3j1dffTVeeeWVn1wcuXHjxrHLLrvEuHHjYvHixbHVVluttf+2224bK1asiC+++KJUcJQkSRQVFcUee+yRbcvLy0stmh4R6xUslUdRUdEa234YVP3mN7+JwYMHxy233BJ77bVXFBUVxemnn77en1+vXr3Ydddd1/h7a9KkSURE3H///ZGbmxtPPvlk5OfnZ7c/9thjq91vdYuWA8CmSmgEAFVA06ZN43//93/j/fffjz59+qyx34EHHhgPPvhgPPbYY/HLX/4y2z5q1Kjs9rKqqCtHVqdTp06x9957x1VXXRVvv/12nHLKKVGrVq1yj3f11VfH6NGj48ILL4yjjz462rVrF9ttt13MnDkzrrjiip/cv0ePHtG0adO46667okWLFpGfn1/qyqXV6dq1a2yzzTbx7rvvrtNVUgcddFA8+OCD0bx58zj88MMjImL77bePFi1axIUXXhjLly/PXpG0NhdccEEcc8wxMWDAgBg+fHgqjPj2229j8uTJ0aNHjzjwwAPj6quvjr///e9xzjnnZPuMHj06Fi1aVOrvolWrVvHmm2+WGuv555+Pb7/99idrWpOyXr0W8f2tlP/973+zgVtJSUk88MAD0bZt22jWrFm2X35+fpxyyilx8803x+TJk2O33XaLrl27lrvWVY444ogYO3ZstG3bNurUqbPGfplMJnJycqJ69erZtu+++y7uueee9a4BACqb0AgAqogrr7zyJ/uccMIJccstt0SfPn1i9uzZscsuu8RLL70UV1xxRRx22GHrFEb82C677BIRETfccEP06dMncnNzo127dqXWQlofZ511Vhx77LGRyWSyt4yVV506dWLIkCExaNCg+Mc//hG/+93v4vbbb49DDz00evbsGX379o2mTZvGl19+Ge+991688cYbpR7LXr169TjhhBPi+uuvj4KCgjj66KOjsLBwrZ+59dZbx0033RR9+vSJL7/8Mn79619HgwYN4osvvoiZM2fGF198UepqpQMPPDBuvfXWmD9/fvz1r38t1X7XXXdFnTp1olOnTj95rL17944LLrggLrvssnj//ffjpJNOirZt28bixYvj1Vdfjdtvvz2OPfbY6NGjRxx88MHRs2fPGDx4cBQXF0fXrl3jzTffjIsuuig6duwYxx9/fHbc448/Pi644IK48MILY//994933303br755p/8HtZml112ifvvvz8eeOCBaNOmTeTn52f/rtakXr16ccABB8QFF1wQtWrViltvvTXef//9uP/++1N9+/fvH1dffXW8/vrrceedd5a7zh+69NJLY/z48bH33nvHgAEDol27drFkyZKYPXt2jB07NoYNGxbNmjWLww8/PK6//vr4zW9+E6ecckosWLAgrr322mzYCgBVWiUvxA0ArMaaHin/Y6t7KtWCBQuSfv36JY0bN05ycnKSli1bJkOGDCn1WPUk+f4JVaeffnpqzB8/JStJkmTIkCFJkyZNkmrVqpV6ClrLli2Tww8/PDXG/vvvX6qu1T09bZWlS5cmeXl5ySGHHLLWY/2htX0/3333XdKiRYtku+22yz6KfebMmckxxxyTNGjQIMnNzU0aNWqUHHDAAcmwYcNS+3/44YdJRCQRkYwfP36Nn/3jp8lNmjQpOfzww5O6desmubm5SdOmTZPDDz+81CPikyRJvvrqq6RatWpJrVq1kmXLlmXb77333iQikqOPPnqdv4dVn/vrX/86ady4cZKbm5sUFBQkXbp0Sa655ppST8b77rvvksGDByctW7ZMcnNzk8aNGyennXZa8tVXX5Uab+nSpcmgQYOS5s2bJzVr1kz233//ZMaMGWt8etqP52B1cz179uykR48eSe3atZOISFq2bLnWY1r1t3nrrbcmbdu2TXJzc5Mddtghuffee9e4T7du3ZK6desmixcv/snv7McuuuiiJCKSL774olT7F198kQwYMCBp3bp1kpubm9StWzfp1KlT8uc//zn59ttvs/1GjhyZtGvXLsnLy0vatGmTDB06NBkxYkTq72RNvxcA2FRlkiRJKiGrAgCIiIgnnngijjzyyPjnP/8Zhx12WGWXQxU0b968aNmyZZx55plx9dVXV3Y5ALDZEBoBAJXi3XffjTlz5sRZZ50VtWrVijfeeMMiwZTJf/7zn/j444/jmmuuieeffz4+/PDDaNq0aWWXBQCbjWqVXQAAsGXq379/HHnkkVGnTp247777BEaU2Z133hndunWLd955J+69916BEQBUMFcaAQAAAJDiSiMAAAAAUoRGAAAAAKQIjQAAAABIyansAjZFK1eujM8//zxq165tUU4AAABgs5EkSXzzzTfRpEmTqFZt7dcSCY1W4/PPP4/mzZtXdhkAAAAAG8Snn34azZo1W2sfodFq1K5dOyK+/wILCgoquRoAAACAilFcXBzNmzfPZh9rIzRajVW3pBUUFAiNAAAAgM3OuizHYyFsAAAAAFKERgAAAACkCI0AAAAASLGmEQAAAFDpkiSJFStWRElJSWWXUuXl5uZG9erV13scoREAAABQqZYtWxZz586NxYsXV3Ypm4VMJhPNmjWLrbfeer3GERoBAAAAlWblypUxa9asqF69ejRp0iRq1KixTk/2YvWSJIkvvvgi/vOf/8R22223XlccCY0AAACASrNs2bJYuXJlNG/ePLbaaqvKLmezUL9+/Zg9e3YsX758vUIjC2EDAAAAla5aNRFFRamoK7XMCAAAAAApQiMAAAAAUoRGAAAAAKQIjQAAAABIERoBAAAAbGAlJSWxcuXKyi6jTIRGAAAAwBZl1KhRse2228bSpUtLtf/qV7+KE044ISIinnjiiejUqVPk5+dHmzZt4pJLLokVK1Zk+15//fWxyy67RK1ataJ58+bRv3//+Pbbb7Pb77777thmm23iySefjPbt20deXl7MmTNn4xxgBREaAQAAAFuU3r17R0lJSYwZMybbNn/+/HjyySfjxBNPjGeeeSZ+97vfxYABA+Ldd9+N22+/Pe6+++64/PLLs/2rVasWN954Y7z99tvxt7/9LZ5//vkYNGhQqc9ZvHhxDB06NO6888545513okGDBhvtGCtCJkmSpLKL2NQUFxdHYWFhLFy4MAoKCiq7HAAAANhsLVmyJGbNmhWtW7eO/Pz8jfa5/fv3j9mzZ8fYsWMjIuKGG26IG2+8MT766KPYf//949BDD40hQ4Zk+//973+PQYMGxeeff77a8R566KE47bTTYv78+RHx/ZVGJ554YsyYMSM6dOiw4Q/oB9b2nZYl88jZkEUCAAAAbIpOPvnk2GOPPeKzzz6Lpk2bxl133RV9+/aNTCYTr7/+erz22mulriwqKSmJJUuWxOLFi2OrrbaKCRMmxBVXXBHvvvtuFBcXx4oVK2LJkiWxaNGiqFWrVkRE1KhRI3bdddfKOsT1JjQCAAAAtjgdO3aMDh06xKhRo6Jnz57x1ltvxRNPPBEREStXroxLLrkkjj766NR++fn5MWfOnDjssMOiX79+cdlll0XdunXjpZdeipNOOimWL1+e7VuzZs3IZDIb7ZgqmtAIAAAA2CL94Q9/iL/85S/x2WefxUEHHRTNmzePiIjdd989Pvjgg/jZz3622v2mTZsWK1asiOuuuy6qVft+uegHH3xwo9W9sQiNAAAAgC3Sb3/72/jjH/8Yw4cPj1GjRmXbL7zwwjjiiCOiefPm0bt376hWrVq8+eab8dZbb8X//d//Rdu2bWPFihVx0003Ra9eveLll1+OYcOGVeKRbBiengYAAABskQoKCuJXv/pVbL311nHUUUdl23v27BlPPvlkjB8/PvbYY4/Ya6+94vrrr4+WLVtGRMRuu+0W119/fVx11VWx8847x7333htDhw6tpKPYcDw9bTU8PQ0AAAA2jsp6etoqBx98cOy4445x4403bvTP3lA8PQ0AAACgnL788ssYN25cPP/883HzzTdXdjmbJKERAAAAsMXZfffd46uvvoqrrroq2rVrV9nlbJKERgAAAMAWZ/bs2ZVdwibPQtgAAAAApAiNAAAAAEgRGgEAAACQIjQCAAAAIEVoBAAAAECK0AgAAACAFKERAAAAAClCIwAAAIAyGjp0aOyxxx5Ru3btaNCgQRx11FHxwQcflOqTJElcfPHF0aRJk6hZs2Z069Yt3nnnnez2L7/8Ms4888xo165dbLXVVtGiRYsYMGBALFy4cLWfuXTp0thtt90ik8nEjBkzNuThRYTQCAAAAKDMJk2aFKeffnq88sorMX78+FixYkX06NEjFi1alO1z9dVXx/XXXx8333xzvPbaa9GoUaM4+OCD45tvvomIiM8//zw+//zzuPbaa+Ott96Ku+++O55++uk46aSTVvuZgwYNiiZNmmyU44uIyCRJkmy0T6siiouLo7CwMBYuXBgFBQWVXQ4AAABstpYsWRKzZs2K1q1bR35+fkR8f4VOJCs3fjGZapHJZMq16xdffBENGjSISZMmxX777RdJkkSTJk3i7LPPjsGDB0fE91cKNWzYMK666qo49dRTVzvOQw89FL/73e9i0aJFkZOTk21/6qmnYuDAgTF69OjYaaedYvr06bHbbrutdozVfaerlCXzyFnrVgAAAICNLVkZX709faN/bJ2dO0Zkqpdr31W3lNWtWzciImbNmhVFRUXRo0ePbJ+8vLzYf//9Y/LkyWsMjVaFOT8MjP773//GySefHI899lhstdVW5aqvPNyeBgAAALAekiSJgQMHxj777BM777xzREQUFRVFRETDhg1L9W3YsGF2248tWLAgLrvsslKBUpIk0bdv3+jX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yM3NzbZdc801cdlll8XTTz8dnTt33thlAgAAAFR5lRoaffvttzFjxoyYMWNGRETMmjUrZsyYEZ988klEfH/b2A+feNavX7+YM2dODBw4MN57770YOXJkjBgxIv74xz9m+1x99dVx/vnnx8iRI6NVq1ZRVFQURUVF8e23327UYwMAAACoyjLJqkWBKsHEiROje/fuqfY+ffrE3XffHX379o3Zs2fHxIkTs9smTZoU55xzTrzzzjvRpEmTGDx4cPTr1y+7vVWrVjFnzpzUmBdddFFcfPHF61RXWR4/BwAAAFBVlCXzqNTQaFMlNAIAAAA2R2XJPKrUmkYAAAAAbBxCIwAAAABShEYAAAAApAiNAAAAAEgRGgEAAACQIjQCAAAAIEVoBAAAAECK0AgAAACAFKERAAAAAClCIwAAAABShEYAAAAApAiNAAAAAEgRGgEAAACQIjQCAAAAIEVoBAAAAECK0AgAAACAFKERAAAAAClCIwAAAABShEYAAAAApAiNAAAAAEgRGgEAAACQIjQCAAAAIEVoBAAAAECK0AgAAACAFKERAAAAAClCIwAAAABShEYAAAAApAiNAAAAAEgRGgEAAACQIjQCAAAAIEVoBAAAAECK0AgAAACAFKERAAAAAClCIwAAAABShEYAAAAApAiNAAAAAEgRGgEAAACQIjQCAAAAIEVoBAAAAECK0AgAAACAFKERAAAAAClCIwAAAABShEYAAAAApAiNAAAAAEgRGgEAAACQIjQCAAAAIEVoBAAAAECK0AgAAACAFKERAAAAACnlCo0OOOCA+Prrr1PtxcXFccABB6xvTQAAAABUsnKFRhMnToxly5al2pcsWRIvvvjiehcFAAAAQOXKKUvnN998M/vP7777bhQVFWXfl5SUxNNPPx1NmzatuOoAAAAAqBRlCo122223yGQykclkVnsbWs2aNeOmm26qsOIAAAAAqBxlCo1mzZoVSZJEmzZtYurUqVG/fv3stho1akSDBg2ievXqFV4kAAAAABtXmUKjli1bRkTEypUrN0gxAAAAAGwayhQa/dCHH34YEydOjHnz5qVCpAsvvHC9CwMAAACg8pQrNBo+fHicdtppUa9evWjUqFFkMpnstkwmIzQCAAAAqOLKFRr93//9X1x++eUxePDgiq4HAAAAgE1AtfLs9NVXX0Xv3r0ruhYAAAAANhHl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FRqVlJTE1KlTY9KkSTFx4sSYPHlyLFmyJHbffffo1q1bXHnlleUuflMgNAIAAAA2Rxs8NPqxt99+O6699tq49957Y+XKlVFSUrK+Q1YqoREAAACwOSpL5lGup6e999572auMJk2aFCUlJbHPPvvEddddF/vvv3+5igYAAABg01Gu0GinnXaK+vXrx9lnnx0XXHBB7LTTThVdFwAAAACVqFxPTxswYEA0bdo0Lr744vj9738fgwcPjqeeeiq+/fbbiq4PAAAAgEqwXmsaff311/Hiiy/GpEmTYtKkSfHWW2/FbrvtFq+88kpF1rjRWdMIAAAA2ByVJfMo15VGq6xcuTJWrFgRy5Yti6VLl8by5ctj9uzZ6zMkAAAAAJuAcoVGZ511VnTo0CEaNGgQp556anz++edxyimnxMyZM6OoqKiiawQAAABgIyvXQtifffZZnHzyydGtW7fYeeedK7omAAAAACpZuUKjhx9+uKLrAAAAAGATUu41je65557o2rVrNGnSJObMmRMREX/961/j8ccfr7DiAAAAAKgc5QqNbrvtthg4cGAcdthh8fXXX0dJSUlERGyzzTbx17/+tSLrAwAAAKASlCs0uummm2L48OHx5z//OapXr55t79y5c7z11lsVVhwAAAAAlaNcodGsWbOiY8eOqfa8vLxYtGjRehcFAAAAQOUqV2jUunXrmDFjRqr9qaeeivbt269vTQAAAABUsnI9Pe1///d/4/TTT48lS5ZEkiQxderUuO+++2Lo0KFx5513VnSNAAAAAGxk5QqNTjzxxFixYkUMGjQoFi9eHL/5zW+iadOmccMNN8Rxxx1X0TUCAAAAsJFlkiRJ1meA+fPnx8qVK6NBgwYVVVOlKy4ujsLCwli4cGEUFBRUdjkAAAAAFaIsmUe5rjT6oXr16q3vEAAAAABsYtY5NNp9993jueeeizp16kTHjh0jk8msse8bb7xRIcUBAAAAUDnWOTT6xS9+EXl5edl/XltoBAAAAEDVtt5rGm2OrGkEAAAAbI7KknlUK88HnHjiifHcc8+FvAkAAABg81Su0GjBggVx+OGHR7NmzeLcc8+NGTNmVHBZAAAAAFSmcoVGY8aMiaKiorjooovi9ddfj06dOkX79u3jiiuuiNmzZ1dwiQAAAABsbBWyptF//vOfuO+++2LkyJHxr3/9K1asWFERtVUaaxoBAAAAm6MNvqbRDy1fvjymTZsWr776asyePTsaNmy4vkMCAAAAUMnKHRpNmDAhTj755GjYsGH06dMnateuHU888UR8+umnFVkfAAAAAJUgpzw7NWvWLBYsWBA9e/aM22+/PXr16hX5+fkVXRsAAAAAlaRcodGFF14YvXv3jjp16lR0PQAAAABsAsp1e9opp5wSderUiY8++iieeeaZ+O677yIiogLW1AYAAABgE1Cu0GjBggVx4IEHxvbbbx+HHXZYzJ07NyIi/vCHP8S5555boQUCAAAAsPGVKzQ655xzIjc3Nz755JPYaqutsu3HHntsPP300xVWHAAAAACVo1xrGo0bNy6eeeaZaNasWan27bbbLubMmVMhhQEAAABQecp1pdGiRYtKXWG0yvz58yMvL2+9iwIAAACgcpUrNNpvv/1i1KhR2feZTCZWrlwZ11xzTXTv3r3CigMAAACgcpTr9rRrr7029t9//5g2bVosW7YsBg0aFO+88058+eWX8fLLL1d0jQAAAABsZGW+0mj58uXRv3//GDNmTPz85z+Pgw8+OBYtWhRHH310TJ8+Pdq2bbsh6gQAAABgIyrzlUa5ubnx9ttvx7bbbhuXXHLJhqgJAAAAgEpWrjWNTjjhhBgxYkRF1wIAAADAJqJcaxotW7Ys7rzzzhg/fnx07tw5atWqVWr79ddfXyHFAQAAAFA5yhUavf3227H77rtHRMSHH35Yalsmk1n/qgAAAACoVOUKjSZMmFDRdQAAAACwCSnXmkYAAAAAbN6ERgAAAACkCI0AAAAASBEaAQAAAJAiNAIAAAAgRWgEAAAAQIrQCAAAAIAUoREAAAAAKUIjAAAAAFKERgAAAACkCI0AAAAASBEaAQAAAJAiNAIAAAAgRWgEAAAAQIrQCAAAAIAUoREAAAAAKUIjAAAAAFKERgAAAACkCI0AAAAASBEaAQAAAJAiNAIAAAAgRWgEAAAAQIrQCAAAAIAUoREAAAAAKUIjAAAAAFKERgAAAACkCI0AAAAASBEaAQAAAJAiNAIAAAAgRWgEAAAAQIrQCAAAAIAUoREAAAAAKUIjAAAAAFKERgAAAACkCI0AAAAASBEaAQAAAJAiNAIAAAAgRWgEAAAAQIrQCAAAAIAUoREAAAAAKUIjAAAAAFKERgAAAACkCI0AAAAASBEaAQAAAJAiNAIAAAAgZZMIjW699dZo3bp15OfnR6dOneLFF19ca/9bbrkldtxxx6hZs2a0a9cuRo0alerz17/+Ndq1axc1a9aM5s2bxznnnBNLlizZUIcAAAAAsFnJqewCHnjggTj77LPj1ltvja5du8btt98ehx56aLz77rvRokWLVP/bbrsthgwZEsOHD4899tgjpk6dGieffHLUqVMnevXqFRER9957b5x33nkxcuTI2HvvvePDDz+Mvn37RkTEX/7yl415eAAAAABVUiZJkqQyC9hzzz1j9913j9tuuy3btuOOO8ZRRx0VQ4cOTfXfe++9o2vXrnHNNddk284+++yYNm1avPTSSxERccYZZ8R7770Xzz33XLbPueeeG1OnTv3Jq5giIoqLi6OwsDAWLlwYBQUF63N4AAAAAJuMsmQelXp72rJly+L111+PHj16lGrv0aNHTJ48ebX7LF26NPLz80u11axZM6ZOnRrLly+PiIh99tknXn/99Zg6dWpERHz88ccxduzYOPzww9c4ZnFxcakXAAAAwJasUkOj+fPnR0lJSTRs2LBUe8OGDaOoqGi1+/Ts2TPuvPPOeP311yNJkpg2bVqMHDkyli9fHvPnz4+IiOOOOy4uu+yy2GeffSI3Nzfatm0b3bt3j/POO2+1Yw4dOjQKCwuzr+bNm1fsgQIAAABUMZvEQtiZTKbU+yRJUm2rXHDBBXHooYfGXnvtFbm5ufGLX/wiu15R9erVIyJi4sSJcfnll8ett94ab7zxRjzyyCPx5JNPxmWXXbbaMYcMGRILFy7Mvj799NOKOzgAAACAKqhSQ6N69epF9erVU1cVzZs3L3X10So1a9aMkSNHxuLFi2P27NnxySefRKtWraJ27dpRr169iPg+WDr++OPjD3/4Q+yyyy7xy1/+Mq644ooYOnRorFy5MjVmXl5eFBQUlHoBAAAAbMkqNTSqUaNGdOrUKcaPH1+qffz48bH33nuvdd/c3Nxo1qxZVK9ePe6///444ogjolq17w9n8eLF2X9epXr16pEkSVTyut8AAAAAVUJOZRcwcODAOP7446Nz587RpUuXuOOOO+KTTz6Jfv36RcT3t4599tlnMWrUqIiI+PDDD2Pq1Kmx5557xldffRXXX399vP322/G3v/0tO2avXr3i+uuvj44dO8aee+4ZH330UVxwwQVx5JFHZm9hAwAAAGDNKj00OvbYY2PBggVx6aWXxty5c2PnnXeOsWPHRsuWLSMiYu7cufHJJ59k+5eUlMR1110XH3zwQeTm5kb37t1j8uTJ0apVq2yf888/PzKZTJx//vnx2WefRf369aNXr15x+eWXb+zDAwAAAKiSMon7tVKKi4ujsLAwFi5caH0jAAAAYLNRlsxjk3h6GgAAAACbFqERAAAAAClCIwAAAABShEYAAAAApAiNAAAAAEgRGgEAAACQIjQCAAAAIEVoBAAAAECK0AgAAACAFKERAAAAAClCIwAAAABShEYAAAAApAiNAAAAAEgRGgEAAACQIjQCAAAAIEVoBAAAAECK0AgAAACAFKERAAAAAClCIwAAAABShEYAAAAApAiNAAAAAEgRGgEAAACQIjQCAAAAIEVoBAAAAECK0AgAAACAFKERAAAAAClCIwAAAABShEYAAAAApAiNAAAAAEgRGgEAAACQIjQCAAAAIEVoBAAAAECK0AgAAACAFKERAAAAAClCIwAAAABShEYAAAAApAiNAAAAAEgRGgEAAACQIjQCAAAAIEVoBAAAAECK0AgAAACAFKERAAAAAClCIwAAAABShEYAAAAApAiNAAAAAEgRGgEAAACQIjQCAAAAIEVoBAAAAECK0AgAAACAFKERAAAAAClCIwAAAABShEYAAAAApAiNAAAAAEgRGgEAAACQIjQCAAAAIEVoBAAAAECK0AgAAACAFKERAAAAAClCIwAAAABShEYAAAAApAiNAAAAAEgRGgEAAACQIjQCAAAAIEVoBAAAAECK0AgAAACAFKERAAAAAClCIwAAAABShEYAAAAApAiNAAAAAEgRGgEAAACQIjQCAAAAIEVoBAAAAECK0AgAAACAFKERAAAAAClCIwAAAABShEYAAAAApAiNAAAAAEgRGgEAAACQIjQCAAAAIEVoBAAAAECK0AgAAACAFKERAAAAAClCIwAAAABShEYAAAAApAiNAAAAAEgRGgEAAACQIjQCAAAAIGWTCI1uvfXWaN26deTn50enTp3ixRdfXGv/W265JXbccceoWbNmtGvXLkaNGpXq8/XXX8fpp58ejRs3jvz8/Nhxxx1j7NixG+oQAAAAADYrOZVdwAMPPBBnn3123HrrrdG1a9e4/fbb49BDD4133303WrRokep/2223xZAhQ2L48OGxxx57xNSpU+Pkk0+OOnXqRK9evSIiYtmyZXHwwQdHgwYN4uGHH45mzZrFp59+GrVr197YhwcAAABQJWWSJEkqs4A999wzdt9997jtttuybTvuuGMcddRRMXTo0FT/vffeO7p27RrXXHNNtu3ss8+OadOmxUsvvRQREcOGDYtrrrkm3n///cjNzS1zTcXFxVFYWBgLFy6MgoKCchwVAAAAwKanLJlHpd6etmzZsnj99dejR48epdp79OgRkydPXu0+S5cujfz8/FJtNWvWjKlTp8by5csjImLMmDHRpUuXOP3006Nhw4ax8847xxVXXBElJSVrHLO4uLjUCwAAAGBLVqmh0fz586OkpCQaNmxYqr1hw4ZRVFS02n169uwZd955Z7z++uuRJElMmzYtRo4cGcuXL4/58+dHRMTHH38cDz/8cJSUlMTYsWPj/PPPj+uuuy4uv/zy1Y45dOjQKCwszL6aN29esQcKAAAAUMVsEgthZzKZUu+TJEm1rXLBBRfEoYceGnvttVfk5ubGL37xi+jbt29ERFSvXj0iIlauXBkNGjSIO+64Izp16hTHHXdc/PnPfy51C9wPDRkyJBYuXJh9ffrppxV3cAAAAABVUKWGRvXq1Yvq1aunriqaN29e6uqjVWrWrBkjR46MxYsXx+zZs+OTTz6JVq1aRe3ataNevXoREdG4cePYfvvtsyFSxPfrJBUVFcWyZctSY+bl5UVBQUGpFwAAAMCWrFJDoxo1akSnTp1i/PjxpdrHjx8fe++991r3zc3NjWbNmkX16tXj/vvvjyOOOCKqVfv+cLp27RofffRRrFy5Mtv/ww8/jMaNG0eNGjUq/kAAAAAANjOVfnvawIED484774yRI0fGe++9F+ecc0588skn0a9fv4j4/taxE044Idv/ww8/jL///e/xr3/9K6ZOnRrHHXdcvP3223HFFVdk+5x22mmxYMGCOOuss+LDDz+Mf/7zn3HFFVfE6aefvtGPDwAAAKAqyqnsAo499thYsGBBXHrppTF37tzYeeedY+zYsdGyZcuIiJg7d2588skn2f4lJSVx3XXXxQcffBC5ubnRvXv3mDx5crRq1Srbp3nz5jFu3Lg455xzYtddd42mTZvGWWedFYMHD97YhwcAAABQJWWSJEkqu4hNTXFxcRQWFsbChQutbwQAAABsNsqSeVT67WkAAAAAbHqERgAAAACkCI0AAAAA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yWQypd4nSZJqX12fH7dRddx3331x8cUXx+OPPx4NGjTItu+1116x1157Zd937do1dt9997jpppvixhtvrIxSKYd27dpFu3btsu+7dOkSn376aVx77bWx3377Zdv9rjc/d999d2yzzTZx1FFHlWr32960nXHGGfHmm2/GSy+99JN9nbOrvrLM9yrO21XTus6183bVV57ftXN21dOuXbuYMWNGfP311zF69Ojo06dPTJo0aY3B0ZZ2znal0WaqUaNGqSRz3rx5kZOTE9tuu+1a+/w4FaVqeOCBB+Kkk06KBx98MA466KC19q1WrVrsscce/p+NzcBee+1Vah79rjc/SZLEyJEj4/jjj48aNWqsta/f9qbjzDPPjDFjxsSECROiWbNma+3rnF31lWW+V3HerprKM9c/5LxddZRnrp2zq6YaNWrEz372s+jcuXMMHTo0OnToEDfccMNq+26J52yh0WaqS5cuMX78+FJt48aNi86dO0dubu5a++y9994brU4qxn333Rd9+/aNf/zjH3H44Yf/ZP8kSWLGjBnRuHHjjVAdG9L06dNLzaPf9eZn0qRJ8dFHH8VJJ530k339titfkiRxxhlnxCOPPBLPP/98tG7d+if3cc6uusoz3xHO21VReef6x5y3N33rM9fO2ZuHJEli6dKlq922RZ6zN+Ki26yHb775Jpk+fXoyffr0JCKS66+/Ppk+fXoyZ86cJEmS5LzzzkuOP/74bP+PP/442WqrrZJzzjkneffdd5MRI0Ykubm5ycMPP5zt8/LLLyfVq1dPrrzyyuS9995LrrzyyiQnJyd55ZVXNvrx8f+Uda7/8Y9/JDk5Ocktt9ySzJ07N/v6+uuvs30uvvji5Omnn07+/e9/J9OnT09OPPHEJCcnJ3n11Vc3+vHx/5R1rv/yl78kjz76aPLhhx8mb7/9dnLeeeclEZGMHj0628fvetNV1vle5Xe/+12y5557rnZMv+1Nz2mnnZYUFhYmEydOLPXv5MWLF2f7OGdvPsoz387bVVN55tp5u2oqz1yv4pxd9QwZMiR54YUXklmzZiVvvvlm8qc//SmpVq1aMm7cuCRJnLOTJEmERlXEqkd2/vjVp0+fJEmSpE+fPsn+++9fap+JEycmHTt2TGrUqJG0atUque2221LjPvTQQ0m7du2S3NzcZIcddih1EqNylHWu999//7X2T5IkOfvss5MWLVokNWrUSOrXr5/06NEjmTx58sY9MFLKOtdXXXVV0rZt2yQ/Pz+pU6dOss8++yT//Oc/U+P6XW+ayvPv8a+//jqpWbNmcscdd6x2TL/tTc/q5jgikrvuuivbxzl781Ge+XberprKM9fO21VTef897pxdNf3+979PWrZsmZ2XAw88MBsYJYlzdpIkSSZJ/v9VmwAAAADg/2dNIwAAAABShEYAAAAApAiNAAAAAEgRGgEAAACQIjQCAAAAIEVoBAAAAECK0AgAAACAFKERAAAAAClCIwCAKuziiy+O3XbbrbLLAAA2Q0IjAIAqIpPJxGOPPVbZZQAAWwihEQAAAAApQiMAgDLq1q1bnHnmmXH22WdHnTp1omHDhnHHHXfEokWL4sQTT4zatWtH27Zt46mnnsruM2nSpPj5z38eeXl50bhx4zjvvPNixYoVpcYcMGBADBo0KOrWrRuNGjWKiy++OLu9VatWERHxy1/+MjKZTPb9Kvfcc0+0atUqCgsL47jjjotvvvlmQ34FAMAWQGgEAFAOf/vb36JevXoxderUOPPMM+O0006L3r17x9577x1vvPFG9OzZM44//vhYvHhxfPbZZ3HYYYfFHnvsETNnzozbbrstRowYEf/3f/+XGrNWrVrx6quvxtVXXx2XXnppjB8/PiIiXnvttYiIuOuuu2Lu3LnZ9xER//73v+Oxxx6LJ598Mp588smYNGlSXHnllRvvywAANkuZJEmSyi4CAKAq6datW5SUlMSLL74YERElJSVRWFgYRx99dIwaNSoiIoqKiqJx48YxZcqUeOKJJ2L06NHx3nvvRSaTiYiIW2+9NQYPHhwLFy6MatWqpcaMiPj5z38eBxxwQDYAymQy8eijj8ZRRx2V7XPxxRfHNddcE0VFRVG7du2IiBg0aFC88MIL8corr2yMrwMA2Ey50ggAoBx23XXX7D9Xr149tt1229hll12ybQ0bNoyIiHnz5sV7770XXbp0yQZGERFdu3aNb7/9Nv7zn/+sdsyIiMaNG8e8efN+spZWrVplA6Oy7AcAsDZCIwCAcsjNzS31PpPJlGpbFRCtXLkykiQpFRhFRKy62PuH7asbc+XKleWqZV32AwBYG6ERAMAG1r59+5g8eXL8cFWAyZMnR+3ataNp06brPE5ubm6UlJRsiBIBAFKERgAAG1j//v3j008/jTPPPDPef//9ePzxx+Oiiy6KgQMHRrVq6/4/x1q1ahXPPfdcFBUVxVdffbUBKwYAEBoBAGxwTZs2jbFjx8bUqVOjQ4cO0a9fvzjppJPi/PPPL9M41113XYwfPz6aN28eHTt23EDVAgB8z9PTAAAAAEhxpREAAAAAKUIjAAAAAFKERgAAAACkCI0AAAAASBEaAQAAAJAiNAIAAAAgRWgEAAAAQIrQCAAAAIAUoREAAAAAKUIjAAAAAFKERgAAAACk/H9wIZVIVO3UTgAAAABJRU5ErkJggg==",
      "text/plain": [
       "<Figure size 1400x700 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure(figsize=(14, 7))\n",
    "sns.lineplot(x='month', y='review_count', hue='year', data=monthly_reviews)\n",
    "plt.title('Monthly Review Count by Year')\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 108,
   "id": "60d296f2-e84e-41c0-84bc-6ec45d72d4d4",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'city'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[108], line 2\u001b[0m\n\u001b[0;32m      1\u001b[0m listings[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mvalue\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m listings[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m/\u001b[39m listings[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mnumber_of_reviews\u001b[39m\u001b[38;5;124m'\u001b[39m]\n\u001b[1;32m----> 2\u001b[0m value_by_city \u001b[38;5;241m=\u001b[39m listings\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcity\u001b[39m\u001b[38;5;124m'\u001b[39m)[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mvalue\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mmean()\u001b[38;5;241m.\u001b[39mreset_index()\n\u001b[0;32m      3\u001b[0m value_by_city\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:9183\u001b[0m, in \u001b[0;36mDataFrame.groupby\u001b[1;34m(self, by, axis, level, as_index, sort, group_keys, observed, dropna)\u001b[0m\n\u001b[0;32m   9180\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m level \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m by \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   9181\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mYou have to supply one of \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mby\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m and \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlevel\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m-> 9183\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m DataFrameGroupBy(\n\u001b[0;32m   9184\u001b[0m     obj\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m,\n\u001b[0;32m   9185\u001b[0m     keys\u001b[38;5;241m=\u001b[39mby,\n\u001b[0;32m   9186\u001b[0m     axis\u001b[38;5;241m=\u001b[39maxis,\n\u001b[0;32m   9187\u001b[0m     level\u001b[38;5;241m=\u001b[39mlevel,\n\u001b[0;32m   9188\u001b[0m     as_index\u001b[38;5;241m=\u001b[39mas_index,\n\u001b[0;32m   9189\u001b[0m     sort\u001b[38;5;241m=\u001b[39msort,\n\u001b[0;32m   9190\u001b[0m     group_keys\u001b[38;5;241m=\u001b[39mgroup_keys,\n\u001b[0;32m   9191\u001b[0m     observed\u001b[38;5;241m=\u001b[39mobserved,\n\u001b[0;32m   9192\u001b[0m     dropna\u001b[38;5;241m=\u001b[39mdropna,\n\u001b[0;32m   9193\u001b[0m )\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\groupby.py:1329\u001b[0m, in \u001b[0;36mGroupBy.__init__\u001b[1;34m(self, obj, keys, axis, level, grouper, exclusions, selection, as_index, sort, group_keys, observed, dropna)\u001b[0m\n\u001b[0;32m   1326\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdropna \u001b[38;5;241m=\u001b[39m dropna\n\u001b[0;32m   1328\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m grouper \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m-> 1329\u001b[0m     grouper, exclusions, obj \u001b[38;5;241m=\u001b[39m get_grouper(\n\u001b[0;32m   1330\u001b[0m         obj,\n\u001b[0;32m   1331\u001b[0m         keys,\n\u001b[0;32m   1332\u001b[0m         axis\u001b[38;5;241m=\u001b[39maxis,\n\u001b[0;32m   1333\u001b[0m         level\u001b[38;5;241m=\u001b[39mlevel,\n\u001b[0;32m   1334\u001b[0m         sort\u001b[38;5;241m=\u001b[39msort,\n\u001b[0;32m   1335\u001b[0m         observed\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m \u001b[38;5;28;01mif\u001b[39;00m observed \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default \u001b[38;5;28;01melse\u001b[39;00m observed,\n\u001b[0;32m   1336\u001b[0m         dropna\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdropna,\n\u001b[0;32m   1337\u001b[0m     )\n\u001b[0;32m   1339\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m observed \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default:\n\u001b[0;32m   1340\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28many\u001b[39m(ping\u001b[38;5;241m.\u001b[39m_passed_categorical \u001b[38;5;28;01mfor\u001b[39;00m ping \u001b[38;5;129;01min\u001b[39;00m grouper\u001b[38;5;241m.\u001b[39mgroupings):\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\grouper.py:1043\u001b[0m, in \u001b[0;36mget_grouper\u001b[1;34m(obj, key, axis, level, sort, observed, validate, dropna)\u001b[0m\n\u001b[0;32m   1041\u001b[0m         in_axis, level, gpr \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mFalse\u001b[39;00m, gpr, \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[0;32m   1042\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m-> 1043\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(gpr)\n\u001b[0;32m   1044\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(gpr, Grouper) \u001b[38;5;129;01mand\u001b[39;00m gpr\u001b[38;5;241m.\u001b[39mkey \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   1045\u001b[0m     \u001b[38;5;66;03m# Add key to exclusions\u001b[39;00m\n\u001b[0;32m   1046\u001b[0m     exclusions\u001b[38;5;241m.\u001b[39madd(gpr\u001b[38;5;241m.\u001b[39mkey)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'city'"
     ]
    }
   ],
   "source": [
    "listings['value'] = listings['price'] / listings['number_of_reviews']\n",
    "value_by_city = listings.groupby('city')['value'].mean().reset_index()\n",
    "value_by_city\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 110,
   "id": "722edd9d-96fc-4528-bcd3-b3c26471aaf5",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['accommodates', 'bedrooms', 'bathrooms', 'number_of_reviews',\n",
      "       'review_scores_rating', 'price', 'value'],\n",
      "      dtype='object')\n"
     ]
    }
   ],
   "source": [
    "print(listings.columns)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 112,
   "id": "5f899cdb-a1a1-4b09-af4d-fdd75cb3a98b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   accommodates  bedrooms  bathrooms  number_of_reviews  review_scores_rating  \\\n",
      "0             1         1          1                 10                   8.5   \n",
      "1             2         2          1                 15                   9.0   \n",
      "2             3         1          1                  5                   7.5   \n",
      "3             4         3          2                 20                   8.0   \n",
      "\n",
      "   price  value  \n",
      "0    100   10.0  \n",
      "1    150   10.0  \n",
      "2    200   40.0  \n",
      "3    250   12.5  \n"
     ]
    }
   ],
   "source": [
    "print(listings.head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 114,
   "id": "16b72b52-106b-47d6-8f0d-e7b1a5fdce06",
   "metadata": {},
   "outputs": [],
   "source": [
    "listings.rename(columns={'city_name': 'city'}, inplace=True)  # Example renaming\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 116,
   "id": "45d3e4c4-07fb-43a6-843d-47b1839f11ec",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Columns in DataFrame: Index(['city', 'price', 'number_of_reviews'], dtype='object')\n",
      "DataFrame head:\n",
      "           city  price  number_of_reviews\n",
      "0     New York    100                 10\n",
      "1  Los Angeles    150                  5\n",
      "2      Chicago    200                 20\n",
      "Value by city:\n",
      "           city  value\n",
      "0      Chicago   10.0\n",
      "1  Los Angeles   30.0\n",
      "2     New York   10.0\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Example DataFrame creation (replace with your actual data loading process)\n",
    "data = {\n",
    "    'city': ['New York', 'Los Angeles', 'Chicago'],  # Ensure 'city' is the correct column name\n",
    "    'price': [100, 150, 200],\n",
    "    'number_of_reviews': [10, 5, 20]\n",
    "}\n",
    "listings = pd.DataFrame(data)\n",
    "\n",
    "# Verify the column names\n",
    "print(\"Columns in DataFrame:\", listings.columns)\n",
    "\n",
    "# Verify the DataFrame contents\n",
    "print(\"DataFrame head:\\n\", listings.head())\n",
    "\n",
    "# Calculate the value column\n",
    "listings['value'] = listings['price'] / listings['number_of_reviews']\n",
    "\n",
    "# Group by 'city' and calculate the mean of 'value'\n",
    "value_by_city = listings.groupby('city')['value'].mean().reset_index()\n",
    "print(\"Value by city:\\n\", value_by_city)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 118,
   "id": "533731cd-274f-4b6e-9645-295edd5c54d5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA+UAAAIhCAYAAAAozRucAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjguNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8fJSN1AAAACXBIWXMAAA9hAAAPYQGoP6dpAABARklEQVR4nO3de/zXg/3///ur0rvoQKWTWp+Qs/jIMU2FpE3kNBNTTrNJDvFx3Kx8RtiYGWN8Em1On69hjtFQTDm1kSWGlWyKCR0sb9Tz94ef92fvlRTVM3W9Xi6vy2Wv5/P5er4e79fsObf38/l6vitFURQBAAAAVro6ZQ8AAAAAaypRDgAAACUR5QAAAFASUQ4AAAAlEeUAAABQElEOAAAAJRHlAAAAUBJRDgAAACUR5QAAAFASUQ7AV9rll1+eSqWSrbbaquxRVhn/+Mc/Ur9+/Xz729/+zG3mzJmTtddeO/vuu+9S7/f6669PpVLJtGnTlsOUy6ZHjx4r7b/j6urqXHHFFenWrVvWW2+91K9fPxtssEG+9a1vZdy4cTXbjR07NpVKJWPHjq1Zdt9992Xo0KErZU4AVg+iHICvtOuuuy5JMnny5Dz55JMlT7NqWH/99bPvvvvmzjvvzLvvvrvYbW655ZbMnz8/Rx999EqebtX29ttvZ9ddd82QIUOy1VZb5frrr89DDz2USy65JHXr1s0ee+yR5557Lkmy3XbbZcKECdluu+1qXn/fffdl2LBhZY0PwFeQKAfgK+uZZ57Jc889l29+85tJkhEjRqz0GYqiyPz581f6+36eo48+OtXV1bnxxhsXu/66665Lq1ataj47PnHEEUfkueeey+jRo3P11Vdnv/32y9e//vV8+9vfzs0335wJEyZkvfXWS5I0adIkO++8c5o0aVLy1AB8lYlyAL6yPo3wCy+8MF27ds0tt9ySf/7zn0mSjz76KC1btsx3vvOdRV733nvvpWHDhhkyZEjNsjlz5uS0005Lx44day5XPvnkk/P+++/Xem2lUskJJ5yQq6++Optvvnmqqqpyww03JEmGDRuWnXbaKc2aNUuTJk2y3XbbZcSIESmKotY+qqurc+qpp6Z169ZZe+21s9tuu2XixIn5j//4jwwcOLDWtjNnzsxxxx2Xdu3apX79+unYsWOGDRuWjz/+eImfTe/evdOuXbuMHDlykXVTpkzJk08+mSOOOCL16tXLmDFjst9++6Vdu3Zp0KBBNt544xx33HF5++23l/geSRY7c/LJ5eY9evSotWxpP+Mleeyxx7LzzjunYcOG2WCDDfLDH/4wCxYsSPLJL0g6deqU3r17L/K6efPmpWnTphk0aNBn7nvixIm5//77c/TRR2f33Xdf7DY77LBDvva1ryVZ9PL1gQMH5sorr0zyyT8nnz6mTZuWPfbYI5ttttki/ywURZGNN97YL0cA1mD1yh4AAL6I+fPn5+abb84OO+yQrbbaKkcddVSOOeaY/L//9/8yYMCArLXWWjn88MNz9dVX58orr6x1NvPmm2/OBx98kCOPPDJJ8s9//jPdu3fP3/72t5x99tnp3LlzJk+enHPPPTfPP/98fv/736dSqdS8/s4778xjjz2Wc889N61bt07Lli2TJNOmTctxxx1XE21PPPFEBg8enL///e8599xza15/5JFH5tZbb83pp5+e3XffPS+88EL233//zJkzp9bPOHPmzOy4446pU6dOzj333Gy00UaZMGFCfvzjH2fatGmLDe5P1alTJwMHDsyPf/zjPPfcc9lmm21q1n36uqOOOipJ8uqrr2aXXXbJMccck6ZNm2batGm59NJL061btzz//PNZa621vtB/R/9qWT/jxZk5c2a+/e1v58wzz8x5552Xe++9Nz/+8Y/z7rvv5oorrkilUsngwYNz8skn5+WXX06nTp1qXjtq1KjMmTNniVH+4IMPJkn69ev3hX7GH/7wh3n//fdz2223ZcKECTXL27Rpk5NOOin77bdfHnrooey555416+6///68+uqrufzyy7/QewKwGigA4Cto1KhRRZLi6quvLoqiKObOnVs0atSo+PrXv16zzaRJk4okxTXXXFPrtTvuuGPRpUuXmufDhw8v6tSpUzz99NO1trvtttuKJMV9991XsyxJ0bRp0+Kdd95Z4nwLFiwoPvroo+K8884rmjdvXixcuLAoiqKYPHlykaQ444wzam1/8803F0mKAQMG1Cw77rjjikaNGhWvvfZarW1/+tOfFkmKyZMnL3GGv/71r0WlUilOPPHEmmUfffRR0bp162LXXXdd7GsWLlxYfPTRR8Vrr71WJCl+97vf1awbOXJkkaSYOnVqzbIOHTrUmvlT3bt3L7p3717zfFk+48Xp3r37IvMURVEce+yxRZ06dWo+ozlz5hSNGzcuTjrppFrbbbHFFkXPnj2X+B7f+973iiTFiy++uMTtPvXII48USYpHHnmkZtmgQYOKxf3r1YIFC4oNN9yw2G+//Wot79OnT7HRRhvV/PMBwJrH5esAfCWNGDEiDRs2rLnDeKNGjXLwwQfnsccey8svv5wk2XrrrdOlS5daZ5SnTJmSp556quYscZLcc8892WqrrbLtttvm448/rnn07t17kbtrJ8nuu+9e873if/Xwww9nzz33TNOmTVO3bt2stdZaOffcczNr1qy89dZbSVJz9+5vfetbtV570EEHpV692hew3XPPPenZs2fatm1ba64+ffrU2tdn6dixY3r27Jkbb7wxH374YZJPzszOnDmz1s//1ltv5Xvf+17at2+fevXqZa211kqHDh1qPq/lYVk/48Vp3LjxIneL79+/fxYuXJhHH320Zpsjjzwy119/fc1l8Q8//HBeeOGFnHDCCcvlZ/ki6tSpkxNOOCH33HNPpk+fnuSTKxRGjx6d448//nOvEgBg9SXKAfjKeeWVV/Loo4/mm9/8ZoqiyHvvvZf33nsvBx10UJL/uyN78skl2hMmTMiLL76Y5JNLt6uqqnLooYfWbPPmm29m0qRJWWuttWo9GjdunKIoFvludZs2bRaZ6amnnspee+2VJLn22mvz+OOP5+mnn84555yTJDU3g5s1a1aSpFWrVrVeX69evTRv3rzWsjfffDN33333InNtueWWSbJU3/k++uijM2vWrNx11101P3+jRo1qfimwcOHC7LXXXrn99ttz+umn56GHHspTTz2VJ554otbcX9ayfsaL8++fWZK0bt06yf99rkkyePDgzJ07t+Ymd1dccUXatWuX/fbbb4n7//RrB1OnTl3qn2tZHHXUUWnYsGGuvvrqJMmVV16Zhg0b1voFCQBrHt8pB+Ar57rrrktRFLntttty2223LbL+hhtuyI9//OPUrVs3hx56aIYMGZLrr78+559/fn7961+nX79+tc50t2jRIg0bNqwV8/+qRYsWtZ4v7qzmLbfckrXWWiv33HNPGjRoULP8zjvvrLXdp+H95ptvZoMNNqhZ/vHHH9cKy0/ft3Pnzjn//PMXO1fbtm0Xu/xfHXDAAVlvvfVy3XXXpXv37rnnnntyxBFHpFGjRkmSP//5z3nuuedy/fXXZ8CAATWve+WVVz5330nSoEGDVFdXL7L87bffrvW5LetnvDhvvvnmIstmzpyZJLV+obHxxhunT58+ufLKK9OnT5/cddddGTZsWOrWrbvE/ffu3Ttnn3127rzzzuy9996fO8+yatq0aQYMGJD/+Z//yWmnnZaRI0emf//+WXfddZf7ewHw1SHKAfhKWbBgQW644YZstNFG+Z//+Z9F1t9zzz255JJLcv/992efffbJeuutl379+mXUqFHZZZddFrl0O0n22WefXHDBBWnevHk6duz4heaqVCqpV69erfCbP39+fv3rX9fabrfddkuS3HrrrbX+vvVtt922yB3V99lnn9x3333ZaKONFnu5/NJo0KBB+vfvn6uvvjoXXXRRPvroo1o//6e/YKiqqqr1ul/96ldLtf//+I//yKRJk2ot+8tf/pKXXnqpVmgvj8947ty5ueuuu2pdwn7TTTelTp06NZ/rp0466aTstddeGTBgQOrWrZtjjz32c/e/3XbbpU+fPhkxYkS+9a1vLfYO7M8880xatmxZc1b93336Oc6fPz8NGzZcZP2JJ56YX/7ylznooIPy3nvvlXpJPQCrBlEOwFfK/fffnzfeeCMXXXTRIn9yK0m22mqrXHHFFRkxYkT22WefJJ9cNnzrrbfmhBNOSLt27Wrd/TpJTj755Pz2t7/NbrvtllNOOSWdO3fOwoULM3369Dz44IM59dRTs9NOOy1xrm9+85u59NJL079//3z3u9/NrFmz8tOf/nSR2N1yyy1z6KGH5pJLLkndunWz++67Z/LkybnkkkvStGnT1Knzf98sO++88zJmzJh07do1J554YjbddNN88MEHmTZtWu67775cffXVadeu3ed+ZkcffXSuvPLKXHrppdlss83StWvXmnWbbbZZNtpoo5x55pkpiiLNmjXL3XffnTFjxnzufpPkO9/5Tg4//PAcf/zxOfDAA/Paa6/l4osvzvrrr19ru+XxGTdv3jzf//73M3369GyyySa57777cu211+b73//+IpHcq1evbLHFFnnkkUdy+OGH19wh//OMGjUqe++9d/r06ZOjjjoqffr0yXrrrZcZM2bk7rvvzs0335yJEyd+ZpRvvfXWSZKLLrooffr0Sd26ddO5c+fUr18/SbLJJptk7733zv33359u3brVuis+AGuoUm8zBwDLqF+/fkX9+vWLt9566zO3+fa3v13Uq1evmDlzZlEUn9z5un379kWS4pxzzlnsa+bNm1f84Ac/KDbddNOifv36RdOmTYutt966OOWUU2r2UxSf3H190KBBi93HddddV2y66aZFVVVVseGGGxbDhw8vRowYscgdyz/44INiyJAhRcuWLYsGDRoUO++8czFhwoSiadOmxSmnnFJrn//4xz+KE088sejYsWOx1lprFc2aNSu6dOlSnHPOOcW8efOW9mMr/vM//7NIUlx88cWLrHvhhReKXr16FY0bNy7WW2+94uCDDy6mT59eJCl+9KMf1Wy3uLuvL1y4sLj44ouLDTfcsGjQoEGx/fbbFw8//PAid19fls94cbp3715sueWWxdixY4vtt9++qKqqKtq0aVOcffbZxUcffbTY1wwdOrRIUjzxxBNL/TkVRVHMnz+/uPzyy4tddtmlaNKkSVGvXr2ibdu2xQEHHFDce++9Ndst7u7r1dXVxTHHHFOsv/76RaVSWeTzKoqiuP7664skxS233LJMcwGweqoURVGU9QsBAOAT48ePz6677pobb7wx/fv3L3uc1cL222+fSqWSp59+uuxRajnwwAPzxBNPZNq0acvlb8AD8NXm8nUAWMnGjBmTCRMmpEuXLmnYsGGee+65XHjhhenUqVMOOOCAssf7SpszZ07+/Oc/55577snEiRNzxx13lD1SkqS6ujp//OMf89RTT+WOO+7IpZdeKsgBSCLKAWCla9KkSR588MFcdtllmTt3blq0aJE+ffpk+PDhte7czrL74x//mJ49e6Z58+b50Y9+lH79+pU9UpJkxowZ6dq1a5o0aZLjjjsugwcPLnskAFYRLl8HAACAktT5/E0AAACAFUGUAwAAQElEOQAAAJRktb/R28KFC/PGG2+kcePGqVQqZY8DAADAaq4oisydOzdt27ZNnTpLPhe+2kf5G2+8kfbt25c9BgAAAGuY119/Pe3atVviNqt9lDdu3DjJJx9GkyZNSp4GAACA1d2cOXPSvn37mh5dktU+yj+9ZL1JkyaiHAAAgJVmab5C7UZvAAAAUBJRDgAAACUR5QAAAFASUQ4AAAAlEeUAAABQElEOAAAAJRHlAAAAUBJRDgAAACUR5QAAAFASUQ4AAAAlEeUAAABQElEOAAAAJRHlAAAAUBJRDgAAACUR5QAAAFCSUqP8qquuSufOndOkSZM0adIku+yyS+6///6a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2rQURZHttttuRcwIAAAAq6Vlvnz9rLPOyqmnnpo///nPadCgQX7729/m9ddfT/fu3XPwwQcv074effTR9O3bN23btk2lUsmdd95Za/3AgQNTqVRqPXbeeedlHRkAAABWScsc5VOmTMmAAQOSJPXq1cv8+fPTqFGjnHfeebnooouWaV/vv/9+ttlmm1xxxRWfuc3ee++dGTNm1Dzuu+++ZR0ZAAAAVknLfPn6Ouusk+rq6iRJ27Zt8+qrr2bLLbdMkrz99tvLtK8+ffqkT58+S9ymqqoqrVu3XtYxAQAAYJW3zFG+88475/HHH88WW2yRb37zmzn11FPz/PPP5/bbb18hl5aPHTs2LVu2zLrrrpvu3bvn/PPPT8uWLT9z++rq6ppfGiTJnDlzlvtMAAAAsDwsc5RfeumlmTdvXpJk6NChmTdvXm699dZsvPHG+dnPfrZch+vTp08OPvjgdOjQIVOnTs0Pf/jD7L777pk4cWKqqqoW+5rhw4dn2LBhy3UOAAAAWBEqRVEUy/KCI488Mocffnh23333VCqV5TdIpZI77rgj/fr1+8xtZsyYkQ4dOuSWW27JAQccsNhtFnemvH379pk9e3aaNGmy3OYFWFN1+a9RZY8ArCATf3JE2SMArBbmzJmTpk2bLlWHLvON3mbNmpVvfvObadeuXU499dQ8++yzX3TOZdamTZt06NAhL7/88mduU1VVlSZNmtR6AAAAwKpomaP8rrvuysyZM/OjH/0oEydOTJcuXbLFFlvkggsuyLRp01bAiP9n1qxZef3119OmTZsV+j4AAACwMixzlCfJuuuum+9+97sZO3ZsXnvttRx55JH59a9/nY033niZ9jNv3rw8++yzNWfbp06dmmeffTbTp0/PvHnzctppp2XChAmZNm1axo4dm759+6ZFixbZf//9v8jYAAAAsEpZ5hu9/auPPvoozzzzTJ588slMmzYtrVq1WqbXP/PMM+nZs2fN8yFDhiRJBgwYkKuuuirPP/98Ro0alffeey9t2rRJz549c+utt6Zx48ZfZmwAAABYJXyhKH/kkUdy00035be//W0WLFiQAw44IHfffXd23333ZdpPjx49sqT7zD3wwANfZDwAAAD4SljmKG/Xrl1mzZqV3r1751e/+lX69u2bBg0arIjZAAAAYLW2zFF+7rnn5uCDD8566623IuYBAACANcYyR/l3v/vdFTEHAAAArHG+0N3XAQAAgC9PlAMAAEBJRDkAAACURJQDAABASUQ5AAAAlESUAwAAQElEOQAAAJRElAMAAEBJRDkAAACURJQDAABASUQ5AAAAlESUAwAAQElEOQAAAJRElAMAAEBJRDkAAACURJQDAABASUQ5AAAAlESUAwAAQElEOQAAAJRElAMAAEBJRDkAAACURJQDAABASUQ5AAAAlESUAwAAQElEOQAAAJRElAMAAEBJRDkAAACURJQDAABASUQ5AAAAlESUAwAAQElEOQAAAJRElAMAAEBJRDkAAACURJQDAABASUQ5AAAAlESUAwAAQElEOQAAAJRElAMAAEBJRDkAAACURJQDAABASUQ5AAAAlESUAwAAQElEOQAAAJRElAMAAEBJRDkAAACURJQDAABASUQ5AAAAlESUAwAAQElEOQAAAJRElAMAAEBJRDkAAACURJQDAABASUQ5AAAAlESUAwAAQElEOQAAAJRElAMAAEBJRDkAAACURJQDAABASUQ5AAAAlKTUKH/00UfTt2/ftG3bNpVKJXfeeWet9UVRZOjQoWnbtm0aNmyYHj16ZPLkyeUMCwAAAMtZqVH+/vvvZ5tttskVV1yx2PUXX3xxLr300lxxxRV5+umn07p16/Tq1Stz585dyZMCAADA8levzDfv06dP+vTps9h1RVHksssuyznnnJMDDjggSXLDDTekVatWuemmm3LcccetzFEBAABguVtlv1M+derUzJw5M3vttVfNsqqqqnTv3j3jx4//zNdVV1dnzpw5tR4AAACwKir1TPmSzJw5M0nSqlWrWstbtWqV11577TNfN3z48AwbNmyFzrYsuvzXqLJHAFaQiT85ouwRAFgO/PsarL6+Cv++tsqeKf9UpVKp9bwoikWW/auzzjors2fPrnm8/vrrK3pEAAAA+EJW2TPlrVu3TvLJGfM2bdrULH/rrbcWOXv+r6qqqlJVVbXC5wMAAIAva5U9U96xY8e0bt06Y8aMqVn24YcfZty4cenatWuJkwEAAMDyUeqZ8nnz5uWVV16peT516tQ8++yzadasWb72ta/l5JNPzgUXXJBOnTqlU6dOueCCC7L22munf//+JU4NAAAAy0epUf7MM8+kZ8+eNc+HDBmSJBkwYECuv/76nH766Zk/f36OP/74vPvuu9lpp53y4IMP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pVLJnXfe+Znrx44dm0qlkvfee2+lzQSwOhs4cGD69etX9hgAy9X111+fddddt+wx+AoR5awxZs6cmcGDB2fDDTdMVVVV2rdvn759++ahhx5aqtd37do1M2bMSNOmTVfwpMCapKww3WuvvVK3bt088cQTK/29AQYOHJhKpZILL7yw1vI777wzlUplpczwl7/8JWuvvXZuuummWssXLlyYrl27Zv/9918pc4AoZ40wbdq0dOnSJQ8//HAuvvjiPP/88xk9enR69uyZQYMGLdU+6tevn9atW6+0/6MAWFGmT5+eCRMm5IQTTsiIESPKHgdYQzVo0CAXXXRR3n333VLef5NNNsmFF16YwYMHZ8aMGTXLL7nkkrzyyiv51a9+tcz7/Oijj5bniKwhRDlrhOOPPz6VSiVPPfVUDjrooGyyySbZcsstM2TIkFpnid5+++3sv//+WXvttdOpU6fcddddNesWd/n6448/nu7du2fttdfOeuutl969e9f8H8vo0aPTrVu3rLvuumnevHn22WefvPrqq7XmGj9+fLbddts0aNAg22+/fc1vh5999tmabcaNG5cdd9wxVVVVadOmTc4888x8/PHHK+aDAlY5n3cMuO2227L11lunYcOGad68efbcc8+8//77S9znyJEjs88+++T73/9+br311kW279GjR0488cScfvrpadasWVq3bp2hQ4fW2ubFF19Mt27d0qBBg2yxxRb5/e9/v8jXgP7+97/nkEMOyXrrrZfmzZtnv/32y7Rp0z5zrqIocvHFF2fDDTdMw4YNs8022+S2226rWf/uu+/msMMOy/rrr5+GDRumU6dOGTly5Od/iMAqac8990zr1q0zfPjwJW43fvz47LbbbmnYsGHat2+fE088sea49Ytf/CJbb711zbaf/rvUlVdeWbOsd+/eOeussxa778GDB2fbbbfNsccem+STY9u5556ba665Ji1atMh5552Xdu3apaqqKttuu21Gjx5d89pp06alUqnkf//3f9OjR480aNAgv/nNbxZ5j1mzZmXHHXfMvvvumw8++GDpPyDWGKKc1d4777yT0aNHZ9CgQVlnnXUWWf+v3/kZNmxYvvWtb2XSpEn5xje+kcMOOyzvvPPOYvf77LPPZo899siWW26ZCRMm5A9/+EP69u2bBQsWJEnef//9DBkyJE8//XQeeuih1KlTJ/vvv38WLlyYJJk7d2769u2brbfeOn/84x/z3//93znjjDNqvcff//73fOMb38gOO+yQ5557LldddVVGjBiRH//4x8vp0wFWZZ93DJgxY0YOPfTQHHXUUZkyZUrGjh2bAw44IEVRfOY+i6LIyJEjc/jhh2ezzTbLJptskv/93/9dZLsbbrgh66yzTp588slcfPHFOe+88zJmzJgkn1za2a9fv6y99tp58sknc8011+Scc86p9fp//vOf6dmzZxo1apRHH300f/jDH9KoUaPsvffe+fDDDxc72w9+8IOMHDkyV111VSZPnpxTTjklhx9+eMaNG5ck+eEPf5gXXngh999/f6ZMmZKrrroqLVq0+EKfLVC+unXr5oILLsgvfvGL/O1vf1vsNs8//3x69+6dAw44IJMmTcqtt96aP/zhDznhhBOSfPJLxMmTJ+ftt99O8skvMlu0aFFz3Pj4448zfvz4dO/efbH7r1QqGTlyZB577LFce+21GThwYA455JD069cvP//5z3PJJZfkpz/9aSZNmpTevXtn3333zcsvv1xrH2eccUZOPPHETJkyJb1796617m9/+1u+/vWvZ7PNNsvtt9+eBg0afKnPjNVUAau5J598skhS3H777UvcLknxgx/8oOb5vHnzikqlUtx///1FURTFI488UiQp3n333aIoiuLQQw8tdt1116We46233iqSFM8//3xRFEVx1VVXFc2bNy/mz59fs821115bJCn+9Kc/FUVRFGeffXax6aabFgsXLqzZ5sorrywaNWpULFiwYKnfG1h1DRgwoNhvv/0Wu+7zjgETJ04skhTTpk1b6vd78MEHi/XXX7/46KOPiqIoip/97GeLHMu6d+9edOvWrdayHXbYoTjjjDOKoiiK+++/v6hXr14xY8aMmvVjxowpkhR33HFHURRFMWLEiEVmr66uLho2bFg88MADi/zs8+bNKxo0aFCMHz++1vseffTRxaGHHloURVH07du3OPLII5f6ZwVWXf/6v/+dd965OOqoo4qiKIo77rij+NdE+c53vlN897vfrfXaxx57rKhTp04xf/78YuHChUWLFi2K2267rSiKoth2222L4cOHFy1btiyKoijGjx9f1KtXr5g7d+4S57nuuuuKOnXqFO3bty/ee++9oiiKom3btsX5559fa7sddtihOP7444uiKIqpU6cWSYrLLrus1jYjR44smjZtWrz00kvF1772tWLw4MG1joXw75wpZ7VX/P9njJbmu+CdO3eu+c/rrLNOGjdunLfeemux2356pvyzvPrqq+nfv3823HDDNGnSJB07dkzyyXc5k+Sll15K586da/3GdMcdd6y1jylTpmSXXXapNfuuu+6aefPmfeZvlIHVx+cdA7bZZpvsscce2XrrrXPwwQfn2muv/dzvZo4YMSKHHHJI6tWrlyQ59NBD8+STT+all16qtd2/Hg+TpE2bNjXHw5deeint27dP69ata9b/+/Fr4sSJeeWVV9K4ceM0atQojRo1SrNmzfLBBx8s8lWeJHnhhRfywQcfpFevXjXbN2rUKKNGjarZ/vvf/35uueWWbLvttjn99NMzfvz4z/sIga+Aiy66KDfccENeeOGFRdZNnDgx119/fa3jQu/evbNw4cJMnTo1lUolu+22W8aOHZv33nsvkydPzve+970sWLCg5gqi7bbbLo0aNVriDEceeWTatGmTE088MU2bNs2cOXPyxhtvZNddd6213a677popU6bUWrb99tsvsr/58+enW7du6devXy6//HL3JGKJRDmrvU6dOqVSqSxyAF2ctdZaq9bzSqVSc7n5v2vYsOES99W3b9/MmjUr1157bZ588sk8+eSTSVJz2WZRFIscoIt/u+R0Sds4uMPq7/OOAXXr1s2YMWNy//33Z4sttsgvfvGLbLrpppk6depi9/fOO+/kzjvvzC9/+cvUq1cv9erVywYbbJCPP/441113Xa1tl3Q8XNxc/27hwoXp0qVLnn322VqPv/zlL+nfv/9it0+Se++9t9b2L7zwQs33yvv06ZPXXnstJ598ct54443sscceOe2005Y4B7Dq22233dK7d++cffbZi6xbuHBhjjvuuFrHheeeey4vv/xyNtpooySfXMI+duzYPPbYY9lmm22y7rrrZrfddsu4ceMyduzY9OjRY6nm+PS4+K8Wdwz+92WL+3pkVVVV9txzz9x7771OpPC5RDmrvWbNmqV379658sorF3vzoy/6d8c7d+78mX9ObdasWZkyZUp+8IMfZI899sjmm2++yNmrzTbbLJMmTUp1dXXNsmeeeabWNltssUXGjx9fK9bHjx+fxo0bZ4MNNvhCcwNfHUtzDKhUKtl1110zbNiw/OlPf0r9+vVzxx13LHZ/N954Y9q1a5fnnnuu1r/gXnbZZbnhhhuW+iaSm222WaZPn54333yzZtnTTz9da5vtttsuL7/8clq2bJmNN9641mNxf1pyiy22SFVVVaZPn77I9u3bt6/Zbv3118/AgQPzm9/8JpdddlmuueaapZoZWLVdeOGFufvuuxe5Ama77bbL5MmTFzkubLzxxqlfv36S//te+W233VYT4N27d8/vf//7JX6ffEmaNGmStm3b5g9/+EOt5ePHj8/mm2/+ua+vU6dOfv3rX6dLly7Zfffd88YbbyzzDKw5RDlrhF/+8pdZsGBBdtxxx/z2t7/Nyy+/nClTpuTyyy/PLrvs8oX2edZZZ+Xpp5/O8ccfn0mTJuXFF1/MVVddlbfffrvmTsPXXHNNXnnllTz88MMZMmRIrdf3798/CxcuzHe/+91MmTIlDzzwQH76058m+b/fyh5//PF5/fXXM3jw4Lz44ov53e9+lx/96EcZMmRI6tTxP19YXcyePXuRM8rTp0//3GPAk08+mQsuuCDPPPNMpk+fnttvvz3/+Mc/PvNfGEeMGJGDDjooW221Va3HUUcdlffeey/33nvvUs3bq1evbLTRRhkwYEAmTZqUxx9/vOZGb58evw477LC0aNEi++23Xx577LFMnTo148aNy0knnbTYs0aNGzfOaaedllNOOSU33HBDXn311fzpT3/KlVdemRtuuCFJcu655+Z3v/tdXnnllUyePDn33HPPUv3LMbDq23rrrXPYYYflF7/4Ra3lZ5xxRiZMmJBBgwbl2Wefzcsvv5y77rorgwcPrtlmq622SvPmzXPjjTfWRHmPHj1y55131lxG/kX813/9Vy666KLceuuteemll3LmmWfm2WefzUknnbRUr69bt25uvPHGbLPNNtl9990zc+bMLzQHa4CSvssOK90bb7xRDBo0qOjQoUNRv379YoMNNij23Xff4pFHHimKoqh1g6JPNW3atBg5cmRRFIve6K0oimLs2LFF165di6qqqmLdddctevfuXbN+zJgxxeabb15UVVUVnTt3LsaOHbvIezz++ONF586di/r16xddunQpbrrppiJJ8eKLL9Z6jx122KGoX79+0bp16+KMM86ouUET8NU3YMCAIskijwEDBhRFseRjwAsvvFD07t27WH/99Yuqqqpik002KX7xi18s9n2eeeaZIknx1FNPLXZ93759i759+xZF8cmN3k466aRa6/fbb7+amYqiKKZMmVLsuuuuRf369YvNNtusuPvuu4skxejRo2u2mTFjRnHEEUcULVq0KKqqqooNN9ywOPbYY4vZs2fX/Oz/epO7hQsXFj//+c+LTTfdtFhrrbWK9ddfv+jdu3cxbty4oiiK4r//+7+LzTffvGjYsGHRrFmzYr/99iv++te/LvVnDaw6FneTy2nTphVVVVXFvyfKU089VfTq1ato1KhRsc466xSdO3de5AZsBx54YFG3bt2a48vChQuLZs2aFdtvv/1Sz9ShQ4fiZz/7Wc3zBQsWFMOGDSs22GCDYq211iq22WabmhsAF8X/3ejt0xv0furTG7196qOPPioOOOCAYvPNNy/efPPNpZ6HNUelKJbwd1OAlerGG2/MkUcemdmzZ3/ud9YBViWPP/54unXrlldeeaXme54AwOer9/mbACvKqFGjsuGGG2aDDTbIc889lzPOOCPf+ta3BDmwyrvjjjvSqFGjdOrUKa+88kpOOumk7LrrroIcAJaRKIcSzZw5M+eee25mzpyZNm3a5OCDD875559f9lgAn2vu3Lk5/fTT8/rrr6dFixbZc889c8kll5Q9FgB85bh8HQAAAEri9s0AAABQElEOAAAAJRHlAAAAUBJRDgAAACUR5QAAAFASUQ4AJEmmTZuWSqWSZ599tuxRAGCNIcoBgCRJ+/btM2PGjGy11VZJkrFjx6ZSqeS9994rdzAAWI3VK3sAAGDVULdu3bRu3brsMQBgjeJMOQCsYRYuXJiLLrooG2+8caqqqvK1r30t559/fq3L16dNm5aePXsmSdZbb71UKpUMHDgwo0aNSvPmzVNdXV1rnwceeGCOOOKIMn4cAPhKc6YcANYwZ511Vq699tr87Gc/S7du3TJjxoy8+OKLtbZp3759fvvb3+bAAw/MSy+9lCZNmqRhw4apX79+TjzxxNx11105+OCDkyRvv/127rnnnowePbqMHwcAvtJEOQCsQebOnZuf//znueKKKzJgwIAkyUYbbZRu3bpl2rRpNdvVrVs3zZo1S5K0bNky6667bs26/v37Z+TIkTVRfuONN6Zdu3bp0aPHyvoxAGC14fJ1AFiDTJkyJdXV1dljjz2+8D6OPfbYPPjgg/n73/+eJBk5cmQGDhyYSqWyvMYEgDWGKAeANUjDhg2/9D7+8z//M9tss01GjRqVP/7xj3n++eczcODALz8cAKyBRDkArEE6deqUhg0b5qGHHvrcbevXr58kWbBgwSLrjjnmmIwcOTLXXXdd9txzz7Rv3365zwoAawJRDgBrkAYNGuSMM87I6aefnlGjRuXVV1/NE088kREjRiyybYcOHVKpVHLPPffkH//4R+bNm1ez7rDDDsvf//73XHvttTnqqKNW5o8AAKsVUQ4Aa5gf/vCHOfXUU3Puuedm8803zyGHHJK33nprke022GCDDBs2LGeeeWZatWqVE044oWZdkyZNcuCBB6ZRo0bp16/fSpweAFYvlaIoirKHAAC+enr16pXNN988l19+edmjAMBXligHAJbJO++8kwcffDCHHXZYXnjhhWy66aZljwQAX1n+TjkAsEy22267vPvuu7nooosEOQB8Sc6UAwAAQEnc6A0AAABKIsoBAACgJKIcAAAASiLKAQAAoCSiHAAAAEoiygEAAKAkohwAAABKIsoBAACgJP8fk8N95CVG+tkAAAAASUVORK5CYII=",
      "text/plain": [
       "<Figure size 1200x600 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure(figsize=(12, 6))\n",
    "sns.barplot(x='city', y='value', data=value_by_city)\n",
    "plt.title('Average Value by City')\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 120,
   "id": "84a725d8-48e7-4c8a-973a-526531987134",
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'reviews_df' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[120], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmonth\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_date\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mdt\u001b[38;5;241m.\u001b[39mto_period(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mM\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[0;32m      2\u001b[0m monthly_reviews \u001b[38;5;241m=\u001b[39m reviews_df\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmonth\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39msize()\n\u001b[0;32m      4\u001b[0m plt\u001b[38;5;241m.\u001b[39mfigure(figsize\u001b[38;5;241m=\u001b[39m(\u001b[38;5;241m12\u001b[39m, \u001b[38;5;241m6\u001b[39m))\n",
      "\u001b[1;31mNameError\u001b[0m: name 'reviews_df' is not defined"
     ]
    }
   ],
   "source": [
    "reviews_df['month'] = reviews_df['review_date'].dt.to_period('M')\n",
    "monthly_reviews = reviews_df.groupby('month').size()\n",
    "\n",
    "plt.figure(figsize=(12, 6))\n",
    "monthly_reviews.plot()\n",
    "plt.title('Number of Reviews Over Time')\n",
    "plt.xlabel('Month')\n",
    "plt.ylabel('Number of Reviews')\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 124,
   "id": "afe93fd8-3c01-4a8a-aa37-88494633581c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "         Field  Description\n",
      "0   listing_id   Listing ID\n",
      "1    review_id    Review ID\n",
      "2         date  Review date\n",
      "3  reviewer_id  Reviewer ID\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Load the data\n",
    "reviews_df = pd.read_csv('Reviews_data_dictionary.csv')\n",
    "\n",
    "# Check if the DataFrame is loaded correctly\n",
    "print(reviews_df.head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 126,
   "id": "572315f9-e16e-4755-855e-11ddd7b14d71",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "True\n"
     ]
    }
   ],
   "source": [
    "# Check if reviews_df is defined\n",
    "print('reviews_df' in locals())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 129,
   "id": "76262180-5d9d-4e0b-b2b3-39f81230aa32",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "         Field  Description\n",
      "0   listing_id   Listing ID\n",
      "1    review_id    Review ID\n",
      "2         date  Review date\n",
      "3  reviewer_id  Reviewer ID\n",
      "Index(['Field', 'Description'], dtype='object')\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Load the reviews data again\n",
    "reviews_df = pd.read_csv('Reviews_data_dictionary.csv')\n",
    "\n",
    "# Verify the data\n",
    "print(reviews_df.head())\n",
    "print(reviews_df.columns)  # Check if 'review_date' column exists\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 131,
   "id": "78512b27-f3fe-4399-9018-5a3a90bf1130",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['Field', 'Description'], dtype='object')\n"
     ]
    }
   ],
   "source": [
    "print(reviews_df.columns)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 133,
   "id": "07a1065f-9ce7-45ec-9af5-ac6f7d91e3ca",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'review_date'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3805\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3804\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m-> 3805\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_engine\u001b[38;5;241m.\u001b[39mget_loc(casted_key)\n\u001b[0;32m   3806\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m err:\n",
      "File \u001b[1;32mindex.pyx:167\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mindex.pyx:196\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7081\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7089\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mKeyError\u001b[0m: 'review_date'",
      "\nThe above exception was the direct cause of the following exception:\n",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[133], line 2\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;66;03m# Convert review dates to datetime\u001b[39;00m\n\u001b[1;32m----> 2\u001b[0m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_date\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mto_datetime(reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_date\u001b[39m\u001b[38;5;124m'\u001b[39m])\n\u001b[0;32m      4\u001b[0m \u001b[38;5;66;03m# Extract month and analyze\u001b[39;00m\n\u001b[0;32m      5\u001b[0m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmonth\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_date\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mdt\u001b[38;5;241m.\u001b[39mto_period(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mM\u001b[39m\u001b[38;5;124m'\u001b[39m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:4102\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4100\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnlevels \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m   4101\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_getitem_multilevel(key)\n\u001b[1;32m-> 4102\u001b[0m indexer \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mget_loc(key)\n\u001b[0;32m   4103\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_integer(indexer):\n\u001b[0;32m   4104\u001b[0m     indexer \u001b[38;5;241m=\u001b[39m [indexer]\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3812\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3807\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(casted_key, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;129;01mor\u001b[39;00m (\n\u001b[0;32m   3808\u001b[0m         \u001b[38;5;28misinstance\u001b[39m(casted_key, abc\u001b[38;5;241m.\u001b[39mIterable)\n\u001b[0;32m   3809\u001b[0m         \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28many\u001b[39m(\u001b[38;5;28misinstance\u001b[39m(x, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;28;01mfor\u001b[39;00m x \u001b[38;5;129;01min\u001b[39;00m casted_key)\n\u001b[0;32m   3810\u001b[0m     ):\n\u001b[0;32m   3811\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m InvalidIndexError(key)\n\u001b[1;32m-> 3812\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(key) \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01merr\u001b[39;00m\n\u001b[0;32m   3813\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m:\n\u001b[0;32m   3814\u001b[0m     \u001b[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\u001b[39;00m\n\u001b[0;32m   3815\u001b[0m     \u001b[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\u001b[39;00m\n\u001b[0;32m   3816\u001b[0m     \u001b[38;5;66;03m#  the TypeError.\u001b[39;00m\n\u001b[0;32m   3817\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_indexing_error(key)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'review_date'"
     ]
    }
   ],
   "source": [
    "# Convert review dates to datetime\n",
    "reviews_df['review_date'] = pd.to_datetime(reviews_df['review_date'])\n",
    "\n",
    "# Extract month and analyze\n",
    "reviews_df['month'] = reviews_df['review_date'].dt.to_period('M')\n",
    "monthly_reviews = reviews_df.groupby('month').size()\n",
    "\n",
    "plt.figure(figsize=(12, 6))\n",
    "monthly_reviews.plot()\n",
    "plt.title('Number of Reviews Over Time')\n",
    "plt.xlabel('Month')\n",
    "plt.ylabel('Number of Reviews')\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 135,
   "id": "099239db-12a1-418e-87f3-f271a0e53fbb",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['Field', 'Description'], dtype='object')\n"
     ]
    }
   ],
   "source": [
    "# Check the column names in reviews_df\n",
    "print(reviews_df.columns)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "id": "f1c44a06-ca09-43a6-be2b-442c7b3a2139",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'date'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3805\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3804\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m-> 3805\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_engine\u001b[38;5;241m.\u001b[39mget_loc(casted_key)\n\u001b[0;32m   3806\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m err:\n",
      "File \u001b[1;32mindex.pyx:167\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mindex.pyx:196\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7081\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7089\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'",
      "\nThe above exception was the direct cause of the following exception:\n",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[137], line 2\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;66;03m# Convert review dates to datetime\u001b[39;00m\n\u001b[1;32m----> 2\u001b[0m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mto_datetime(reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m])\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:4102\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4100\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnlevels \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m   4101\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_getitem_multilevel(key)\n\u001b[1;32m-> 4102\u001b[0m indexer \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mget_loc(key)\n\u001b[0;32m   4103\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_integer(indexer):\n\u001b[0;32m   4104\u001b[0m     indexer \u001b[38;5;241m=\u001b[39m [indexer]\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3812\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3807\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(casted_key, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;129;01mor\u001b[39;00m (\n\u001b[0;32m   3808\u001b[0m         \u001b[38;5;28misinstance\u001b[39m(casted_key, abc\u001b[38;5;241m.\u001b[39mIterable)\n\u001b[0;32m   3809\u001b[0m         \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28many\u001b[39m(\u001b[38;5;28misinstance\u001b[39m(x, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;28;01mfor\u001b[39;00m x \u001b[38;5;129;01min\u001b[39;00m casted_key)\n\u001b[0;32m   3810\u001b[0m     ):\n\u001b[0;32m   3811\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m InvalidIndexError(key)\n\u001b[1;32m-> 3812\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(key) \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01merr\u001b[39;00m\n\u001b[0;32m   3813\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m:\n\u001b[0;32m   3814\u001b[0m     \u001b[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\u001b[39;00m\n\u001b[0;32m   3815\u001b[0m     \u001b[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\u001b[39;00m\n\u001b[0;32m   3816\u001b[0m     \u001b[38;5;66;03m#  the TypeError.\u001b[39;00m\n\u001b[0;32m   3817\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_indexing_error(key)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'"
     ]
    }
   ],
   "source": [
    "# Convert review dates to datetime\n",
    "reviews_df['date'] = pd.to_datetime(reviews_df['date'])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 143,
   "id": "0a44e719-22e7-4987-9bee-8fe110fa46b6",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['Field', 'Description'], dtype='object')\n"
     ]
    },
    {
     "ename": "KeyError",
     "evalue": "'date'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3805\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3804\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m-> 3805\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_engine\u001b[38;5;241m.\u001b[39mget_loc(casted_key)\n\u001b[0;32m   3806\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m err:\n",
      "File \u001b[1;32mindex.pyx:167\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mindex.pyx:196\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7081\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7089\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'",
      "\nThe above exception was the direct cause of the following exception:\n",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[143], line 11\u001b[0m\n\u001b[0;32m      8\u001b[0m \u001b[38;5;28mprint\u001b[39m(reviews_df\u001b[38;5;241m.\u001b[39mcolumns)\n\u001b[0;32m     10\u001b[0m \u001b[38;5;66;03m# Convert review dates to datetime using the correct column name\u001b[39;00m\n\u001b[1;32m---> 11\u001b[0m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mto_datetime(reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m])  \u001b[38;5;66;03m# Adjust 'review_date' to the actual column name if different\u001b[39;00m\n\u001b[0;32m     13\u001b[0m \u001b[38;5;66;03m# Extract month and analyze\u001b[39;00m\n\u001b[0;32m     14\u001b[0m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmonth\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mdt\u001b[38;5;241m.\u001b[39mto_period(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mM\u001b[39m\u001b[38;5;124m'\u001b[39m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:4102\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4100\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnlevels \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m   4101\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_getitem_multilevel(key)\n\u001b[1;32m-> 4102\u001b[0m indexer \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mget_loc(key)\n\u001b[0;32m   4103\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_integer(indexer):\n\u001b[0;32m   4104\u001b[0m     indexer \u001b[38;5;241m=\u001b[39m [indexer]\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3812\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3807\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(casted_key, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;129;01mor\u001b[39;00m (\n\u001b[0;32m   3808\u001b[0m         \u001b[38;5;28misinstance\u001b[39m(casted_key, abc\u001b[38;5;241m.\u001b[39mIterable)\n\u001b[0;32m   3809\u001b[0m         \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28many\u001b[39m(\u001b[38;5;28misinstance\u001b[39m(x, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;28;01mfor\u001b[39;00m x \u001b[38;5;129;01min\u001b[39;00m casted_key)\n\u001b[0;32m   3810\u001b[0m     ):\n\u001b[0;32m   3811\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m InvalidIndexError(key)\n\u001b[1;32m-> 3812\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(key) \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01merr\u001b[39;00m\n\u001b[0;32m   3813\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m:\n\u001b[0;32m   3814\u001b[0m     \u001b[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\u001b[39;00m\n\u001b[0;32m   3815\u001b[0m     \u001b[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\u001b[39;00m\n\u001b[0;32m   3816\u001b[0m     \u001b[38;5;66;03m#  the TypeError.\u001b[39;00m\n\u001b[0;32m   3817\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_indexing_error(key)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Load the data\n",
    "reviews_df = pd.read_csv('Reviews_data_dictionary.csv')\n",
    "\n",
    "# Verify column names\n",
    "print(reviews_df.columns)\n",
    "\n",
    "# Convert review dates to datetime using the correct column name\n",
    "reviews_df['date'] = pd.to_datetime(reviews_df['date'])  # Adjust 'review_date' to the actual column name if different\n",
    "\n",
    "# Extract month and analyze\n",
    "reviews_df['month'] = reviews_df['date'].dt.to_period('M')\n",
    "monthly_reviews = reviews_df.groupby('month').size()\n",
    "\n",
    "plt.figure(figsize=(12, 6))\n",
    "monthly_reviews.plot()\n",
    "plt.title('Number of Reviews Over Time')\n",
    "plt.xlabel('Month')\n",
    "plt.ylabel('Number of Reviews')\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 145,
   "id": "5b88139d-6fe2-44a9-803e-e9c298442359",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['Field', 'Description'], dtype='object')\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Load the data\n",
    "reviews_df = pd.read_csv('Reviews_data_dictionary.csv')\n",
    "\n",
    "# Print the column names\n",
    "print(reviews_df.columns)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 147,
   "id": "3a9090f4-bd29-4151-9b36-601b91fc7344",
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'Index' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[147], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m Index([\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_id\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate_of_review\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_text\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m], dtype\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m'\u001b[39m)\n",
      "\u001b[1;31mNameError\u001b[0m: name 'Index' is not defined"
     ]
    }
   ],
   "source": [
    "Index(['review_id', 'listing_id', 'date_of_review', 'review_text', 'review_rating'], dtype='object')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 149,
   "id": "e40600f7-d167-43bb-8ea5-0717e2456e1f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['Field', 'Description'], dtype='object')\n",
      "         Field  Description\n",
      "0   listing_id   Listing ID\n",
      "1    review_id    Review ID\n",
      "2         date  Review date\n",
      "3  reviewer_id  Reviewer ID\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Load the data\n",
    "reviews_df = pd.read_csv('Reviews_data_dictionary.csv')\n",
    "\n",
    "# Print the column names\n",
    "print(reviews_df.columns)\n",
    "\n",
    "# Print the first few rows to see the data\n",
    "print(reviews_df.head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 151,
   "id": "30224c84-d45b-440a-b40c-1dcd149d6086",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 4 entries, 0 to 3\n",
      "Data columns (total 2 columns):\n",
      " #   Column       Non-Null Count  Dtype \n",
      "---  ------       --------------  ----- \n",
      " 0   Field        4 non-null      object\n",
      " 1   Description  4 non-null      object\n",
      "dtypes: object(2)\n",
      "memory usage: 196.0+ bytes\n"
     ]
    }
   ],
   "source": [
    "# Get a concise summary of the DataFrame\n",
    "reviews_df.info()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 153,
   "id": "de25ab0d-acd0-4b39-8b42-8c0f54c66969",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'date'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3805\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3804\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m-> 3805\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_engine\u001b[38;5;241m.\u001b[39mget_loc(casted_key)\n\u001b[0;32m   3806\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m err:\n",
      "File \u001b[1;32mindex.pyx:167\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mindex.pyx:196\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7081\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7089\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'",
      "\nThe above exception was the direct cause of the following exception:\n",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[153], line 5\u001b[0m\n\u001b[0;32m      2\u001b[0m date_column_name \u001b[38;5;241m=\u001b[39m \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m  \u001b[38;5;66;03m# Replace this with the actual column name if different\u001b[39;00m\n\u001b[0;32m      4\u001b[0m \u001b[38;5;66;03m# Convert the correct date column to datetime\u001b[39;00m\n\u001b[1;32m----> 5\u001b[0m reviews_df[date_column_name] \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mto_datetime(reviews_df[date_column_name])\n\u001b[0;32m      7\u001b[0m \u001b[38;5;66;03m# Extract month and analyze\u001b[39;00m\n\u001b[0;32m      8\u001b[0m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmonth\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m reviews_df[date_column_name]\u001b[38;5;241m.\u001b[39mdt\u001b[38;5;241m.\u001b[39mto_period(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mM\u001b[39m\u001b[38;5;124m'\u001b[39m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:4102\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4100\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnlevels \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m   4101\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_getitem_multilevel(key)\n\u001b[1;32m-> 4102\u001b[0m indexer \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mget_loc(key)\n\u001b[0;32m   4103\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_integer(indexer):\n\u001b[0;32m   4104\u001b[0m     indexer \u001b[38;5;241m=\u001b[39m [indexer]\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3812\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3807\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(casted_key, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;129;01mor\u001b[39;00m (\n\u001b[0;32m   3808\u001b[0m         \u001b[38;5;28misinstance\u001b[39m(casted_key, abc\u001b[38;5;241m.\u001b[39mIterable)\n\u001b[0;32m   3809\u001b[0m         \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28many\u001b[39m(\u001b[38;5;28misinstance\u001b[39m(x, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;28;01mfor\u001b[39;00m x \u001b[38;5;129;01min\u001b[39;00m casted_key)\n\u001b[0;32m   3810\u001b[0m     ):\n\u001b[0;32m   3811\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m InvalidIndexError(key)\n\u001b[1;32m-> 3812\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(key) \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01merr\u001b[39;00m\n\u001b[0;32m   3813\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m:\n\u001b[0;32m   3814\u001b[0m     \u001b[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\u001b[39;00m\n\u001b[0;32m   3815\u001b[0m     \u001b[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\u001b[39;00m\n\u001b[0;32m   3816\u001b[0m     \u001b[38;5;66;03m#  the TypeError.\u001b[39;00m\n\u001b[0;32m   3817\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_indexing_error(key)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'"
     ]
    }
   ],
   "source": [
    "# Use the correct column name obtained from the previous steps\n",
    "date_column_name = 'date'  # Replace this with the actual column name if different\n",
    "\n",
    "# Convert the correct date column to datetime\n",
    "reviews_df[date_column_name] = pd.to_datetime(reviews_df[date_column_name])\n",
    "\n",
    "# Extract month and analyze\n",
    "reviews_df['month'] = reviews_df[date_column_name].dt.to_period('M')\n",
    "monthly_reviews = reviews_df.groupby('month').size()\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "plt.figure(figsize=(12, 6))\n",
    "monthly_reviews.plot()\n",
    "plt.title('Number of Reviews Over Time')\n",
    "plt.xlabel('Month')\n",
    "plt.ylabel('Number of Reviews')\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 155,
   "id": "a41d6ddb-1ce2-4624-a190-8119a6faf2f7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['Field', 'Description'], dtype='object')\n"
     ]
    },
    {
     "ename": "KeyboardInterrupt",
     "evalue": "",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[155], line 11\u001b[0m\n\u001b[0;32m      8\u001b[0m \u001b[38;5;28mprint\u001b[39m(reviews_df\u001b[38;5;241m.\u001b[39mcolumns)\n\u001b[0;32m     10\u001b[0m \u001b[38;5;66;03m# Strip any leading or trailing spaces from column names\u001b[39;00m\n\u001b[1;32m---> 11\u001b[0m reviews_df\u001b[38;5;241m.\u001b[39mcolumns \u001b[38;5;241m=\u001b[39m reviews_df\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mstr\u001b[38;5;241m.\u001b[39mstrip()\n\u001b[0;32m     13\u001b[0m \u001b[38;5;66;03m# Convert 'date' column to datetime\u001b[39;00m\n\u001b[0;32m     14\u001b[0m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mto_datetime(reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m])\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\strings\\accessor.py:137\u001b[0m, in \u001b[0;36mforbid_nonstring_types.<locals>._forbid_nonstring_types.<locals>.wrapper\u001b[1;34m(self, *args, **kwargs)\u001b[0m\n\u001b[0;32m    132\u001b[0m     msg \u001b[38;5;241m=\u001b[39m (\n\u001b[0;32m    133\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mCannot use .str.\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mfunc_name\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m with values of \u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    134\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124minferred dtype \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;132;01m{\u001b[39;00m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_inferred_dtype\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m.\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    135\u001b[0m     )\n\u001b[0;32m    136\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m(msg)\n\u001b[1;32m--> 137\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m func(\u001b[38;5;28mself\u001b[39m, \u001b[38;5;241m*\u001b[39margs, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\strings\\accessor.py:2125\u001b[0m, in \u001b[0;36mStringMethods.strip\u001b[1;34m(self, to_strip)\u001b[0m\n\u001b[0;32m   2115\u001b[0m \u001b[38;5;129m@Appender\u001b[39m(\n\u001b[0;32m   2116\u001b[0m     _shared_docs[\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mstr_strip\u001b[39m\u001b[38;5;124m\"\u001b[39m]\n\u001b[0;32m   2117\u001b[0m     \u001b[38;5;241m%\u001b[39m {\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m   2123\u001b[0m \u001b[38;5;129m@forbid_nonstring_types\u001b[39m([\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mbytes\u001b[39m\u001b[38;5;124m\"\u001b[39m])\n\u001b[0;32m   2124\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mstrip\u001b[39m(\u001b[38;5;28mself\u001b[39m, to_strip\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mNone\u001b[39;00m):\n\u001b[1;32m-> 2125\u001b[0m     result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_data\u001b[38;5;241m.\u001b[39marray\u001b[38;5;241m.\u001b[39m_str_strip(to_strip)\n\u001b[0;32m   2126\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_wrap_result(result)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\strings\\object_array.py:451\u001b[0m, in \u001b[0;36mObjectStringArrayMixin._str_strip\u001b[1;34m(self, to_strip)\u001b[0m\n\u001b[0;32m    450\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21m_str_strip\u001b[39m(\u001b[38;5;28mself\u001b[39m, to_strip\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mNone\u001b[39;00m):\n\u001b[1;32m--> 451\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_str_map(\u001b[38;5;28;01mlambda\u001b[39;00m x: x\u001b[38;5;241m.\u001b[39mstrip(to_strip))\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\strings\\object_array.py:75\u001b[0m, in \u001b[0;36mObjectStringArrayMixin._str_map\u001b[1;34m(self, f, na_value, dtype, convert)\u001b[0m\n\u001b[0;32m     72\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m np\u001b[38;5;241m.\u001b[39marray([], dtype\u001b[38;5;241m=\u001b[39mdtype)\n\u001b[0;32m     74\u001b[0m arr \u001b[38;5;241m=\u001b[39m np\u001b[38;5;241m.\u001b[39masarray(\u001b[38;5;28mself\u001b[39m, dtype\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mobject\u001b[39m)\n\u001b[1;32m---> 75\u001b[0m mask \u001b[38;5;241m=\u001b[39m isna(arr)\n\u001b[0;32m     76\u001b[0m map_convert \u001b[38;5;241m=\u001b[39m convert \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m np\u001b[38;5;241m.\u001b[39mall(mask)\n\u001b[0;32m     77\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\dtypes\\missing.py:178\u001b[0m, in \u001b[0;36misna\u001b[1;34m(obj)\u001b[0m\n\u001b[0;32m    101\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21misna\u001b[39m(obj: \u001b[38;5;28mobject\u001b[39m) \u001b[38;5;241m-\u001b[39m\u001b[38;5;241m>\u001b[39m \u001b[38;5;28mbool\u001b[39m \u001b[38;5;241m|\u001b[39m npt\u001b[38;5;241m.\u001b[39mNDArray[np\u001b[38;5;241m.\u001b[39mbool_] \u001b[38;5;241m|\u001b[39m NDFrame:\n\u001b[0;32m    102\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[0;32m    103\u001b[0m \u001b[38;5;124;03m    Detect missing values for an array-like object.\u001b[39;00m\n\u001b[0;32m    104\u001b[0m \n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    176\u001b[0m \u001b[38;5;124;03m    Name: 1, dtype: bool\u001b[39;00m\n\u001b[0;32m    177\u001b[0m \u001b[38;5;124;03m    \"\"\"\u001b[39;00m\n\u001b[1;32m--> 178\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m _isna(obj)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\dtypes\\missing.py:184\u001b[0m, in \u001b[0;36m_isna\u001b[1;34m(obj, inf_as_na)\u001b[0m\n\u001b[0;32m    178\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m _isna(obj)\n\u001b[0;32m    181\u001b[0m isnull \u001b[38;5;241m=\u001b[39m isna\n\u001b[1;32m--> 184\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21m_isna\u001b[39m(obj, inf_as_na: \u001b[38;5;28mbool\u001b[39m \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mFalse\u001b[39;00m):\n\u001b[0;32m    185\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[0;32m    186\u001b[0m \u001b[38;5;124;03m    Detect missing values, treating None, NaN or NA as null. Infinite\u001b[39;00m\n\u001b[0;32m    187\u001b[0m \u001b[38;5;124;03m    values will also be treated as null if inf_as_na is True.\u001b[39;00m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    198\u001b[0m \u001b[38;5;124;03m    boolean ndarray or boolean\u001b[39;00m\n\u001b[0;32m    199\u001b[0m \u001b[38;5;124;03m    \"\"\"\u001b[39;00m\n\u001b[0;32m    200\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m is_scalar(obj):\n",
      "\u001b[1;31mKeyboardInterrupt\u001b[0m: "
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Load the data\n",
    "reviews_df = pd.read_csv('Reviews_data_dictionary.csv')\n",
    "\n",
    "# Print column names to verify\n",
    "print(reviews_df.columns)\n",
    "\n",
    "# Strip any leading or trailing spaces from column names\n",
    "reviews_df.columns = reviews_df.columns.str.strip()\n",
    "\n",
    "# Convert 'date' column to datetime\n",
    "reviews_df['date'] = pd.to_datetime(reviews_df['date'])\n",
    "\n",
    "# Extract month and analyze\n",
    "reviews_df['month'] = reviews_df['date'].dt.to_period('M')\n",
    "monthly_reviews = reviews_df.groupby('month').size()\n",
    "\n",
    "# Plot the number of reviews over time\n",
    "plt.figure(figsize=(12, 6))\n",
    "monthly_reviews.plot()\n",
    "plt.title('Number of Reviews Over Time')\n",
    "plt.xlabel('Month')\n",
    "plt.ylabel('Number of Reviews')\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 157,
   "id": "8dda1cbe-8950-40bd-9361-7bcc4b890a24",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Field          object\n",
      "Description    object\n",
      "dtype: object\n",
      "Index(['Field', 'Description'], dtype='object')\n"
     ]
    },
    {
     "ename": "KeyError",
     "evalue": "'date'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3805\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3804\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m-> 3805\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_engine\u001b[38;5;241m.\u001b[39mget_loc(casted_key)\n\u001b[0;32m   3806\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m err:\n",
      "File \u001b[1;32mindex.pyx:167\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mindex.pyx:196\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7081\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7089\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'",
      "\nThe above exception was the direct cause of the following exception:\n",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[157], line 23\u001b[0m\n\u001b[0;32m     20\u001b[0m date_column_name \u001b[38;5;241m=\u001b[39m \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m  \u001b[38;5;66;03m# Adjust this if the actual column name differs\u001b[39;00m\n\u001b[0;32m     22\u001b[0m \u001b[38;5;66;03m# Convert the correct date column to datetime\u001b[39;00m\n\u001b[1;32m---> 23\u001b[0m reviews_df[date_column_name] \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mto_datetime(reviews_df[date_column_name])\n\u001b[0;32m     25\u001b[0m \u001b[38;5;66;03m# Extract month and analyze\u001b[39;00m\n\u001b[0;32m     26\u001b[0m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmonth\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m reviews_df[date_column_name]\u001b[38;5;241m.\u001b[39mdt\u001b[38;5;241m.\u001b[39mto_period(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mM\u001b[39m\u001b[38;5;124m'\u001b[39m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:4102\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4100\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnlevels \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m   4101\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_getitem_multilevel(key)\n\u001b[1;32m-> 4102\u001b[0m indexer \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mget_loc(key)\n\u001b[0;32m   4103\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_integer(indexer):\n\u001b[0;32m   4104\u001b[0m     indexer \u001b[38;5;241m=\u001b[39m [indexer]\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3812\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3807\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(casted_key, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;129;01mor\u001b[39;00m (\n\u001b[0;32m   3808\u001b[0m         \u001b[38;5;28misinstance\u001b[39m(casted_key, abc\u001b[38;5;241m.\u001b[39mIterable)\n\u001b[0;32m   3809\u001b[0m         \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28many\u001b[39m(\u001b[38;5;28misinstance\u001b[39m(x, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;28;01mfor\u001b[39;00m x \u001b[38;5;129;01min\u001b[39;00m casted_key)\n\u001b[0;32m   3810\u001b[0m     ):\n\u001b[0;32m   3811\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m InvalidIndexError(key)\n\u001b[1;32m-> 3812\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(key) \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01merr\u001b[39;00m\n\u001b[0;32m   3813\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m:\n\u001b[0;32m   3814\u001b[0m     \u001b[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\u001b[39;00m\n\u001b[0;32m   3815\u001b[0m     \u001b[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\u001b[39;00m\n\u001b[0;32m   3816\u001b[0m     \u001b[38;5;66;03m#  the TypeError.\u001b[39;00m\n\u001b[0;32m   3817\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_indexing_error(key)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Load the data\n",
    "reviews_df = pd.read_csv('Reviews_data_dictionary.csv')\n",
    "\n",
    "# Check data types of columns\n",
    "print(reviews_df.dtypes)\n",
    "\n",
    "# Convert column names to strings if needed\n",
    "reviews_df.columns = reviews_df.columns.astype(str)\n",
    "\n",
    "# Strip leading and trailing spaces from column names\n",
    "reviews_df.columns = reviews_df.columns.str.strip()\n",
    "\n",
    "# Verify column names again\n",
    "print(reviews_df.columns)\n",
    "\n",
    "# Assume the correct column name is 'date'\n",
    "date_column_name = 'date'  # Adjust this if the actual column name differs\n",
    "\n",
    "# Convert the correct date column to datetime\n",
    "reviews_df[date_column_name] = pd.to_datetime(reviews_df[date_column_name])\n",
    "\n",
    "# Extract month and analyze\n",
    "reviews_df['month'] = reviews_df[date_column_name].dt.to_period('M')\n",
    "monthly_reviews = reviews_df.groupby('month').size()\n",
    "\n",
    "# Plot the number of reviews over time\n",
    "plt.figure(figsize=(12, 6))\n",
    "monthly_reviews.plot()\n",
    "plt.title('Number of Reviews Over Time')\n",
    "plt.xlabel('Month')\n",
    "plt.ylabel('Number of Reviews')\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 159,
   "id": "1afbe5ff-adbf-4eca-9f2a-3302ad0f11ff",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Columns in DataFrame: Index(['Field', 'Description'], dtype='object')\n",
      "Cleaned Columns: Index(['Field', 'Description'], dtype='object')\n",
      "Error: Column 'date' not found in the DataFrame.\n"
     ]
    }
   ],
   "source": [
    ".csv')\n",
    "\n",
    "# Print column names to verify\n",
    "print(\"Columns in DataFrame:\", reviews_df.columns)\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Load the data\n",
    "reviews_df = pd.read_csv('Reviews_data_dictionary\n",
    "# Strip leading and trailing spaces from column names\n",
    "reviews_df.columns = reviews_df.columns.str.strip()\n",
    "\n",
    "# Print column names again to verify changes\n",
    "print(\"Cleaned Columns:\", reviews_df.columns)\n",
    "\n",
    "# Define the correct column name\n",
    "date_column_name = 'date'  # Adjust this to the actual column name if different\n",
    "\n",
    "# Check if the column exists\n",
    "if date_column_name in reviews_df.columns:\n",
    "    # Convert the correct date column to datetime\n",
    "    reviews_df[date_column_name] = pd.to_datetime(reviews_df[date_column_name])\n",
    "\n",
    "    # Extract month and analyze\n",
    "    reviews_df['month'] = reviews_df[date_column_name].dt.to_period('M')\n",
    "    monthly_reviews = reviews_df.groupby('month').size()\n",
    "\n",
    "    # Plot the number of reviews over time\n",
    "    plt.figure(figsize=(12, 6))\n",
    "    monthly_reviews.plot()\n",
    "    plt.title('Number of Reviews Over Time')\n",
    "    plt.xlabel('Month')\n",
    "    plt.ylabel('Number of Reviews')\n",
    "    plt.show()\n",
    "else:\n",
    "    print(f\"Error: Column '{date_column_name}' not found in the DataFrame.\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 167,
   "id": "37e29272-bb84-4777-a68a-89a78d286cd5",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'date'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3805\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3804\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m-> 3805\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_engine\u001b[38;5;241m.\u001b[39mget_loc(casted_key)\n\u001b[0;32m   3806\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m err:\n",
      "File \u001b[1;32mindex.pyx:167\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mindex.pyx:196\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7081\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7089\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'",
      "\nThe above exception was the direct cause of the following exception:\n",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[167], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mto_datetime(reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m])\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:4102\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4100\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnlevels \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m   4101\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_getitem_multilevel(key)\n\u001b[1;32m-> 4102\u001b[0m indexer \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mget_loc(key)\n\u001b[0;32m   4103\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_integer(indexer):\n\u001b[0;32m   4104\u001b[0m     indexer \u001b[38;5;241m=\u001b[39m [indexer]\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3812\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3807\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(casted_key, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;129;01mor\u001b[39;00m (\n\u001b[0;32m   3808\u001b[0m         \u001b[38;5;28misinstance\u001b[39m(casted_key, abc\u001b[38;5;241m.\u001b[39mIterable)\n\u001b[0;32m   3809\u001b[0m         \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28many\u001b[39m(\u001b[38;5;28misinstance\u001b[39m(x, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;28;01mfor\u001b[39;00m x \u001b[38;5;129;01min\u001b[39;00m casted_key)\n\u001b[0;32m   3810\u001b[0m     ):\n\u001b[0;32m   3811\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m InvalidIndexError(key)\n\u001b[1;32m-> 3812\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(key) \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01merr\u001b[39;00m\n\u001b[0;32m   3813\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m:\n\u001b[0;32m   3814\u001b[0m     \u001b[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\u001b[39;00m\n\u001b[0;32m   3815\u001b[0m     \u001b[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\u001b[39;00m\n\u001b[0;32m   3816\u001b[0m     \u001b[38;5;66;03m#  the TypeError.\u001b[39;00m\n\u001b[0;32m   3817\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_indexing_error(key)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'"
     ]
    }
   ],
   "source": [
    "reviews_df['date'] = pd.to_datetime(reviews_df['date'])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 170,
   "id": "f5a0f98e-cf95-46d6-93b2-84f86bf3b41a",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'date'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3805\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3804\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m-> 3805\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_engine\u001b[38;5;241m.\u001b[39mget_loc(casted_key)\n\u001b[0;32m   3806\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m err:\n",
      "File \u001b[1;32mindex.pyx:167\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mindex.pyx:196\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7081\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7089\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'",
      "\nThe above exception was the direct cause of the following exception:\n",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[170], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mseason\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mdt\u001b[38;5;241m.\u001b[39mmonth \u001b[38;5;241m%\u001b[39m \u001b[38;5;241m12\u001b[39m \u001b[38;5;241m/\u001b[39m\u001b[38;5;241m/\u001b[39m \u001b[38;5;241m3\u001b[39m \u001b[38;5;241m+\u001b[39m \u001b[38;5;241m1\u001b[39m\n\u001b[0;32m      2\u001b[0m seasonal_reviews \u001b[38;5;241m=\u001b[39m reviews_df\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mseason\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39msize()\n\u001b[0;32m      4\u001b[0m plt\u001b[38;5;241m.\u001b[39mfigure(figsize\u001b[38;5;241m=\u001b[39m(\u001b[38;5;241m12\u001b[39m, \u001b[38;5;241m6\u001b[39m))\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:4102\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4100\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnlevels \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m   4101\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_getitem_multilevel(key)\n\u001b[1;32m-> 4102\u001b[0m indexer \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mget_loc(key)\n\u001b[0;32m   4103\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_integer(indexer):\n\u001b[0;32m   4104\u001b[0m     indexer \u001b[38;5;241m=\u001b[39m [indexer]\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3812\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3807\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(casted_key, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;129;01mor\u001b[39;00m (\n\u001b[0;32m   3808\u001b[0m         \u001b[38;5;28misinstance\u001b[39m(casted_key, abc\u001b[38;5;241m.\u001b[39mIterable)\n\u001b[0;32m   3809\u001b[0m         \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28many\u001b[39m(\u001b[38;5;28misinstance\u001b[39m(x, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;28;01mfor\u001b[39;00m x \u001b[38;5;129;01min\u001b[39;00m casted_key)\n\u001b[0;32m   3810\u001b[0m     ):\n\u001b[0;32m   3811\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m InvalidIndexError(key)\n\u001b[1;32m-> 3812\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(key) \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01merr\u001b[39;00m\n\u001b[0;32m   3813\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m:\n\u001b[0;32m   3814\u001b[0m     \u001b[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\u001b[39;00m\n\u001b[0;32m   3815\u001b[0m     \u001b[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\u001b[39;00m\n\u001b[0;32m   3816\u001b[0m     \u001b[38;5;66;03m#  the TypeError.\u001b[39;00m\n\u001b[0;32m   3817\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_indexing_error(key)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'"
     ]
    }
   ],
   "source": [
    "reviews_df['season'] = reviews_df['date'].dt.month % 12 // 3 + 1\n",
    "seasonal_reviews = reviews_df.groupby('season').size()\n",
    "\n",
    "plt.figure(figsize=(12, 6))\n",
    "sns.barplot(x=seasonal_reviews.index, y=seasonal_reviews.values)\n",
    "plt.title('Number of Reviews by Season')\n",
    "plt.xlabel('Season')\n",
    "plt.ylabel('Number of Reviews')\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 174,
   "id": "e232c41e-36eb-42f8-a065-5003c46beb40",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'date'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3805\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3804\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m-> 3805\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_engine\u001b[38;5;241m.\u001b[39mget_loc(casted_key)\n\u001b[0;32m   3806\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m err:\n",
      "File \u001b[1;32mindex.pyx:167\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mindex.pyx:196\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7081\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7089\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'",
      "\nThe above exception was the direct cause of the following exception:\n",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[174], line 5\u001b[0m\n\u001b[0;32m      2\u001b[0m date_column_name \u001b[38;5;241m=\u001b[39m \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m  \u001b[38;5;66;03m# Adjust this if the actual column name is different\u001b[39;00m\n\u001b[0;32m      4\u001b[0m \u001b[38;5;66;03m# Convert the date column to datetime\u001b[39;00m\n\u001b[1;32m----> 5\u001b[0m reviews_df[date_column_name] \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mto_datetime(reviews_df[date_column_name])\n\u001b[0;32m      7\u001b[0m \u001b[38;5;66;03m# Extract month and analyze\u001b[39;00m\n\u001b[0;32m      8\u001b[0m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mseason\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m reviews_df[date_column_name]\u001b[38;5;241m.\u001b[39mdt\u001b[38;5;241m.\u001b[39mmonth \u001b[38;5;241m%\u001b[39m \u001b[38;5;241m12\u001b[39m \u001b[38;5;241m/\u001b[39m\u001b[38;5;241m/\u001b[39m \u001b[38;5;241m3\u001b[39m \u001b[38;5;241m+\u001b[39m \u001b[38;5;241m1\u001b[39m\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:4102\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4100\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnlevels \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m   4101\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_getitem_multilevel(key)\n\u001b[1;32m-> 4102\u001b[0m indexer \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mget_loc(key)\n\u001b[0;32m   4103\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_integer(indexer):\n\u001b[0;32m   4104\u001b[0m     indexer \u001b[38;5;241m=\u001b[39m [indexer]\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3812\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3807\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(casted_key, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;129;01mor\u001b[39;00m (\n\u001b[0;32m   3808\u001b[0m         \u001b[38;5;28misinstance\u001b[39m(casted_key, abc\u001b[38;5;241m.\u001b[39mIterable)\n\u001b[0;32m   3809\u001b[0m         \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28many\u001b[39m(\u001b[38;5;28misinstance\u001b[39m(x, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;28;01mfor\u001b[39;00m x \u001b[38;5;129;01min\u001b[39;00m casted_key)\n\u001b[0;32m   3810\u001b[0m     ):\n\u001b[0;32m   3811\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m InvalidIndexError(key)\n\u001b[1;32m-> 3812\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(key) \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01merr\u001b[39;00m\n\u001b[0;32m   3813\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m:\n\u001b[0;32m   3814\u001b[0m     \u001b[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\u001b[39;00m\n\u001b[0;32m   3815\u001b[0m     \u001b[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\u001b[39;00m\n\u001b[0;32m   3816\u001b[0m     \u001b[38;5;66;03m#  the TypeError.\u001b[39;00m\n\u001b[0;32m   3817\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_indexing_error(key)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'"
     ]
    }
   ],
   "source": [
    "# Define the correct column name for dates\n",
    "date_column_name = 'date'  # Adjust this if the actual column name is different\n",
    "\n",
    "# Convert the date column to datetime\n",
    "reviews_df[date_column_name] = pd.to_datetime(reviews_df[date_column_name])\n",
    "\n",
    "# Extract month and analyze\n",
    "reviews_df['season'] = reviews_df[date_column_name].dt.month % 12 // 3 + 1\n",
    "seasonal_reviews = reviews_df.groupby('season').size()\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Plot the number of reviews per season\n",
    "plt.figure(figsize=(12, 6))\n",
    "seasonal_reviews.plot(kind='bar')\n",
    "plt.title('Number of Reviews per Season')\n",
    "plt.xlabel('Season')\n",
    "plt.ylabel('Number of Reviews')\n",
    "plt.xticks(ticks=range(1, 5), labels=['Winter', 'Spring', 'Summer', 'Fall'], rotation=0)\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 176,
   "id": "80dbbb59-7bce-428f-baa1-e5a252acd64d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Columns in DataFrame: Index(['Field', 'Description'], dtype='object')\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Load the data\n",
    "reviews_df = pd.read_csv('Reviews_data_dictionary.csv')\n",
    "\n",
    "# Print column names to verify\n",
    "print(\"Columns in DataFrame:\", reviews_df.columns)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 178,
   "id": "71a0620a-7b3b-4b04-9161-d851e5b8a270",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Cleaned Columns: Index(['Field', 'Description'], dtype='object')\n"
     ]
    }
   ],
   "source": [
    "# Strip any leading or trailing spaces from column names\n",
    "reviews_df.columns = reviews_df.columns.str.strip()\n",
    "\n",
    "# Print cleaned column names to verify\n",
    "print(\"Cleaned Columns:\", reviews_df.columns)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 181,
   "id": "85e41d48-c899-4d00-8868-72e34984329f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "         Field  Description\n",
      "0   listing_id   Listing ID\n",
      "1    review_id    Review ID\n",
      "2         date  Review date\n",
      "3  reviewer_id  Reviewer ID\n"
     ]
    }
   ],
   "source": [
    "# Print the first few rows of the DataFrame\n",
    "print(reviews_df.head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 186,
   "id": "80a26f01-d616-47b1-8bfd-6a3af0dffcac",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'date'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3805\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3804\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m-> 3805\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_engine\u001b[38;5;241m.\u001b[39mget_loc(casted_key)\n\u001b[0;32m   3806\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m err:\n",
      "File \u001b[1;32mindex.pyx:167\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mindex.pyx:196\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7081\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7089\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'",
      "\nThe above exception was the direct cause of the following exception:\n",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[186], line 5\u001b[0m\n\u001b[0;32m      2\u001b[0m date_column_name \u001b[38;5;241m=\u001b[39m \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m  \u001b[38;5;66;03m# Adjust this if the actual column name differs\u001b[39;00m\n\u001b[0;32m      4\u001b[0m \u001b[38;5;66;03m# Convert the date column to datetime\u001b[39;00m\n\u001b[1;32m----> 5\u001b[0m reviews_df[date_column_name] \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mto_datetime(reviews_df[date_column_name])\n\u001b[0;32m      7\u001b[0m \u001b[38;5;66;03m# Extract month and analyze\u001b[39;00m\n\u001b[0;32m      8\u001b[0m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmonth\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m reviews_df[date_column_name]\u001b[38;5;241m.\u001b[39mdt\u001b[38;5;241m.\u001b[39mto_period(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mM\u001b[39m\u001b[38;5;124m'\u001b[39m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:4102\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4100\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnlevels \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m   4101\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_getitem_multilevel(key)\n\u001b[1;32m-> 4102\u001b[0m indexer \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mget_loc(key)\n\u001b[0;32m   4103\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_integer(indexer):\n\u001b[0;32m   4104\u001b[0m     indexer \u001b[38;5;241m=\u001b[39m [indexer]\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3812\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3807\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(casted_key, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;129;01mor\u001b[39;00m (\n\u001b[0;32m   3808\u001b[0m         \u001b[38;5;28misinstance\u001b[39m(casted_key, abc\u001b[38;5;241m.\u001b[39mIterable)\n\u001b[0;32m   3809\u001b[0m         \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28many\u001b[39m(\u001b[38;5;28misinstance\u001b[39m(x, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;28;01mfor\u001b[39;00m x \u001b[38;5;129;01min\u001b[39;00m casted_key)\n\u001b[0;32m   3810\u001b[0m     ):\n\u001b[0;32m   3811\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m InvalidIndexError(key)\n\u001b[1;32m-> 3812\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(key) \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01merr\u001b[39;00m\n\u001b[0;32m   3813\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m:\n\u001b[0;32m   3814\u001b[0m     \u001b[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\u001b[39;00m\n\u001b[0;32m   3815\u001b[0m     \u001b[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\u001b[39;00m\n\u001b[0;32m   3816\u001b[0m     \u001b[38;5;66;03m#  the TypeError.\u001b[39;00m\n\u001b[0;32m   3817\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_indexing_error(key)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'"
     ]
    }
   ],
   "source": [
    "# Define the correct column name for dates\n",
    "date_column_name = 'date'  # Adjust this if the actual column name differs\n",
    "\n",
    "# Convert the date column to datetime\n",
    "reviews_df[date_column_name] = pd.to_datetime(reviews_df[date_column_name])\n",
    "\n",
    "# Extract month and analyze\n",
    "reviews_df['month'] = reviews_df[date_column_name].dt.to_period('M')\n",
    "monthly_reviews = reviews_df.groupby('month').size()\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Plot the number of reviews per month\n",
    "plt.figure(figsize=(12, 6))\n",
    "monthly_reviews.plot()\n",
    "plt.title('Number of Reviews Over Time')\n",
    "plt.xlabel('Month')\n",
    "plt.ylabel('Number of Reviews')\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 188,
   "id": "479e3c74-eff3-4584-8f9e-abc97c3dc02e",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'date'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3805\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3804\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m-> 3805\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_engine\u001b[38;5;241m.\u001b[39mget_loc(casted_key)\n\u001b[0;32m   3806\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m err:\n",
      "File \u001b[1;32mindex.pyx:167\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mindex.pyx:196\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7081\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7089\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'",
      "\nThe above exception was the direct cause of the following exception:\n",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[188], line 2\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;66;03m# Convert the date column to datetime\u001b[39;00m\n\u001b[1;32m----> 2\u001b[0m reviews_df[date_column_name] \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mto_datetime(reviews_df[date_column_name])\n\u001b[0;32m      4\u001b[0m \u001b[38;5;66;03m# Extract month and analyze\u001b[39;00m\n\u001b[0;32m      5\u001b[0m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmonth\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m reviews_df[date_column_name]\u001b[38;5;241m.\u001b[39mdt\u001b[38;5;241m.\u001b[39mto_period(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mM\u001b[39m\u001b[38;5;124m'\u001b[39m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:4102\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4100\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnlevels \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m   4101\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_getitem_multilevel(key)\n\u001b[1;32m-> 4102\u001b[0m indexer \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mget_loc(key)\n\u001b[0;32m   4103\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_integer(indexer):\n\u001b[0;32m   4104\u001b[0m     indexer \u001b[38;5;241m=\u001b[39m [indexer]\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3812\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3807\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(casted_key, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;129;01mor\u001b[39;00m (\n\u001b[0;32m   3808\u001b[0m         \u001b[38;5;28misinstance\u001b[39m(casted_key, abc\u001b[38;5;241m.\u001b[39mIterable)\n\u001b[0;32m   3809\u001b[0m         \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28many\u001b[39m(\u001b[38;5;28misinstance\u001b[39m(x, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;28;01mfor\u001b[39;00m x \u001b[38;5;129;01min\u001b[39;00m casted_key)\n\u001b[0;32m   3810\u001b[0m     ):\n\u001b[0;32m   3811\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m InvalidIndexError(key)\n\u001b[1;32m-> 3812\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(key) \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01merr\u001b[39;00m\n\u001b[0;32m   3813\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m:\n\u001b[0;32m   3814\u001b[0m     \u001b[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\u001b[39;00m\n\u001b[0;32m   3815\u001b[0m     \u001b[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\u001b[39;00m\n\u001b[0;32m   3816\u001b[0m     \u001b[38;5;66;03m#  the TypeError.\u001b[39;00m\n\u001b[0;32m   3817\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_indexing_error(key)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'"
     ]
    }
   ],
   "source": [
    "# Convert the date column to datetime\n",
    "reviews_df[date_column_name] = pd.to_datetime(reviews_df[date_column_name])\n",
    "\n",
    "# Extract month and analyze\n",
    "reviews_df['month'] = reviews_df[date_column_name].dt.to_period('M')\n",
    "monthly_reviews = reviews_df.groupby('month').size()\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Plot the number of reviews per month\n",
    "plt.figure(figsize=(12, 6))\n",
    "monthly_reviews.plot()\n",
    "plt.title('Number of Reviews Over Time')\n",
    "plt.xlabel('Month')\n",
    "plt.ylabel('Number of Reviews')\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 190,
   "id": "9a61ac59-d8bb-45bb-ab97-7840d0186af3",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'date'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3805\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3804\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m-> 3805\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_engine\u001b[38;5;241m.\u001b[39mget_loc(casted_key)\n\u001b[0;32m   3806\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m err:\n",
      "File \u001b[1;32mindex.pyx:167\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mindex.pyx:196\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7081\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7089\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'",
      "\nThe above exception was the direct cause of the following exception:\n",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[190], line 2\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;66;03m# Convert the date column to datetime\u001b[39;00m\n\u001b[1;32m----> 2\u001b[0m reviews_df[date_column_name] \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mto_datetime(reviews_df[date_column_name])\n\u001b[0;32m      4\u001b[0m \u001b[38;5;66;03m# Extract month and analyze\u001b[39;00m\n\u001b[0;32m      5\u001b[0m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmonth\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m reviews_df[date_column_name]\u001b[38;5;241m.\u001b[39mdt\u001b[38;5;241m.\u001b[39mto_period(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mM\u001b[39m\u001b[38;5;124m'\u001b[39m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:4102\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4100\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnlevels \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m   4101\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_getitem_multilevel(key)\n\u001b[1;32m-> 4102\u001b[0m indexer \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mget_loc(key)\n\u001b[0;32m   4103\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_integer(indexer):\n\u001b[0;32m   4104\u001b[0m     indexer \u001b[38;5;241m=\u001b[39m [indexer]\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3812\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3807\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(casted_key, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;129;01mor\u001b[39;00m (\n\u001b[0;32m   3808\u001b[0m         \u001b[38;5;28misinstance\u001b[39m(casted_key, abc\u001b[38;5;241m.\u001b[39mIterable)\n\u001b[0;32m   3809\u001b[0m         \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28many\u001b[39m(\u001b[38;5;28misinstance\u001b[39m(x, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;28;01mfor\u001b[39;00m x \u001b[38;5;129;01min\u001b[39;00m casted_key)\n\u001b[0;32m   3810\u001b[0m     ):\n\u001b[0;32m   3811\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m InvalidIndexError(key)\n\u001b[1;32m-> 3812\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(key) \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01merr\u001b[39;00m\n\u001b[0;32m   3813\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m:\n\u001b[0;32m   3814\u001b[0m     \u001b[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\u001b[39;00m\n\u001b[0;32m   3815\u001b[0m     \u001b[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\u001b[39;00m\n\u001b[0;32m   3816\u001b[0m     \u001b[38;5;66;03m#  the TypeError.\u001b[39;00m\n\u001b[0;32m   3817\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_indexing_error(key)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'"
     ]
    }
   ],
   "source": [
    "# Convert the date column to datetime\n",
    "reviews_df[date_column_name] = pd.to_datetime(reviews_df[date_column_name])\n",
    "\n",
    "# Extract month and analyze\n",
    "reviews_df['month'] = reviews_df[date_column_name].dt.to_period('M')\n",
    "monthly_reviews = reviews_df.groupby('month').size()\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Plot the number of reviews per month\n",
    "plt.figure(figsize=(12, 6))\n",
    "monthly_reviews.plot()\n",
    "plt.title('Number of Reviews Over Time')\n",
    "plt.xlabel('Month')\n",
    "plt.ylabel('Number of Reviews')\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 192,
   "id": "efe63fa3-985d-4b0a-9094-f22992df4a5d",
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'listings_df' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[192], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m avg_price_reviews \u001b[38;5;241m=\u001b[39m listings_df\u001b[38;5;241m.\u001b[39mmerge(reviews_df\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m})\u001b[38;5;241m.\u001b[39mreset_index(), on\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[0;32m      2\u001b[0m city_value \u001b[38;5;241m=\u001b[39m avg_price_reviews\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcity\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m})\u001b[38;5;241m.\u001b[39mreset_index()\n\u001b[0;32m      4\u001b[0m plt\u001b[38;5;241m.\u001b[39mfigure(figsize\u001b[38;5;241m=\u001b[39m(\u001b[38;5;241m12\u001b[39m, \u001b[38;5;241m6\u001b[39m))\n",
      "\u001b[1;31mNameError\u001b[0m: name 'listings_df' is not defined"
     ]
    }
   ],
   "source": [
    "avg_price_reviews = listings_df.merge(reviews_df.groupby('listing_id').agg({'review_rating': 'mean'}).reset_index(), on='listing_id')\n",
    "city_value = avg_price_reviews.groupby('city').agg({'price': 'mean', 'review_rating': 'mean'}).reset_index()\n",
    "\n",
    "plt.figure(figsize=(12, 6))\n",
    "sns.scatterplot(x='price', y='review_rating', hue='city', data=city_value)\n",
    "plt.title('Price vs. Review Rating by City')\n",
    "plt.xlabel('Average Price')\n",
    "plt.ylabel('Average Review Rating')\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 195,
   "id": "312c37ba-1457-4ecd-982e-031fb563e7b6",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Columns in listings_df: Index(['Field', 'Description'], dtype='object')\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Load the listings data (update the file path as needed)\n",
    "listings_df = pd.read_csv('Listings_data_dictionary.csv')\n",
    "\n",
    "# Print column names to verify\n",
    "print(\"Columns in listings_df:\", listings_df.columns)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 197,
   "id": "9cc21736-7e85-4885-9478-7ac766bcd86a",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'listing_id'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[197], line 6\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;66;03m# Ensure reviews_df is also loaded and defined\u001b[39;00m\n\u001b[0;32m      2\u001b[0m \u001b[38;5;66;03m# reviews_df = pd.read_csv('path_to_reviews_data.csv')  # Uncomment and update as needed\u001b[39;00m\n\u001b[0;32m      3\u001b[0m \n\u001b[0;32m      4\u001b[0m \u001b[38;5;66;03m# Merge listings_df with the average review ratings\u001b[39;00m\n\u001b[0;32m      5\u001b[0m avg_price_reviews \u001b[38;5;241m=\u001b[39m listings_df\u001b[38;5;241m.\u001b[39mmerge(\n\u001b[1;32m----> 6\u001b[0m     reviews_df\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m})\u001b[38;5;241m.\u001b[39mreset_index(),\n\u001b[0;32m      7\u001b[0m     on\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id\u001b[39m\u001b[38;5;124m'\u001b[39m\n\u001b[0;32m      8\u001b[0m )\n\u001b[0;32m     10\u001b[0m \u001b[38;5;66;03m# Calculate average price and review rating by city\u001b[39;00m\n\u001b[0;32m     11\u001b[0m city_value \u001b[38;5;241m=\u001b[39m avg_price_reviews\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcity\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m})\u001b[38;5;241m.\u001b[39mreset_index()\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:9183\u001b[0m, in \u001b[0;36mDataFrame.groupby\u001b[1;34m(self, by, axis, level, as_index, sort, group_keys, observed, dropna)\u001b[0m\n\u001b[0;32m   9180\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m level \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m by \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   9181\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mYou have to supply one of \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mby\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m and \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlevel\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m-> 9183\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m DataFrameGroupBy(\n\u001b[0;32m   9184\u001b[0m     obj\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m,\n\u001b[0;32m   9185\u001b[0m     keys\u001b[38;5;241m=\u001b[39mby,\n\u001b[0;32m   9186\u001b[0m     axis\u001b[38;5;241m=\u001b[39maxis,\n\u001b[0;32m   9187\u001b[0m     level\u001b[38;5;241m=\u001b[39mlevel,\n\u001b[0;32m   9188\u001b[0m     as_index\u001b[38;5;241m=\u001b[39mas_index,\n\u001b[0;32m   9189\u001b[0m     sort\u001b[38;5;241m=\u001b[39msort,\n\u001b[0;32m   9190\u001b[0m     group_keys\u001b[38;5;241m=\u001b[39mgroup_keys,\n\u001b[0;32m   9191\u001b[0m     observed\u001b[38;5;241m=\u001b[39mobserved,\n\u001b[0;32m   9192\u001b[0m     dropna\u001b[38;5;241m=\u001b[39mdropna,\n\u001b[0;32m   9193\u001b[0m )\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\groupby.py:1329\u001b[0m, in \u001b[0;36mGroupBy.__init__\u001b[1;34m(self, obj, keys, axis, level, grouper, exclusions, selection, as_index, sort, group_keys, observed, dropna)\u001b[0m\n\u001b[0;32m   1326\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdropna \u001b[38;5;241m=\u001b[39m dropna\n\u001b[0;32m   1328\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m grouper \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m-> 1329\u001b[0m     grouper, exclusions, obj \u001b[38;5;241m=\u001b[39m get_grouper(\n\u001b[0;32m   1330\u001b[0m         obj,\n\u001b[0;32m   1331\u001b[0m         keys,\n\u001b[0;32m   1332\u001b[0m         axis\u001b[38;5;241m=\u001b[39maxis,\n\u001b[0;32m   1333\u001b[0m         level\u001b[38;5;241m=\u001b[39mlevel,\n\u001b[0;32m   1334\u001b[0m         sort\u001b[38;5;241m=\u001b[39msort,\n\u001b[0;32m   1335\u001b[0m         observed\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m \u001b[38;5;28;01mif\u001b[39;00m observed \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default \u001b[38;5;28;01melse\u001b[39;00m observed,\n\u001b[0;32m   1336\u001b[0m         dropna\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdropna,\n\u001b[0;32m   1337\u001b[0m     )\n\u001b[0;32m   1339\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m observed \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default:\n\u001b[0;32m   1340\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28many\u001b[39m(ping\u001b[38;5;241m.\u001b[39m_passed_categorical \u001b[38;5;28;01mfor\u001b[39;00m ping \u001b[38;5;129;01min\u001b[39;00m grouper\u001b[38;5;241m.\u001b[39mgroupings):\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\grouper.py:1043\u001b[0m, in \u001b[0;36mget_grouper\u001b[1;34m(obj, key, axis, level, sort, observed, validate, dropna)\u001b[0m\n\u001b[0;32m   1041\u001b[0m         in_axis, level, gpr \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mFalse\u001b[39;00m, gpr, \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[0;32m   1042\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m-> 1043\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(gpr)\n\u001b[0;32m   1044\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(gpr, Grouper) \u001b[38;5;129;01mand\u001b[39;00m gpr\u001b[38;5;241m.\u001b[39mkey \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   1045\u001b[0m     \u001b[38;5;66;03m# Add key to exclusions\u001b[39;00m\n\u001b[0;32m   1046\u001b[0m     exclusions\u001b[38;5;241m.\u001b[39madd(gpr\u001b[38;5;241m.\u001b[39mkey)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'listing_id'"
     ]
    }
   ],
   "source": [
    "# Ensure reviews_df is also loaded and defined\n",
    "# reviews_df = pd.read_csv('path_to_reviews_data.csv')  # Uncomment and update as needed\n",
    "\n",
    "# Merge listings_df with the average review ratings\n",
    "avg_price_reviews = listings_df.merge(\n",
    "    reviews_df.groupby('listing_id').agg({'review_rating': 'mean'}).reset_index(),\n",
    "    on='listing_id'\n",
    ")\n",
    "\n",
    "# Calculate average price and review rating by city\n",
    "city_value = avg_price_reviews.groupby('city').agg({'price': 'mean', 'review_rating': 'mean'}).reset_index()\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Plot average price and review rating by city\n",
    "plt.figure(figsize=(12, 6))\n",
    "plt.bar(city_value['city'], city_value['price'], alpha=0.6, label='Average Price')\n",
    "plt.bar(city_value['city'], city_value['review_rating'], alpha=0.6, label='Average Review Rating')\n",
    "plt.title('Average Price and Review Rating by City')\n",
    "plt.xlabel('City')\n",
    "plt.ylabel('Value')\n",
    "plt.xticks(rotation=45)\n",
    "plt.legend()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 199,
   "id": "f92a2a97-6ad4-4ea5-84f7-8796e44ebf3a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Columns in reviews_df: Index(['Field', 'Description'], dtype='object')\n"
     ]
    }
   ],
   "source": [
    "print(\"Columns in reviews_df:\", reviews_df.columns)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 201,
   "id": "95599b5d-424e-4dd3-bd17-e018f059bca0",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'listing_id_new'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[201], line 3\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;66;03m# Use the correct column name for grouping\u001b[39;00m\n\u001b[0;32m      2\u001b[0m avg_price_reviews \u001b[38;5;241m=\u001b[39m listings_df\u001b[38;5;241m.\u001b[39mmerge(\n\u001b[1;32m----> 3\u001b[0m     reviews_df\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id_new\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m})\u001b[38;5;241m.\u001b[39mreset_index(),\n\u001b[0;32m      4\u001b[0m     left_on\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id\u001b[39m\u001b[38;5;124m'\u001b[39m,  \u001b[38;5;66;03m# Adjust if different\u001b[39;00m\n\u001b[0;32m      5\u001b[0m     right_on\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id_new\u001b[39m\u001b[38;5;124m'\u001b[39m  \u001b[38;5;66;03m# Adjust if different\u001b[39;00m\n\u001b[0;32m      6\u001b[0m )\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:9183\u001b[0m, in \u001b[0;36mDataFrame.groupby\u001b[1;34m(self, by, axis, level, as_index, sort, group_keys, observed, dropna)\u001b[0m\n\u001b[0;32m   9180\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m level \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m by \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   9181\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mYou have to supply one of \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mby\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m and \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlevel\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m-> 9183\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m DataFrameGroupBy(\n\u001b[0;32m   9184\u001b[0m     obj\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m,\n\u001b[0;32m   9185\u001b[0m     keys\u001b[38;5;241m=\u001b[39mby,\n\u001b[0;32m   9186\u001b[0m     axis\u001b[38;5;241m=\u001b[39maxis,\n\u001b[0;32m   9187\u001b[0m     level\u001b[38;5;241m=\u001b[39mlevel,\n\u001b[0;32m   9188\u001b[0m     as_index\u001b[38;5;241m=\u001b[39mas_index,\n\u001b[0;32m   9189\u001b[0m     sort\u001b[38;5;241m=\u001b[39msort,\n\u001b[0;32m   9190\u001b[0m     group_keys\u001b[38;5;241m=\u001b[39mgroup_keys,\n\u001b[0;32m   9191\u001b[0m     observed\u001b[38;5;241m=\u001b[39mobserved,\n\u001b[0;32m   9192\u001b[0m     dropna\u001b[38;5;241m=\u001b[39mdropna,\n\u001b[0;32m   9193\u001b[0m )\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\groupby.py:1329\u001b[0m, in \u001b[0;36mGroupBy.__init__\u001b[1;34m(self, obj, keys, axis, level, grouper, exclusions, selection, as_index, sort, group_keys, observed, dropna)\u001b[0m\n\u001b[0;32m   1326\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdropna \u001b[38;5;241m=\u001b[39m dropna\n\u001b[0;32m   1328\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m grouper \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m-> 1329\u001b[0m     grouper, exclusions, obj \u001b[38;5;241m=\u001b[39m get_grouper(\n\u001b[0;32m   1330\u001b[0m         obj,\n\u001b[0;32m   1331\u001b[0m         keys,\n\u001b[0;32m   1332\u001b[0m         axis\u001b[38;5;241m=\u001b[39maxis,\n\u001b[0;32m   1333\u001b[0m         level\u001b[38;5;241m=\u001b[39mlevel,\n\u001b[0;32m   1334\u001b[0m         sort\u001b[38;5;241m=\u001b[39msort,\n\u001b[0;32m   1335\u001b[0m         observed\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m \u001b[38;5;28;01mif\u001b[39;00m observed \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default \u001b[38;5;28;01melse\u001b[39;00m observed,\n\u001b[0;32m   1336\u001b[0m         dropna\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdropna,\n\u001b[0;32m   1337\u001b[0m     )\n\u001b[0;32m   1339\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m observed \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default:\n\u001b[0;32m   1340\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28many\u001b[39m(ping\u001b[38;5;241m.\u001b[39m_passed_categorical \u001b[38;5;28;01mfor\u001b[39;00m ping \u001b[38;5;129;01min\u001b[39;00m grouper\u001b[38;5;241m.\u001b[39mgroupings):\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\grouper.py:1043\u001b[0m, in \u001b[0;36mget_grouper\u001b[1;34m(obj, key, axis, level, sort, observed, validate, dropna)\u001b[0m\n\u001b[0;32m   1041\u001b[0m         in_axis, level, gpr \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mFalse\u001b[39;00m, gpr, \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[0;32m   1042\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m-> 1043\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(gpr)\n\u001b[0;32m   1044\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(gpr, Grouper) \u001b[38;5;129;01mand\u001b[39;00m gpr\u001b[38;5;241m.\u001b[39mkey \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   1045\u001b[0m     \u001b[38;5;66;03m# Add key to exclusions\u001b[39;00m\n\u001b[0;32m   1046\u001b[0m     exclusions\u001b[38;5;241m.\u001b[39madd(gpr\u001b[38;5;241m.\u001b[39mkey)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'listing_id_new'"
     ]
    }
   ],
   "source": [
    "# Use the correct column name for grouping\n",
    "avg_price_reviews = listings_df.merge(\n",
    "    reviews_df.groupby('listing_id_new').agg({'review_rating': 'mean'}).reset_index(),\n",
    "    left_on='listing_id',  # Adjust if different\n",
    "    right_on='listing_id_new'  # Adjust if different\n",
    ")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 203,
   "id": "af342a51-7d4f-445f-86ea-404fb7d8b55f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Columns in listings_df: Index(['Field', 'Description'], dtype='object')\n",
      "Columns in reviews_df: Index(['Field', 'Description'], dtype='object')\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Load the data if not already loaded\n",
    "listings_df = pd.read_csv('Listings_data_dictionary.csv')\n",
    "reviews_df = pd.read_csv('Reviews_data_dictionary.csv')\n",
    "\n",
    "# Check columns\n",
    "print(\"Columns in listings_df:\", listings_df.columns)\n",
    "print(\"Columns in reviews_df:\", reviews_df.columns)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 206,
   "id": "970a2565-2788-4eeb-8d78-5edaf7c62095",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'listing_id'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[206], line 3\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;66;03m# Perform the aggregation and merge\u001b[39;00m\n\u001b[0;32m      2\u001b[0m avg_price_reviews \u001b[38;5;241m=\u001b[39m listings_df\u001b[38;5;241m.\u001b[39mmerge(\n\u001b[1;32m----> 3\u001b[0m     reviews_df\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m})\u001b[38;5;241m.\u001b[39mreset_index(),\n\u001b[0;32m      4\u001b[0m     on\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id\u001b[39m\u001b[38;5;124m'\u001b[39m  \u001b[38;5;66;03m# Ensure this column exists in both DataFrames\u001b[39;00m\n\u001b[0;32m      5\u001b[0m )\n\u001b[0;32m      7\u001b[0m \u001b[38;5;66;03m# Calculate average price and review rating by city\u001b[39;00m\n\u001b[0;32m      8\u001b[0m city_value \u001b[38;5;241m=\u001b[39m avg_price_reviews\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcity\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m})\u001b[38;5;241m.\u001b[39mreset_index()\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:9183\u001b[0m, in \u001b[0;36mDataFrame.groupby\u001b[1;34m(self, by, axis, level, as_index, sort, group_keys, observed, dropna)\u001b[0m\n\u001b[0;32m   9180\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m level \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m by \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   9181\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mYou have to supply one of \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mby\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m and \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlevel\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m-> 9183\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m DataFrameGroupBy(\n\u001b[0;32m   9184\u001b[0m     obj\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m,\n\u001b[0;32m   9185\u001b[0m     keys\u001b[38;5;241m=\u001b[39mby,\n\u001b[0;32m   9186\u001b[0m     axis\u001b[38;5;241m=\u001b[39maxis,\n\u001b[0;32m   9187\u001b[0m     level\u001b[38;5;241m=\u001b[39mlevel,\n\u001b[0;32m   9188\u001b[0m     as_index\u001b[38;5;241m=\u001b[39mas_index,\n\u001b[0;32m   9189\u001b[0m     sort\u001b[38;5;241m=\u001b[39msort,\n\u001b[0;32m   9190\u001b[0m     group_keys\u001b[38;5;241m=\u001b[39mgroup_keys,\n\u001b[0;32m   9191\u001b[0m     observed\u001b[38;5;241m=\u001b[39mobserved,\n\u001b[0;32m   9192\u001b[0m     dropna\u001b[38;5;241m=\u001b[39mdropna,\n\u001b[0;32m   9193\u001b[0m )\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\groupby.py:1329\u001b[0m, in \u001b[0;36mGroupBy.__init__\u001b[1;34m(self, obj, keys, axis, level, grouper, exclusions, selection, as_index, sort, group_keys, observed, dropna)\u001b[0m\n\u001b[0;32m   1326\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdropna \u001b[38;5;241m=\u001b[39m dropna\n\u001b[0;32m   1328\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m grouper \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m-> 1329\u001b[0m     grouper, exclusions, obj \u001b[38;5;241m=\u001b[39m get_grouper(\n\u001b[0;32m   1330\u001b[0m         obj,\n\u001b[0;32m   1331\u001b[0m         keys,\n\u001b[0;32m   1332\u001b[0m         axis\u001b[38;5;241m=\u001b[39maxis,\n\u001b[0;32m   1333\u001b[0m         level\u001b[38;5;241m=\u001b[39mlevel,\n\u001b[0;32m   1334\u001b[0m         sort\u001b[38;5;241m=\u001b[39msort,\n\u001b[0;32m   1335\u001b[0m         observed\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m \u001b[38;5;28;01mif\u001b[39;00m observed \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default \u001b[38;5;28;01melse\u001b[39;00m observed,\n\u001b[0;32m   1336\u001b[0m         dropna\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdropna,\n\u001b[0;32m   1337\u001b[0m     )\n\u001b[0;32m   1339\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m observed \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default:\n\u001b[0;32m   1340\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28many\u001b[39m(ping\u001b[38;5;241m.\u001b[39m_passed_categorical \u001b[38;5;28;01mfor\u001b[39;00m ping \u001b[38;5;129;01min\u001b[39;00m grouper\u001b[38;5;241m.\u001b[39mgroupings):\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\grouper.py:1043\u001b[0m, in \u001b[0;36mget_grouper\u001b[1;34m(obj, key, axis, level, sort, observed, validate, dropna)\u001b[0m\n\u001b[0;32m   1041\u001b[0m         in_axis, level, gpr \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mFalse\u001b[39;00m, gpr, \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[0;32m   1042\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m-> 1043\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(gpr)\n\u001b[0;32m   1044\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(gpr, Grouper) \u001b[38;5;129;01mand\u001b[39;00m gpr\u001b[38;5;241m.\u001b[39mkey \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   1045\u001b[0m     \u001b[38;5;66;03m# Add key to exclusions\u001b[39;00m\n\u001b[0;32m   1046\u001b[0m     exclusions\u001b[38;5;241m.\u001b[39madd(gpr\u001b[38;5;241m.\u001b[39mkey)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'listing_id'"
     ]
    }
   ],
   "source": [
    "# Perform the aggregation and merge\n",
    "avg_price_reviews = listings_df.merge(\n",
    "    reviews_df.groupby('listing_id').agg({'review_rating': 'mean'}).reset_index(),\n",
    "    on='listing_id'  # Ensure this column exists in both DataFrames\n",
    ")\n",
    "\n",
    "# Calculate average price and review rating by city\n",
    "city_value = avg_price_reviews.groupby('city').agg({'price': 'mean', 'review_rating': 'mean'}).reset_index()\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Plot average price and review rating by city\n",
    "plt.figure(figsize=(12, 6))\n",
    "plt.bar(city_value['city'], city_value['price'], alpha=0.6, label='Average Price')\n",
    "plt.bar(city_value['city'], city_value['review_rating'], alpha=0.6, label='Average Review Rating')\n",
    "plt.title('Average Price and Review Rating by City')\n",
    "plt.xlabel('City')\n",
    "plt.ylabel('Value')\n",
    "plt.xticks(rotation=45)\n",
    "plt.legend()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 208,
   "id": "3582d0b8-ed74-42c5-b840-bf921518a2dc",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Columns in reviews_df: Index(['Field', 'Description'], dtype='object')\n"
     ]
    }
   ],
   "source": [
    "print(\"Columns in reviews_df:\", reviews_df.columns)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 210,
   "id": "7aca14de-9e81-4608-a13c-3690d4c823b3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Columns in listings_df: Index(['Field', 'Description'], dtype='object')\n"
     ]
    }
   ],
   "source": [
    "print(\"Columns in listings_df:\", listings_df.columns)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 212,
   "id": "ff13e462-068b-46ed-8b8a-b77727525491",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'id'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[212], line 2\u001b[0m\n\u001b[0;32m      1\u001b[0m avg_price_reviews \u001b[38;5;241m=\u001b[39m listings_df\u001b[38;5;241m.\u001b[39mmerge(\n\u001b[1;32m----> 2\u001b[0m     reviews_df\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mid\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m})\u001b[38;5;241m.\u001b[39mreset_index(),\n\u001b[0;32m      3\u001b[0m     left_on\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id\u001b[39m\u001b[38;5;124m'\u001b[39m,  \u001b[38;5;66;03m# Adjust if different\u001b[39;00m\n\u001b[0;32m      4\u001b[0m     right_on\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mid\u001b[39m\u001b[38;5;124m'\u001b[39m  \u001b[38;5;66;03m# Adjust if different\u001b[39;00m\n\u001b[0;32m      5\u001b[0m )\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:9183\u001b[0m, in \u001b[0;36mDataFrame.groupby\u001b[1;34m(self, by, axis, level, as_index, sort, group_keys, observed, dropna)\u001b[0m\n\u001b[0;32m   9180\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m level \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m by \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   9181\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mYou have to supply one of \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mby\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m and \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlevel\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m-> 9183\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m DataFrameGroupBy(\n\u001b[0;32m   9184\u001b[0m     obj\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m,\n\u001b[0;32m   9185\u001b[0m     keys\u001b[38;5;241m=\u001b[39mby,\n\u001b[0;32m   9186\u001b[0m     axis\u001b[38;5;241m=\u001b[39maxis,\n\u001b[0;32m   9187\u001b[0m     level\u001b[38;5;241m=\u001b[39mlevel,\n\u001b[0;32m   9188\u001b[0m     as_index\u001b[38;5;241m=\u001b[39mas_index,\n\u001b[0;32m   9189\u001b[0m     sort\u001b[38;5;241m=\u001b[39msort,\n\u001b[0;32m   9190\u001b[0m     group_keys\u001b[38;5;241m=\u001b[39mgroup_keys,\n\u001b[0;32m   9191\u001b[0m     observed\u001b[38;5;241m=\u001b[39mobserved,\n\u001b[0;32m   9192\u001b[0m     dropna\u001b[38;5;241m=\u001b[39mdropna,\n\u001b[0;32m   9193\u001b[0m )\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\groupby.py:1329\u001b[0m, in \u001b[0;36mGroupBy.__init__\u001b[1;34m(self, obj, keys, axis, level, grouper, exclusions, selection, as_index, sort, group_keys, observed, dropna)\u001b[0m\n\u001b[0;32m   1326\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdropna \u001b[38;5;241m=\u001b[39m dropna\n\u001b[0;32m   1328\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m grouper \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m-> 1329\u001b[0m     grouper, exclusions, obj \u001b[38;5;241m=\u001b[39m get_grouper(\n\u001b[0;32m   1330\u001b[0m         obj,\n\u001b[0;32m   1331\u001b[0m         keys,\n\u001b[0;32m   1332\u001b[0m         axis\u001b[38;5;241m=\u001b[39maxis,\n\u001b[0;32m   1333\u001b[0m         level\u001b[38;5;241m=\u001b[39mlevel,\n\u001b[0;32m   1334\u001b[0m         sort\u001b[38;5;241m=\u001b[39msort,\n\u001b[0;32m   1335\u001b[0m         observed\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m \u001b[38;5;28;01mif\u001b[39;00m observed \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default \u001b[38;5;28;01melse\u001b[39;00m observed,\n\u001b[0;32m   1336\u001b[0m         dropna\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdropna,\n\u001b[0;32m   1337\u001b[0m     )\n\u001b[0;32m   1339\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m observed \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default:\n\u001b[0;32m   1340\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28many\u001b[39m(ping\u001b[38;5;241m.\u001b[39m_passed_categorical \u001b[38;5;28;01mfor\u001b[39;00m ping \u001b[38;5;129;01min\u001b[39;00m grouper\u001b[38;5;241m.\u001b[39mgroupings):\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\grouper.py:1043\u001b[0m, in \u001b[0;36mget_grouper\u001b[1;34m(obj, key, axis, level, sort, observed, validate, dropna)\u001b[0m\n\u001b[0;32m   1041\u001b[0m         in_axis, level, gpr \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mFalse\u001b[39;00m, gpr, \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[0;32m   1042\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m-> 1043\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(gpr)\n\u001b[0;32m   1044\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(gpr, Grouper) \u001b[38;5;129;01mand\u001b[39;00m gpr\u001b[38;5;241m.\u001b[39mkey \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   1045\u001b[0m     \u001b[38;5;66;03m# Add key to exclusions\u001b[39;00m\n\u001b[0;32m   1046\u001b[0m     exclusions\u001b[38;5;241m.\u001b[39madd(gpr\u001b[38;5;241m.\u001b[39mkey)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'id'"
     ]
    }
   ],
   "source": [
    "avg_price_reviews = listings_df.merge(\n",
    "    reviews_df.groupby('id').agg({'review_rating': 'mean'}).reset_index(),\n",
    "    left_on='listing_id',  # Adjust if different\n",
    "    right_on='id'  # Adjust if different\n",
    ")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 214,
   "id": "b586c164-c91a-4fd3-8d24-61454f004fd1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Listings DataFrame:\n",
      "           Field                       Description\n",
      "0     listing_id                        Listing ID\n",
      "1           name                      Listing Name\n",
      "2        host_id                           Host ID\n",
      "3     host_since       Date the Host joined Airbnb\n",
      "4  host_location  Location where the Host is based\n",
      "Reviews DataFrame:\n",
      "         Field  Description\n",
      "0   listing_id   Listing ID\n",
      "1    review_id    Review ID\n",
      "2         date  Review date\n",
      "3  reviewer_id  Reviewer ID\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Load the data\n",
    "listings_df = pd.read_csv('Listings_data_dictionary.csv')\n",
    "reviews_df = pd.read_csv('Reviews_data_dictionary.csv')\n",
    "\n",
    "# Verify data\n",
    "print(\"Listings DataFrame:\")\n",
    "print(listings_df.head())\n",
    "print(\"Reviews DataFrame:\")\n",
    "print(reviews_df.head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 217,
   "id": "2441ae41-55ff-4e38-87e5-ae97f3560e16",
   "metadata": {},
   "outputs": [],
   "source": [
    "reviews_df.columns = reviews_df.columns.str.strip()\n",
    "listings_df.columns = listings_df.columns.str.strip()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 219,
   "id": "8ec55b89-eaa1-4932-a71d-9133c5e89d23",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'listing_id'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[219], line 3\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;66;03m# Perform the aggregation and merge\u001b[39;00m\n\u001b[0;32m      2\u001b[0m avg_price_reviews \u001b[38;5;241m=\u001b[39m listings_df\u001b[38;5;241m.\u001b[39mmerge(\n\u001b[1;32m----> 3\u001b[0m     reviews_df\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m})\u001b[38;5;241m.\u001b[39mreset_index(),\n\u001b[0;32m      4\u001b[0m     on\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id\u001b[39m\u001b[38;5;124m'\u001b[39m  \u001b[38;5;66;03m# Ensure this column exists in both DataFrames\u001b[39;00m\n\u001b[0;32m      5\u001b[0m )\n\u001b[0;32m      7\u001b[0m \u001b[38;5;66;03m# Calculate average price and review rating by city\u001b[39;00m\n\u001b[0;32m      8\u001b[0m city_value \u001b[38;5;241m=\u001b[39m avg_price_reviews\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcity\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m})\u001b[38;5;241m.\u001b[39mreset_index()\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:9183\u001b[0m, in \u001b[0;36mDataFrame.groupby\u001b[1;34m(self, by, axis, level, as_index, sort, group_keys, observed, dropna)\u001b[0m\n\u001b[0;32m   9180\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m level \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m by \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   9181\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mYou have to supply one of \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mby\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m and \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlevel\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m-> 9183\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m DataFrameGroupBy(\n\u001b[0;32m   9184\u001b[0m     obj\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m,\n\u001b[0;32m   9185\u001b[0m     keys\u001b[38;5;241m=\u001b[39mby,\n\u001b[0;32m   9186\u001b[0m     axis\u001b[38;5;241m=\u001b[39maxis,\n\u001b[0;32m   9187\u001b[0m     level\u001b[38;5;241m=\u001b[39mlevel,\n\u001b[0;32m   9188\u001b[0m     as_index\u001b[38;5;241m=\u001b[39mas_index,\n\u001b[0;32m   9189\u001b[0m     sort\u001b[38;5;241m=\u001b[39msort,\n\u001b[0;32m   9190\u001b[0m     group_keys\u001b[38;5;241m=\u001b[39mgroup_keys,\n\u001b[0;32m   9191\u001b[0m     observed\u001b[38;5;241m=\u001b[39mobserved,\n\u001b[0;32m   9192\u001b[0m     dropna\u001b[38;5;241m=\u001b[39mdropna,\n\u001b[0;32m   9193\u001b[0m )\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\groupby.py:1329\u001b[0m, in \u001b[0;36mGroupBy.__init__\u001b[1;34m(self, obj, keys, axis, level, grouper, exclusions, selection, as_index, sort, group_keys, observed, dropna)\u001b[0m\n\u001b[0;32m   1326\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdropna \u001b[38;5;241m=\u001b[39m dropna\n\u001b[0;32m   1328\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m grouper \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m-> 1329\u001b[0m     grouper, exclusions, obj \u001b[38;5;241m=\u001b[39m get_grouper(\n\u001b[0;32m   1330\u001b[0m         obj,\n\u001b[0;32m   1331\u001b[0m         keys,\n\u001b[0;32m   1332\u001b[0m         axis\u001b[38;5;241m=\u001b[39maxis,\n\u001b[0;32m   1333\u001b[0m         level\u001b[38;5;241m=\u001b[39mlevel,\n\u001b[0;32m   1334\u001b[0m         sort\u001b[38;5;241m=\u001b[39msort,\n\u001b[0;32m   1335\u001b[0m         observed\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m \u001b[38;5;28;01mif\u001b[39;00m observed \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default \u001b[38;5;28;01melse\u001b[39;00m observed,\n\u001b[0;32m   1336\u001b[0m         dropna\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdropna,\n\u001b[0;32m   1337\u001b[0m     )\n\u001b[0;32m   1339\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m observed \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default:\n\u001b[0;32m   1340\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28many\u001b[39m(ping\u001b[38;5;241m.\u001b[39m_passed_categorical \u001b[38;5;28;01mfor\u001b[39;00m ping \u001b[38;5;129;01min\u001b[39;00m grouper\u001b[38;5;241m.\u001b[39mgroupings):\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\grouper.py:1043\u001b[0m, in \u001b[0;36mget_grouper\u001b[1;34m(obj, key, axis, level, sort, observed, validate, dropna)\u001b[0m\n\u001b[0;32m   1041\u001b[0m         in_axis, level, gpr \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mFalse\u001b[39;00m, gpr, \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[0;32m   1042\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m-> 1043\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(gpr)\n\u001b[0;32m   1044\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(gpr, Grouper) \u001b[38;5;129;01mand\u001b[39;00m gpr\u001b[38;5;241m.\u001b[39mkey \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   1045\u001b[0m     \u001b[38;5;66;03m# Add key to exclusions\u001b[39;00m\n\u001b[0;32m   1046\u001b[0m     exclusions\u001b[38;5;241m.\u001b[39madd(gpr\u001b[38;5;241m.\u001b[39mkey)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'listing_id'"
     ]
    }
   ],
   "source": [
    "# Perform the aggregation and merge\n",
    "avg_price_reviews = listings_df.merge(\n",
    "    reviews_df.groupby('listing_id').agg({'review_rating': 'mean'}).reset_index(),\n",
    "    on='listing_id'  # Ensure this column exists in both DataFrames\n",
    ")\n",
    "\n",
    "# Calculate average price and review rating by city\n",
    "city_value = avg_price_reviews.groupby('city').agg({'price': 'mean', 'review_rating': 'mean'}).reset_index()\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Plot average price and review rating by city\n",
    "plt.figure(figsize=(12, 6))\n",
    "plt.bar(city_value['city'], city_value['price'], alpha=0.6, label='Average Price')\n",
    "plt.bar(city_value['city'], city_value['review_rating'], alpha=0.6, label='Average Review Rating')\n",
    "plt.title('Average Price and Review Rating by City')\n",
    "plt.xlabel('City')\n",
    "plt.ylabel('Value')\n",
    "plt.xticks(rotation=45)\n",
    "plt.legend()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 221,
   "id": "e8ab2b01-b56b-46e9-88d2-d301101ce275",
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'city_value' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[221], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m city_value[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mvalue\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m city_value[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m/\u001b[39m city_value[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m]\n\u001b[0;32m      2\u001b[0m best_value_city \u001b[38;5;241m=\u001b[39m city_value\u001b[38;5;241m.\u001b[39mloc[city_value[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mvalue\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39midxmax()]\n\u001b[0;32m      3\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mThe city offering the best value for travel is: \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mbest_value_city[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcity\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m\"\u001b[39m)\n",
      "\u001b[1;31mNameError\u001b[0m: name 'city_value' is not defined"
     ]
    }
   ],
   "source": [
    "city_value['value'] = city_value['review_rating'] / city_value['price']\n",
    "best_value_city = city_value.loc[city_value['value'].idxmax()]\n",
    "print(f\"The city offering the best value for travel is: {best_value_city['city']}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 223,
   "id": "0dbd09f9-e7fc-4cb5-94ad-badc5036af44",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'listing_id'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[223], line 9\u001b[0m\n\u001b[0;32m      5\u001b[0m reviews_df \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mread_csv(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mReviews_data_dictionary.csv\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[0;32m      7\u001b[0m \u001b[38;5;66;03m# Merge listings_df with the average review ratings\u001b[39;00m\n\u001b[0;32m      8\u001b[0m avg_price_reviews \u001b[38;5;241m=\u001b[39m listings_df\u001b[38;5;241m.\u001b[39mmerge(\n\u001b[1;32m----> 9\u001b[0m     reviews_df\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m})\u001b[38;5;241m.\u001b[39mreset_index(),\n\u001b[0;32m     10\u001b[0m     on\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id\u001b[39m\u001b[38;5;124m'\u001b[39m\n\u001b[0;32m     11\u001b[0m )\n\u001b[0;32m     13\u001b[0m \u001b[38;5;66;03m# Calculate average price and review rating by city\u001b[39;00m\n\u001b[0;32m     14\u001b[0m city_value \u001b[38;5;241m=\u001b[39m avg_price_reviews\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcity\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m})\u001b[38;5;241m.\u001b[39mreset_index()\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:9183\u001b[0m, in \u001b[0;36mDataFrame.groupby\u001b[1;34m(self, by, axis, level, as_index, sort, group_keys, observed, dropna)\u001b[0m\n\u001b[0;32m   9180\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m level \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m by \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   9181\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mYou have to supply one of \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mby\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m and \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlevel\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m-> 9183\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m DataFrameGroupBy(\n\u001b[0;32m   9184\u001b[0m     obj\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m,\n\u001b[0;32m   9185\u001b[0m     keys\u001b[38;5;241m=\u001b[39mby,\n\u001b[0;32m   9186\u001b[0m     axis\u001b[38;5;241m=\u001b[39maxis,\n\u001b[0;32m   9187\u001b[0m     level\u001b[38;5;241m=\u001b[39mlevel,\n\u001b[0;32m   9188\u001b[0m     as_index\u001b[38;5;241m=\u001b[39mas_index,\n\u001b[0;32m   9189\u001b[0m     sort\u001b[38;5;241m=\u001b[39msort,\n\u001b[0;32m   9190\u001b[0m     group_keys\u001b[38;5;241m=\u001b[39mgroup_keys,\n\u001b[0;32m   9191\u001b[0m     observed\u001b[38;5;241m=\u001b[39mobserved,\n\u001b[0;32m   9192\u001b[0m     dropna\u001b[38;5;241m=\u001b[39mdropna,\n\u001b[0;32m   9193\u001b[0m )\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\groupby.py:1329\u001b[0m, in \u001b[0;36mGroupBy.__init__\u001b[1;34m(self, obj, keys, axis, level, grouper, exclusions, selection, as_index, sort, group_keys, observed, dropna)\u001b[0m\n\u001b[0;32m   1326\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdropna \u001b[38;5;241m=\u001b[39m dropna\n\u001b[0;32m   1328\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m grouper \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m-> 1329\u001b[0m     grouper, exclusions, obj \u001b[38;5;241m=\u001b[39m get_grouper(\n\u001b[0;32m   1330\u001b[0m         obj,\n\u001b[0;32m   1331\u001b[0m         keys,\n\u001b[0;32m   1332\u001b[0m         axis\u001b[38;5;241m=\u001b[39maxis,\n\u001b[0;32m   1333\u001b[0m         level\u001b[38;5;241m=\u001b[39mlevel,\n\u001b[0;32m   1334\u001b[0m         sort\u001b[38;5;241m=\u001b[39msort,\n\u001b[0;32m   1335\u001b[0m         observed\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m \u001b[38;5;28;01mif\u001b[39;00m observed \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default \u001b[38;5;28;01melse\u001b[39;00m observed,\n\u001b[0;32m   1336\u001b[0m         dropna\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdropna,\n\u001b[0;32m   1337\u001b[0m     )\n\u001b[0;32m   1339\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m observed \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default:\n\u001b[0;32m   1340\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28many\u001b[39m(ping\u001b[38;5;241m.\u001b[39m_passed_categorical \u001b[38;5;28;01mfor\u001b[39;00m ping \u001b[38;5;129;01min\u001b[39;00m grouper\u001b[38;5;241m.\u001b[39mgroupings):\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\grouper.py:1043\u001b[0m, in \u001b[0;36mget_grouper\u001b[1;34m(obj, key, axis, level, sort, observed, validate, dropna)\u001b[0m\n\u001b[0;32m   1041\u001b[0m         in_axis, level, gpr \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mFalse\u001b[39;00m, gpr, \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[0;32m   1042\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m-> 1043\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(gpr)\n\u001b[0;32m   1044\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(gpr, Grouper) \u001b[38;5;129;01mand\u001b[39;00m gpr\u001b[38;5;241m.\u001b[39mkey \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   1045\u001b[0m     \u001b[38;5;66;03m# Add key to exclusions\u001b[39;00m\n\u001b[0;32m   1046\u001b[0m     exclusions\u001b[38;5;241m.\u001b[39madd(gpr\u001b[38;5;241m.\u001b[39mkey)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'listing_id'"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Example DataFrames (replace with actual data loading)\n",
    "listings_df = pd.read_csv('Listings_data_dictionary.csv')\n",
    "reviews_df = pd.read_csv('Reviews_data_dictionary.csv')\n",
    "\n",
    "# Merge listings_df with the average review ratings\n",
    "avg_price_reviews = listings_df.merge(\n",
    "    reviews_df.groupby('listing_id').agg({'review_rating': 'mean'}).reset_index(),\n",
    "    on='listing_id'\n",
    ")\n",
    "\n",
    "# Calculate average price and review rating by city\n",
    "city_value = avg_price_reviews.groupby('city').agg({'price': 'mean', 'review_rating': 'mean'}).reset_index()\n",
    "\n",
    "# Calculate value for each city\n",
    "city_value['value'] = city_value['review_rating'] / city_value['price']\n",
    "\n",
    "# Find the city with the best value\n",
    "best_value_city = city_value.loc[city_value['value'].idxmax()]\n",
    "print(f\"The city offering the best value for travel is: {best_value_city['city']}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 225,
   "id": "cd868be5-9f81-485f-ae2e-c1b5a303b07a",
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'avg_price_reviews' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[225], line 2\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;66;03m# Example: Finding average price and review ratings across cities\u001b[39;00m\n\u001b[1;32m----> 2\u001b[0m city_summary \u001b[38;5;241m=\u001b[39m avg_price_reviews\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcity\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m})\u001b[38;5;241m.\u001b[39mreset_index()\n\u001b[0;32m      3\u001b[0m \u001b[38;5;28mprint\u001b[39m(city_summary)\n",
      "\u001b[1;31mNameError\u001b[0m: name 'avg_price_reviews' is not defined"
     ]
    }
   ],
   "source": [
    "# Example: Finding average price and review ratings across cities\n",
    "city_summary = avg_price_reviews.groupby('city').agg({'price': 'mean', 'review_rating': 'mean'}).reset_index()\n",
    "print(city_summary)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 227,
   "id": "df1e8250-3b1a-45bb-85da-65191d78a854",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Load the data\n",
    "listings_df = pd.read_csv('Listings_data_dictionary.csv')  # Update the path as needed\n",
    "reviews_df = pd.read_csv('Reviews_data_dictionary.csv')    # Update the path as needed\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 229,
   "id": "7f7fa6a3-454e-476d-9b4b-351bb52b1a8e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "           Field                       Description\n",
      "0     listing_id                        Listing ID\n",
      "1           name                      Listing Name\n",
      "2        host_id                           Host ID\n",
      "3     host_since       Date the Host joined Airbnb\n",
      "4  host_location  Location where the Host is based\n",
      "         Field  Description\n",
      "0   listing_id   Listing ID\n",
      "1    review_id    Review ID\n",
      "2         date  Review date\n",
      "3  reviewer_id  Reviewer ID\n"
     ]
    }
   ],
   "source": [
    "print(listings_df.head())\n",
    "print(reviews_df.head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 232,
   "id": "7be4fc84-e261-453d-b8b6-845ccd90ae20",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['Field', 'Description'], dtype='object')\n"
     ]
    },
    {
     "ename": "KeyError",
     "evalue": "'listing_id'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[232], line 5\u001b[0m\n\u001b[0;32m      2\u001b[0m \u001b[38;5;28mprint\u001b[39m(reviews_df\u001b[38;5;241m.\u001b[39mcolumns)\n\u001b[0;32m      4\u001b[0m \u001b[38;5;66;03m# Calculate average review ratings\u001b[39;00m\n\u001b[1;32m----> 5\u001b[0m avg_review_ratings \u001b[38;5;241m=\u001b[39m reviews_df\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m})\u001b[38;5;241m.\u001b[39mreset_index()\n\u001b[0;32m      7\u001b[0m \u001b[38;5;66;03m# Merge with listings_df\u001b[39;00m\n\u001b[0;32m      8\u001b[0m avg_price_reviews \u001b[38;5;241m=\u001b[39m listings_df\u001b[38;5;241m.\u001b[39mmerge(avg_review_ratings, on\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id\u001b[39m\u001b[38;5;124m'\u001b[39m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:9183\u001b[0m, in \u001b[0;36mDataFrame.groupby\u001b[1;34m(self, by, axis, level, as_index, sort, group_keys, observed, dropna)\u001b[0m\n\u001b[0;32m   9180\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m level \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m by \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   9181\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mYou have to supply one of \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mby\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m and \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlevel\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m-> 9183\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m DataFrameGroupBy(\n\u001b[0;32m   9184\u001b[0m     obj\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m,\n\u001b[0;32m   9185\u001b[0m     keys\u001b[38;5;241m=\u001b[39mby,\n\u001b[0;32m   9186\u001b[0m     axis\u001b[38;5;241m=\u001b[39maxis,\n\u001b[0;32m   9187\u001b[0m     level\u001b[38;5;241m=\u001b[39mlevel,\n\u001b[0;32m   9188\u001b[0m     as_index\u001b[38;5;241m=\u001b[39mas_index,\n\u001b[0;32m   9189\u001b[0m     sort\u001b[38;5;241m=\u001b[39msort,\n\u001b[0;32m   9190\u001b[0m     group_keys\u001b[38;5;241m=\u001b[39mgroup_keys,\n\u001b[0;32m   9191\u001b[0m     observed\u001b[38;5;241m=\u001b[39mobserved,\n\u001b[0;32m   9192\u001b[0m     dropna\u001b[38;5;241m=\u001b[39mdropna,\n\u001b[0;32m   9193\u001b[0m )\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\groupby.py:1329\u001b[0m, in \u001b[0;36mGroupBy.__init__\u001b[1;34m(self, obj, keys, axis, level, grouper, exclusions, selection, as_index, sort, group_keys, observed, dropna)\u001b[0m\n\u001b[0;32m   1326\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdropna \u001b[38;5;241m=\u001b[39m dropna\n\u001b[0;32m   1328\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m grouper \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m-> 1329\u001b[0m     grouper, exclusions, obj \u001b[38;5;241m=\u001b[39m get_grouper(\n\u001b[0;32m   1330\u001b[0m         obj,\n\u001b[0;32m   1331\u001b[0m         keys,\n\u001b[0;32m   1332\u001b[0m         axis\u001b[38;5;241m=\u001b[39maxis,\n\u001b[0;32m   1333\u001b[0m         level\u001b[38;5;241m=\u001b[39mlevel,\n\u001b[0;32m   1334\u001b[0m         sort\u001b[38;5;241m=\u001b[39msort,\n\u001b[0;32m   1335\u001b[0m         observed\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m \u001b[38;5;28;01mif\u001b[39;00m observed \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default \u001b[38;5;28;01melse\u001b[39;00m observed,\n\u001b[0;32m   1336\u001b[0m         dropna\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdropna,\n\u001b[0;32m   1337\u001b[0m     )\n\u001b[0;32m   1339\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m observed \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default:\n\u001b[0;32m   1340\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28many\u001b[39m(ping\u001b[38;5;241m.\u001b[39m_passed_categorical \u001b[38;5;28;01mfor\u001b[39;00m ping \u001b[38;5;129;01min\u001b[39;00m grouper\u001b[38;5;241m.\u001b[39mgroupings):\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\grouper.py:1043\u001b[0m, in \u001b[0;36mget_grouper\u001b[1;34m(obj, key, axis, level, sort, observed, validate, dropna)\u001b[0m\n\u001b[0;32m   1041\u001b[0m         in_axis, level, gpr \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mFalse\u001b[39;00m, gpr, \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[0;32m   1042\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m-> 1043\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(gpr)\n\u001b[0;32m   1044\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(gpr, Grouper) \u001b[38;5;129;01mand\u001b[39;00m gpr\u001b[38;5;241m.\u001b[39mkey \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   1045\u001b[0m     \u001b[38;5;66;03m# Add key to exclusions\u001b[39;00m\n\u001b[0;32m   1046\u001b[0m     exclusions\u001b[38;5;241m.\u001b[39madd(gpr\u001b[38;5;241m.\u001b[39mkey)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'listing_id'"
     ]
    }
   ],
   "source": [
    "# Check if 'listing_id' and 'review_rating' columns exist in reviews_df\n",
    "print(reviews_df.columns)\n",
    "\n",
    "# Calculate average review ratings\n",
    "avg_review_ratings = reviews_df.groupby('listing_id').agg({'review_rating': 'mean'}).reset_index()\n",
    "\n",
    "# Merge with listings_df\n",
    "avg_price_reviews = listings_df.merge(avg_review_ratings, on='listing_id')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 239,
   "id": "c51e4e7b-4e2c-4164-bfbe-5adc8760c12e",
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'avg_price_reviews' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[239], line 2\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;66;03m# Ensure 'city' column exists in avg_price_reviews\u001b[39;00m\n\u001b[1;32m----> 2\u001b[0m \u001b[38;5;28mprint\u001b[39m(avg_price_reviews\u001b[38;5;241m.\u001b[39mcolumns)\n\u001b[0;32m      4\u001b[0m \u001b[38;5;66;03m# Calculate average price and review ratings by city\u001b[39;00m\n\u001b[0;32m      5\u001b[0m city_summary \u001b[38;5;241m=\u001b[39m avg_price_reviews\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcity\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m})\u001b[38;5;241m.\u001b[39mreset_index()\n",
      "\u001b[1;31mNameError\u001b[0m: name 'avg_price_reviews' is not defined"
     ]
    }
   ],
   "source": [
    "# Ensure 'city' column exists in avg_price_reviews\n",
    "print(avg_price_reviews.columns)\n",
    "\n",
    "# Calculate average price and review ratings by city\n",
    "city_summary = avg_price_reviews.groupby('city').agg({'price': 'mean', 'review_rating': 'mean'}).reset_index()\n",
    "\n",
    "# Display the summary\n",
    "print(city_summary)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 237,
   "id": "6993c7b7-f8b6-4af5-a3b5-f98ab1ebfbb6",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['Field', 'Description'], dtype='object')\n"
     ]
    }
   ],
   "source": [
    "print(reviews_df.columns)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 241,
   "id": "24e47756-affa-41fe-bba9-d5c1426fb25c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "         Field  Description\n",
      "0   listing_id   Listing ID\n",
      "1    review_id    Review ID\n",
      "2         date  Review date\n",
      "3  reviewer_id  Reviewer ID\n"
     ]
    }
   ],
   "source": [
    "# List the first few rows of reviews_df to understand its structure\n",
    "print(reviews_df.head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 243,
   "id": "d51873c9-81d5-427a-9a2d-939be6d8549d",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Example: Renaming 'listingID' to 'listing_id'\n",
    "reviews_df.rename(columns={'listingID': 'listing_id'}, inplace=True)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 245,
   "id": "8dcff8d1-9139-4ca5-aea3-c76fc255056c",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'listing_id'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[245], line 2\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;66;03m# Group by the correct listing ID and calculate average review ratings\u001b[39;00m\n\u001b[1;32m----> 2\u001b[0m avg_review_ratings \u001b[38;5;241m=\u001b[39m reviews_df\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m})\u001b[38;5;241m.\u001b[39mreset_index()\n\u001b[0;32m      4\u001b[0m \u001b[38;5;66;03m# Merge with listings_df\u001b[39;00m\n\u001b[0;32m      5\u001b[0m avg_price_reviews \u001b[38;5;241m=\u001b[39m listings_df\u001b[38;5;241m.\u001b[39mmerge(avg_review_ratings, on\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id\u001b[39m\u001b[38;5;124m'\u001b[39m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:9183\u001b[0m, in \u001b[0;36mDataFrame.groupby\u001b[1;34m(self, by, axis, level, as_index, sort, group_keys, observed, dropna)\u001b[0m\n\u001b[0;32m   9180\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m level \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m by \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   9181\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mYou have to supply one of \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mby\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m and \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlevel\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m-> 9183\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m DataFrameGroupBy(\n\u001b[0;32m   9184\u001b[0m     obj\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m,\n\u001b[0;32m   9185\u001b[0m     keys\u001b[38;5;241m=\u001b[39mby,\n\u001b[0;32m   9186\u001b[0m     axis\u001b[38;5;241m=\u001b[39maxis,\n\u001b[0;32m   9187\u001b[0m     level\u001b[38;5;241m=\u001b[39mlevel,\n\u001b[0;32m   9188\u001b[0m     as_index\u001b[38;5;241m=\u001b[39mas_index,\n\u001b[0;32m   9189\u001b[0m     sort\u001b[38;5;241m=\u001b[39msort,\n\u001b[0;32m   9190\u001b[0m     group_keys\u001b[38;5;241m=\u001b[39mgroup_keys,\n\u001b[0;32m   9191\u001b[0m     observed\u001b[38;5;241m=\u001b[39mobserved,\n\u001b[0;32m   9192\u001b[0m     dropna\u001b[38;5;241m=\u001b[39mdropna,\n\u001b[0;32m   9193\u001b[0m )\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\groupby.py:1329\u001b[0m, in \u001b[0;36mGroupBy.__init__\u001b[1;34m(self, obj, keys, axis, level, grouper, exclusions, selection, as_index, sort, group_keys, observed, dropna)\u001b[0m\n\u001b[0;32m   1326\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdropna \u001b[38;5;241m=\u001b[39m dropna\n\u001b[0;32m   1328\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m grouper \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m-> 1329\u001b[0m     grouper, exclusions, obj \u001b[38;5;241m=\u001b[39m get_grouper(\n\u001b[0;32m   1330\u001b[0m         obj,\n\u001b[0;32m   1331\u001b[0m         keys,\n\u001b[0;32m   1332\u001b[0m         axis\u001b[38;5;241m=\u001b[39maxis,\n\u001b[0;32m   1333\u001b[0m         level\u001b[38;5;241m=\u001b[39mlevel,\n\u001b[0;32m   1334\u001b[0m         sort\u001b[38;5;241m=\u001b[39msort,\n\u001b[0;32m   1335\u001b[0m         observed\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m \u001b[38;5;28;01mif\u001b[39;00m observed \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default \u001b[38;5;28;01melse\u001b[39;00m observed,\n\u001b[0;32m   1336\u001b[0m         dropna\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdropna,\n\u001b[0;32m   1337\u001b[0m     )\n\u001b[0;32m   1339\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m observed \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default:\n\u001b[0;32m   1340\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28many\u001b[39m(ping\u001b[38;5;241m.\u001b[39m_passed_categorical \u001b[38;5;28;01mfor\u001b[39;00m ping \u001b[38;5;129;01min\u001b[39;00m grouper\u001b[38;5;241m.\u001b[39mgroupings):\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\grouper.py:1043\u001b[0m, in \u001b[0;36mget_grouper\u001b[1;34m(obj, key, axis, level, sort, observed, validate, dropna)\u001b[0m\n\u001b[0;32m   1041\u001b[0m         in_axis, level, gpr \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mFalse\u001b[39;00m, gpr, \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[0;32m   1042\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m-> 1043\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(gpr)\n\u001b[0;32m   1044\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(gpr, Grouper) \u001b[38;5;129;01mand\u001b[39;00m gpr\u001b[38;5;241m.\u001b[39mkey \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   1045\u001b[0m     \u001b[38;5;66;03m# Add key to exclusions\u001b[39;00m\n\u001b[0;32m   1046\u001b[0m     exclusions\u001b[38;5;241m.\u001b[39madd(gpr\u001b[38;5;241m.\u001b[39mkey)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'listing_id'"
     ]
    }
   ],
   "source": [
    "# Group by the correct listing ID and calculate average review ratings\n",
    "avg_review_ratings = reviews_df.groupby('listing_id').agg({'review_rating': 'mean'}).reset_index()\n",
    "\n",
    "# Merge with listings_df\n",
    "avg_price_reviews = listings_df.merge(avg_review_ratings, on='listing_id')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 247,
   "id": "25921998-d93e-4999-a8a7-4e9ea7f0f5f0",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['Field', 'Description'], dtype='object')\n",
      "           Field                       Description\n",
      "0     listing_id                        Listing ID\n",
      "1           name                      Listing Name\n",
      "2        host_id                           Host ID\n",
      "3     host_since       Date the Host joined Airbnb\n",
      "4  host_location  Location where the Host is based\n"
     ]
    }
   ],
   "source": [
    "# Check columns in listings_df\n",
    "print(listings_df.columns)\n",
    "\n",
    "# Check the first few rows of listings_df\n",
    "print(listings_df.head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 249,
   "id": "4ae05817-0365-401e-a269-5f2fae14d140",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Reviews DataFrame Columns: Index(['Field', 'Description'], dtype='object')\n",
      "Listings DataFrame Columns: Index(['Field', 'Description'], dtype='object')\n",
      "Updated Reviews DataFrame Columns: Index(['Field', 'Description'], dtype='object')\n"
     ]
    },
    {
     "ename": "KeyError",
     "evalue": "'listing_id'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[249], line 18\u001b[0m\n\u001b[0;32m     15\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mUpdated Reviews DataFrame Columns:\u001b[39m\u001b[38;5;124m\"\u001b[39m, reviews_df\u001b[38;5;241m.\u001b[39mcolumns)\n\u001b[0;32m     17\u001b[0m \u001b[38;5;66;03m# Perform the aggregation and merge\u001b[39;00m\n\u001b[1;32m---> 18\u001b[0m avg_review_ratings \u001b[38;5;241m=\u001b[39m reviews_df\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m})\u001b[38;5;241m.\u001b[39mreset_index()\n\u001b[0;32m     19\u001b[0m avg_price_reviews \u001b[38;5;241m=\u001b[39m listings_df\u001b[38;5;241m.\u001b[39mmerge(avg_review_ratings, on\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlisting_id\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[0;32m     21\u001b[0m \u001b[38;5;66;03m# Calculate average price and review ratings by city\u001b[39;00m\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:9183\u001b[0m, in \u001b[0;36mDataFrame.groupby\u001b[1;34m(self, by, axis, level, as_index, sort, group_keys, observed, dropna)\u001b[0m\n\u001b[0;32m   9180\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m level \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m by \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   9181\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mYou have to supply one of \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mby\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m and \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlevel\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m-> 9183\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m DataFrameGroupBy(\n\u001b[0;32m   9184\u001b[0m     obj\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m,\n\u001b[0;32m   9185\u001b[0m     keys\u001b[38;5;241m=\u001b[39mby,\n\u001b[0;32m   9186\u001b[0m     axis\u001b[38;5;241m=\u001b[39maxis,\n\u001b[0;32m   9187\u001b[0m     level\u001b[38;5;241m=\u001b[39mlevel,\n\u001b[0;32m   9188\u001b[0m     as_index\u001b[38;5;241m=\u001b[39mas_index,\n\u001b[0;32m   9189\u001b[0m     sort\u001b[38;5;241m=\u001b[39msort,\n\u001b[0;32m   9190\u001b[0m     group_keys\u001b[38;5;241m=\u001b[39mgroup_keys,\n\u001b[0;32m   9191\u001b[0m     observed\u001b[38;5;241m=\u001b[39mobserved,\n\u001b[0;32m   9192\u001b[0m     dropna\u001b[38;5;241m=\u001b[39mdropna,\n\u001b[0;32m   9193\u001b[0m )\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\groupby.py:1329\u001b[0m, in \u001b[0;36mGroupBy.__init__\u001b[1;34m(self, obj, keys, axis, level, grouper, exclusions, selection, as_index, sort, group_keys, observed, dropna)\u001b[0m\n\u001b[0;32m   1326\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdropna \u001b[38;5;241m=\u001b[39m dropna\n\u001b[0;32m   1328\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m grouper \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m-> 1329\u001b[0m     grouper, exclusions, obj \u001b[38;5;241m=\u001b[39m get_grouper(\n\u001b[0;32m   1330\u001b[0m         obj,\n\u001b[0;32m   1331\u001b[0m         keys,\n\u001b[0;32m   1332\u001b[0m         axis\u001b[38;5;241m=\u001b[39maxis,\n\u001b[0;32m   1333\u001b[0m         level\u001b[38;5;241m=\u001b[39mlevel,\n\u001b[0;32m   1334\u001b[0m         sort\u001b[38;5;241m=\u001b[39msort,\n\u001b[0;32m   1335\u001b[0m         observed\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m \u001b[38;5;28;01mif\u001b[39;00m observed \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default \u001b[38;5;28;01melse\u001b[39;00m observed,\n\u001b[0;32m   1336\u001b[0m         dropna\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdropna,\n\u001b[0;32m   1337\u001b[0m     )\n\u001b[0;32m   1339\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m observed \u001b[38;5;129;01mis\u001b[39;00m lib\u001b[38;5;241m.\u001b[39mno_default:\n\u001b[0;32m   1340\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28many\u001b[39m(ping\u001b[38;5;241m.\u001b[39m_passed_categorical \u001b[38;5;28;01mfor\u001b[39;00m ping \u001b[38;5;129;01min\u001b[39;00m grouper\u001b[38;5;241m.\u001b[39mgroupings):\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\groupby\\grouper.py:1043\u001b[0m, in \u001b[0;36mget_grouper\u001b[1;34m(obj, key, axis, level, sort, observed, validate, dropna)\u001b[0m\n\u001b[0;32m   1041\u001b[0m         in_axis, level, gpr \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mFalse\u001b[39;00m, gpr, \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[0;32m   1042\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m-> 1043\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(gpr)\n\u001b[0;32m   1044\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(gpr, Grouper) \u001b[38;5;129;01mand\u001b[39;00m gpr\u001b[38;5;241m.\u001b[39mkey \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   1045\u001b[0m     \u001b[38;5;66;03m# Add key to exclusions\u001b[39;00m\n\u001b[0;32m   1046\u001b[0m     exclusions\u001b[38;5;241m.\u001b[39madd(gpr\u001b[38;5;241m.\u001b[39mkey)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'listing_id'"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Load your data\n",
    "listings_df = pd.read_csv('Listings_data_dictionary.csv')\n",
    "reviews_df = pd.read_csv('Reviews_data_dictionary.csv')\n",
    "\n",
    "# Check the columns\n",
    "print(\"Reviews DataFrame Columns:\", reviews_df.columns)\n",
    "print(\"Listings DataFrame Columns:\", listings_df.columns)\n",
    "\n",
    "# Rename columns if necessary\n",
    "reviews_df.rename(columns={'listingID': 'listing_id'}, inplace=True)  # Update with actual column names\n",
    "\n",
    "# Check again after renaming\n",
    "print(\"Updated Reviews DataFrame Columns:\", reviews_df.columns)\n",
    "\n",
    "# Perform the aggregation and merge\n",
    "avg_review_ratings = reviews_df.groupby('listing_id').agg({'review_rating': 'mean'}).reset_index()\n",
    "avg_price_reviews = listings_df.merge(avg_review_ratings, on='listing_id')\n",
    "\n",
    "# Calculate average price and review ratings by city\n",
    "city_summary = avg_price_reviews.groupby('city').agg({'price': 'mean', 'review_rating': 'mean'}).reset_index()\n",
    "print(city_summary)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 251,
   "id": "377d4d28-d66d-4d4f-8dbf-2f41c1cd0f9f",
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "could not convert string to float: 'listing_id'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[251], line 2\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;66;03m# Example: Correlation between price and other features\u001b[39;00m\n\u001b[1;32m----> 2\u001b[0m correlation_matrix \u001b[38;5;241m=\u001b[39m listings_df\u001b[38;5;241m.\u001b[39mcorr()\n\u001b[0;32m      3\u001b[0m \u001b[38;5;28mprint\u001b[39m(correlation_matrix[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m])\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:11049\u001b[0m, in \u001b[0;36mDataFrame.corr\u001b[1;34m(self, method, min_periods, numeric_only)\u001b[0m\n\u001b[0;32m  11047\u001b[0m cols \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcolumns\n\u001b[0;32m  11048\u001b[0m idx \u001b[38;5;241m=\u001b[39m cols\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[1;32m> 11049\u001b[0m mat \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mto_numpy(dtype\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mfloat\u001b[39m, na_value\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mnan, copy\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m)\n\u001b[0;32m  11051\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m method \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mpearson\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n\u001b[0;32m  11052\u001b[0m     correl \u001b[38;5;241m=\u001b[39m libalgos\u001b[38;5;241m.\u001b[39mnancorr(mat, minp\u001b[38;5;241m=\u001b[39mmin_periods)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:1993\u001b[0m, in \u001b[0;36mDataFrame.to_numpy\u001b[1;34m(self, dtype, copy, na_value)\u001b[0m\n\u001b[0;32m   1991\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m dtype \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   1992\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m np\u001b[38;5;241m.\u001b[39mdtype(dtype)\n\u001b[1;32m-> 1993\u001b[0m result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_mgr\u001b[38;5;241m.\u001b[39mas_array(dtype\u001b[38;5;241m=\u001b[39mdtype, copy\u001b[38;5;241m=\u001b[39mcopy, na_value\u001b[38;5;241m=\u001b[39mna_value)\n\u001b[0;32m   1994\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m result\u001b[38;5;241m.\u001b[39mdtype \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m dtype:\n\u001b[0;32m   1995\u001b[0m     result \u001b[38;5;241m=\u001b[39m np\u001b[38;5;241m.\u001b[39masarray(result, dtype\u001b[38;5;241m=\u001b[39mdtype)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\internals\\managers.py:1688\u001b[0m, in \u001b[0;36mBlockManager.as_array\u001b[1;34m(self, dtype, copy, na_value)\u001b[0m\n\u001b[0;32m   1686\u001b[0m     arr \u001b[38;5;241m=\u001b[39m np\u001b[38;5;241m.\u001b[39masarray(blk\u001b[38;5;241m.\u001b[39mvalues, dtype\u001b[38;5;241m=\u001b[39mdtype)\n\u001b[0;32m   1687\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m-> 1688\u001b[0m     arr \u001b[38;5;241m=\u001b[39m np\u001b[38;5;241m.\u001b[39marray(blk\u001b[38;5;241m.\u001b[39mvalues, dtype\u001b[38;5;241m=\u001b[39mdtype, copy\u001b[38;5;241m=\u001b[39mcopy)\n\u001b[0;32m   1690\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m using_copy_on_write() \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m copy:\n\u001b[0;32m   1691\u001b[0m     arr \u001b[38;5;241m=\u001b[39m arr\u001b[38;5;241m.\u001b[39mview()\n",
      "\u001b[1;31mValueError\u001b[0m: could not convert string to float: 'listing_id'"
     ]
    }
   ],
   "source": [
    "# Example: Correlation between price and other features\n",
    "correlation_matrix = listings_df.corr()\n",
    "print(correlation_matrix['price'])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 253,
   "id": "16acf86f-9d28-4e87-9f09-166057a0fdc3",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'date'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3805\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3804\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m-> 3805\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_engine\u001b[38;5;241m.\u001b[39mget_loc(casted_key)\n\u001b[0;32m   3806\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m err:\n",
      "File \u001b[1;32mindex.pyx:167\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mindex.pyx:196\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7081\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7089\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'",
      "\nThe above exception was the direct cause of the following exception:\n",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[253], line 2\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;66;03m# Example: Seasonal analysis\u001b[39;00m\n\u001b[1;32m----> 2\u001b[0m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmonth\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m reviews_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdate\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mdt\u001b[38;5;241m.\u001b[39mto_period(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mM\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[0;32m      3\u001b[0m seasonal_trends \u001b[38;5;241m=\u001b[39m reviews_df\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmonth\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39magg({\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m})\u001b[38;5;241m.\u001b[39mreset_index()\n\u001b[0;32m      4\u001b[0m \u001b[38;5;28mprint\u001b[39m(seasonal_trends)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:4102\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4100\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnlevels \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m   4101\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_getitem_multilevel(key)\n\u001b[1;32m-> 4102\u001b[0m indexer \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mget_loc(key)\n\u001b[0;32m   4103\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_integer(indexer):\n\u001b[0;32m   4104\u001b[0m     indexer \u001b[38;5;241m=\u001b[39m [indexer]\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3812\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3807\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(casted_key, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;129;01mor\u001b[39;00m (\n\u001b[0;32m   3808\u001b[0m         \u001b[38;5;28misinstance\u001b[39m(casted_key, abc\u001b[38;5;241m.\u001b[39mIterable)\n\u001b[0;32m   3809\u001b[0m         \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28many\u001b[39m(\u001b[38;5;28misinstance\u001b[39m(x, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;28;01mfor\u001b[39;00m x \u001b[38;5;129;01min\u001b[39;00m casted_key)\n\u001b[0;32m   3810\u001b[0m     ):\n\u001b[0;32m   3811\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m InvalidIndexError(key)\n\u001b[1;32m-> 3812\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(key) \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01merr\u001b[39;00m\n\u001b[0;32m   3813\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m:\n\u001b[0;32m   3814\u001b[0m     \u001b[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\u001b[39;00m\n\u001b[0;32m   3815\u001b[0m     \u001b[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\u001b[39;00m\n\u001b[0;32m   3816\u001b[0m     \u001b[38;5;66;03m#  the TypeError.\u001b[39;00m\n\u001b[0;32m   3817\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_indexing_error(key)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'date'"
     ]
    }
   ],
   "source": [
    "# Example: Seasonal analysis\n",
    "reviews_df['month'] = reviews_df['date'].dt.to_period('M')\n",
    "seasonal_trends = reviews_df.groupby('month').agg({'review_rating': 'mean'}).reset_index()\n",
    "print(seasonal_trends)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 257,
   "id": "8cf91d99-306a-42a4-84f8-dcc40f54fb20",
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'city_value' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[257], line 2\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;66;03m# Example: Calculate and find best value city\u001b[39;00m\n\u001b[1;32m----> 2\u001b[0m city_value[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mvalue\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m city_value[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreview_rating\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m/\u001b[39m city_value[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m]\n\u001b[0;32m      3\u001b[0m best_value_city \u001b[38;5;241m=\u001b[39m city_value\u001b[38;5;241m.\u001b[39mloc[city_value[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mvalue\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39midxmax()]\n\u001b[0;32m      4\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mThe city offering the best value for travel is: \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mbest_value_city[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcity\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m\"\u001b[39m)\n",
      "\u001b[1;31mNameError\u001b[0m: name 'city_value' is not defined"
     ]
    }
   ],
   "source": [
    "# Example: Calculate and find best value city\n",
    "city_value['value'] = city_value['review_rating'] / city_value['price']\n",
    "best_value_city = city_value.loc[city_value['value'].idxmax()]\n",
    "print(f\"The city offering the best value for travel is: {best_value_city['city']}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 259,
   "id": "9fb7684d-0443-4d4f-8900-03e1b73640b3",
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'city_summary' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[259], line 5\u001b[0m\n\u001b[0;32m      3\u001b[0m \u001b[38;5;66;03m# Example: Bar chart of average price by city\u001b[39;00m\n\u001b[0;32m      4\u001b[0m plt\u001b[38;5;241m.\u001b[39mfigure(figsize\u001b[38;5;241m=\u001b[39m(\u001b[38;5;241m12\u001b[39m, \u001b[38;5;241m6\u001b[39m))\n\u001b[1;32m----> 5\u001b[0m plt\u001b[38;5;241m.\u001b[39mbar(city_summary[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcity\u001b[39m\u001b[38;5;124m'\u001b[39m], city_summary[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m])\n\u001b[0;32m      6\u001b[0m plt\u001b[38;5;241m.\u001b[39mxlabel(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mCity\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[0;32m      7\u001b[0m plt\u001b[38;5;241m.\u001b[39mylabel(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mAverage Price\u001b[39m\u001b[38;5;124m'\u001b[39m)\n",
      "\u001b[1;31mNameError\u001b[0m: name 'city_summary' is not defined"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<Figure size 1200x600 with 0 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Example: Bar chart of average price by city\n",
    "plt.figure(figsize=(12, 6))\n",
    "plt.bar(city_summary['city'], city_summary['price'])\n",
    "plt.xlabel('City')\n",
    "plt.ylabel('Average Price')\n",
    "plt.title('Average Price by City')\n",
    "plt.xticks(rotation=90)\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 263,
   "id": "5f347334-33c9-46d2-b9b2-4728a996d4a8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "city_summary is not defined. Please ensure all previous steps are executed correctly.\n"
     ]
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Ensure city_summary is defined\n",
    "if 'city_summary' in locals():\n",
    "    # Bar chart of average price by city\n",
    "    plt.figure(figsize=(12, 6))\n",
    "    plt.bar(city_summary['city'], city_summary['price'])\n",
    "    plt.xlabel('City')\n",
    "    plt.ylabel('Average Price')\n",
    "    plt.title('Average Price by City')\n",
    "    plt.xticks(rotation=45)\n",
    "    plt.tight_layout()\n",
    "    plt.show()\n",
    "else:\n",
    "    print(\"city_summary is not defined. Please ensure all previous steps are executed correctly.\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 266,
   "id": "e6efd268-b386-47de-bc5f-0201fc4aff18",
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'merged_df' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[266], line 2\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;66;03m# Average price per city\u001b[39;00m\n\u001b[1;32m----> 2\u001b[0m avg_price_per_city \u001b[38;5;241m=\u001b[39m merged_df\u001b[38;5;241m.\u001b[39mgroupby(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcity\u001b[39m\u001b[38;5;124m'\u001b[39m)[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m      3\u001b[0m avg_price_per_city\u001b[38;5;241m.\u001b[39mplot(kind\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mbar\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[0;32m      4\u001b[0m plt\u001b[38;5;241m.\u001b[39mtitle(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mAverage Price per City\u001b[39m\u001b[38;5;124m'\u001b[39m)\n",
      "\u001b[1;31mNameError\u001b[0m: name 'merged_df' is not defined"
     ]
    }
   ],
   "source": [
    "# Average price per city\n",
    "avg_price_per_city = merged_df.groupby('city')['price'].mean()\n",
    "avg_price_per_city.plot(kind='bar')\n",
    "plt.title('Average Price per City')\n",
    "plt.ylabel('Average Price')\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 270,
   "id": "20b44ada-2386-439e-9980-3021eaee4587",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'price'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3805\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3804\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m-> 3805\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_engine\u001b[38;5;241m.\u001b[39mget_loc(casted_key)\n\u001b[0;32m   3806\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m err:\n",
      "File \u001b[1;32mindex.pyx:167\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mindex.pyx:196\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7081\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\\\_libs\\\\hashtable_class_helper.pxi:7089\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mKeyError\u001b[0m: 'price'",
      "\nThe above exception was the direct cause of the following exception:\n",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[270], line 9\u001b[0m\n\u001b[0;32m      6\u001b[0m \u001b[38;5;28;01mimport\u001b[39;00m \u001b[38;5;21;01mseaborn\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m \u001b[38;5;21;01msns\u001b[39;00m\n\u001b[0;32m      8\u001b[0m plt\u001b[38;5;241m.\u001b[39mfigure(figsize\u001b[38;5;241m=\u001b[39m(\u001b[38;5;241m10\u001b[39m, \u001b[38;5;241m6\u001b[39m))\n\u001b[1;32m----> 9\u001b[0m sns\u001b[38;5;241m.\u001b[39mhistplot(listings_df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprice\u001b[39m\u001b[38;5;124m'\u001b[39m], bins\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m50\u001b[39m, kde\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m     10\u001b[0m plt\u001b[38;5;241m.\u001b[39mtitle(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mPrice Distribution of Listings\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[0;32m     11\u001b[0m plt\u001b[38;5;241m.\u001b[39mxlabel(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mPrice\u001b[39m\u001b[38;5;124m'\u001b[39m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\frame.py:4102\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4100\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnlevels \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m   4101\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_getitem_multilevel(key)\n\u001b[1;32m-> 4102\u001b[0m indexer \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mget_loc(key)\n\u001b[0;32m   4103\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_integer(indexer):\n\u001b[0;32m   4104\u001b[0m     indexer \u001b[38;5;241m=\u001b[39m [indexer]\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3812\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3807\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(casted_key, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;129;01mor\u001b[39;00m (\n\u001b[0;32m   3808\u001b[0m         \u001b[38;5;28misinstance\u001b[39m(casted_key, abc\u001b[38;5;241m.\u001b[39mIterable)\n\u001b[0;32m   3809\u001b[0m         \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28many\u001b[39m(\u001b[38;5;28misinstance\u001b[39m(x, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;28;01mfor\u001b[39;00m x \u001b[38;5;129;01min\u001b[39;00m casted_key)\n\u001b[0;32m   3810\u001b[0m     ):\n\u001b[0;32m   3811\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m InvalidIndexError(key)\n\u001b[1;32m-> 3812\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(key) \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01merr\u001b[39;00m\n\u001b[0;32m   3813\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m:\n\u001b[0;32m   3814\u001b[0m     \u001b[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\u001b[39;00m\n\u001b[0;32m   3815\u001b[0m     \u001b[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\u001b[39;00m\n\u001b[0;32m   3816\u001b[0m     \u001b[38;5;66;03m#  the TypeError.\u001b[39;00m\n\u001b[0;32m   3817\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_indexing_error(key)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'price'"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<Figure size 1000x600 with 0 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "## Visualizations and Insights\n",
    "\n",
    "### 1. Price Distribution\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "\n",
    "plt.figure(figsize=(10, 6))\n",
    "sns.histplot(listings_df['price'], bins=50, kde=True)\n",
    "plt.title('Price Distribution of Listings')\n",
    "plt.xlabel('Price')\n",
    "plt.ylabel('Frequency')\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b6696667-3866-491d-88ee-6cd1aa3e8980",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}


**4. Conclusion**

```markdown
## Conclusion

The analysis of Airbnb data across 10 major cities has provided several key insights:

- **Price Distribution**: Most listings are priced lower, though high-priced outliers exist.
- **Review Scores**: Significant differences in review scores are noted across cities, affecting perceived quality.
- **Attribute Influence**: Variables such as the number of bedrooms and review scores strongly correlate with price.
- **Trends and Seasonality**: Review counts and scores exhibit seasonal trends, impacting guest satisfaction and activity.
- **Value for Travel**: Cities with lower average prices often offer better overall value for travelers.

These findings can inform travelers and hosts about pricing strategies and market dynamics, helping to make more informed decisions.

